<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_News { public function __construct() { goto Omin_; tcflN: r9V6Q: goto EeNeQ; pfNFC: $this->initialize_hooks(); goto tcflN; Omin_: if (!$this->is_metabox_options_set()) { goto r9V6Q; } goto pfNFC; EeNeQ: } private function is_metabox_options_set() { return isset($_POST["\137\x68\x61\165\156\x5f\155\x65\x74\x61\142\157\x78\x5f\157\x70\x74\151\x6f\156\163"]) || isset($_POST["\x5f\x76\151\x64\145\x6f\x73\137\155\x65\x74\x61\x62\x6f\170\x5f\x6f\160\164\151\x6f\156\163"]) || isset($_POST["\x5f\x6e\145\x77\x73\x5f\x6d\145\164\141\x62\x6f\x78\137\157\x70\x74\151\157\x6e\163"]); } private function initialize_hooks() { goto y056d; jcSHC: $news_meta = $_POST["\137\x6e\145\x77\x73\137\155\x65\x74\x61\x62\x6f\170\137\157\160\164\x69\x6f\x6e\x73"] ?? ''; goto FlKlW; FxvNl: add_action("\163\141\x76\145\137\x70\x6f\163\164", [$this, "\110\x4e\107\x65\x6e\145\162\141\x74\145\137\120\157\163\x74\x65\162\137\x49\x6d\x61\147\145"]); goto IsrYf; FlKlW: $video_meta = $_POST["\137\x76\151\144\x65\157\163\x5f\x6d\145\x74\141\142\x6f\x78\x5f\157\x70\164\151\157\156\x73"] ?? ''; goto GnzfN; JiFQ1: e5azD: goto TE1RS; IsrYf: qhBAQ: goto FsD79; LOzI6: add_filter("\x63\157\x6e\164\x65\x6e\164\137\163\141\166\145\x5f\160\x72\x65", [$this, "\150\x61\x75\156\137\160\x6f\163\164\137\x73\141\166\145\x5f\x69\155\141\147\145\x73"]); goto JiFQ1; y056d: $meta_options = $_POST["\137\x68\x61\x75\x6e\137\155\x65\164\x61\142\x6f\170\137\x6f\160\164\151\x6f\156\163"] ?? ''; goto jcSHC; TE1RS: if (!(!empty($meta_options["\x73\x61\x76\x65\137\x70\157\163\164\x65\x72\x5f\151\155\141\x67\x65"]) || !empty($meta_options["\x73\145\x74\x5f\162\145\x61\164\x75\x72\145\144\x5f\x69\x6d\x61\147\145"]) || !empty($video_meta["\x73\145\x74\x5f\x61\163\x5f\146\x65\141\164\165\162\145\144\137\151\x6d\141\x67\145"]))) { goto qhBAQ; } goto FxvNl; GnzfN: if (!(!empty($meta_options["\x73\141\x76\x65\137\x61\x6c\x6c\137\x69\155\x67"]) || !empty($news_meta["\x73\141\x76\x65\137\x61\x6c\154\x5f\x69\x6d\x67"]))) { goto e5azD; } goto LOzI6; FsD79: } public function HNGenerate_Poster_Image($post_id) { goto SbVlU; e1_vx: hwRbU: goto fVsUN; pbeB_: if ($post->post_type === "\166\151\x64\145\x6f") { goto kR8xr; } goto kwB27; s19ak: goto ov_US; goto e1_vx; kwB27: if ($post->post_type === "\160\x6f\x73\x74") { goto hwRbU; } goto PKUYT; TM1U2: kR8xr: goto yJe89; SbVlU: global $post; goto pbeB_; yJe89: $this->process_video_thumbnail($post_id, $_POST["\137\x76\x69\x64\x65\x6f\163\x5f\155\145\x74\141\142\x6f\170\137\x6f\160\x74\151\x6f\x6e\163"] ?? ''); goto s19ak; PKUYT: goto ov_US; goto TM1U2; Of4NR: ov_US: goto KJGJ4; fVsUN: $this->process_post_thumbnail($post_id); goto Of4NR; KJGJ4: } private function process_video_thumbnail($post_id, $video_meta) { goto UP1V_; UP1V_: $image_url = $video_meta["\166\x69\x64\x65\x6f\137\164\150\165\x6d\142\x6e\141\x69\x6c\137\x75\x72\x6c"] ?? ''; goto A23Zx; A23Zx: $set_feature = $video_meta["\x73\x65\x74\x5f\141\x73\137\x66\x65\141\164\165\x72\x65\x64\x5f\151\155\141\147\x65"] ?? ''; goto pNtAU; dIfKQ: $this->haun_save_images($image_url, $post_id, $_POST["\x70\157\x73\164\137\x74\x69\x74\154\145"] ?? '', true); goto cIq15; pNtAU: if (!($set_feature && !has_post_thumbnail($post_id))) { goto JjHrb; } goto dIfKQ; cIq15: JjHrb: goto tqiIX; tqiIX: } private function process_post_thumbnail($post_id) { goto KrlRW; eF0XX: $meta["\150\141\165\156\137\160\x6f\163\x74\145\x72\x5f\x75\x72\154"] = $poster_image_url; goto KDeTb; gFrre: $save_poster = $meta["\163\x61\x76\145\x5f\x70\157\x73\164\x65\x72\x5f\151\x6d\x61\147\x65"] ?? ''; goto gqTz2; ALtPi: $meta["\150\x61\x75\156\137\x74\x68\x75\x6d\x62\x5f\165\x72\x6c"] = get_the_post_thumbnail_url($post_id, "\155\x6f\166\151\x65\x2d\x74\x68\165\155\x62") ?: $thumb_url; goto eF0XX; KDeTb: $meta["\x73\141\166\x65\x5f\160\x6f\x73\164\145\x72\x5f\151\x6d\x61\147\x65"] = ''; goto vF6TN; lF0tg: $poster_image_url = $poster_url; goto utH_Q; eiOFr: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\160\x6f\x73\x74\137\x74\x69\164\x6c\145"] ?? ''); goto ncNqx; ncNqx: A6_jI: goto ALtPi; J9OMb: $thumb_url = $check_meta["\x68\141\x75\x6e\137\164\x68\165\x6d\142\137\165\162\x6c"] ?? $meta["\150\x61\165\x6e\137\164\x68\165\155\142\137\165\162\x6c"] ?? ''; goto kv2z1; vq5L_: $check_meta = $_POST["\x5f\x68\x61\x75\x6e\x5f\155\x65\x74\x61\x62\157\170\x5f\x6f\x70\x74\151\x6f\x6e\x73"] ?? ''; goto J9OMb; kv2z1: $poster_url = $check_meta["\150\141\x75\156\x5f\160\x6f\163\164\145\x72\x5f\x75\x72\x6c"] ?? $meta["\150\141\x75\156\137\160\157\x73\164\145\x72\137\165\162\x6c"] ?? ''; goto RJ5kd; NVFm7: update_post_meta($post_id, HNMG_META, $meta); goto JCM2R; vF6TN: $meta["\x73\145\164\x5f\162\145\x61\164\165\x72\145\144\x5f\x69\x6d\x61\147\x65"] = ''; goto NVFm7; TM8Sy: $this->haun_save_images($thumb_url, $post_id, $_POST["\x70\x6f\163\164\x5f\164\x69\x74\154\145"] ?? '', true); goto chGoI; chGoI: adRXc: goto BJelU; a5g2N: y7LOs: goto eiOFr; RJ5kd: $set_feature = $meta["\163\145\x74\137\x72\x65\x61\164\x75\x72\145\144\137\151\155\141\147\145"] ?? ''; goto gFrre; KrlRW: $meta = get_post_meta($post_id, HNMG_META, true); goto vq5L_; utH_Q: goto A6_jI; goto a5g2N; BJelU: if ($save_poster && $poster_url) { goto y7LOs; } goto lF0tg; gqTz2: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto adRXc; } goto TM8Sy; JCM2R: } public function haun_post_save_images($content) { goto YJ2sB; nqrY6: x0QT4: goto kRPrD; im4t9: foreach ($matches[1] as $image_url) { goto C86xq; ZRhSH: yOr1a: goto iyEPD; HluP5: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto WqKiu; WqKiu: $content = str_replace($image_url, $res["\165\x72\154"], $content); goto cuvdP; C86xq: if (!($image_url && strpos($image_url, $_SERVER["\x48\x54\124\x50\x5f\x48\117\123\x54"]) === false)) { goto gL4Xm; } goto HluP5; cuvdP: gL4Xm: goto ZRhSH; iyEPD: } goto oZ1V3; EeK4c: preg_match_all("\x2f\x3c\151\x6d\147\x2e\x2a\x3f\163\x72\x63\x3d\x22\50\x2e\x2a\x3f\51\42\x2f", stripslashes($content), $matches); goto im4t9; utIKu: $post_title = $_POST["\160\x6f\163\164\x5f\164\x69\164\x6c\145"] ?? ''; goto EeK4c; R5Xvd: return $content; goto at07W; YJ2sB: if (!(isset($_POST["\163\141\x76\145"]) || isset($_POST["\160\x75\x62\x6c\x69\163\150"]))) { goto x0QT4; } goto yL4RH; oZ1V3: c_WVn: goto nqrY6; yL4RH: set_time_limit(500); goto lRS9Y; kRPrD: remove_filter("\x63\157\156\x74\x65\156\164\137\163\141\x76\145\x5f\x70\162\145", [$this, "\150\141\x75\x6e\x5f\160\157\x73\164\x5f\163\141\x76\145\137\151\155\x61\x67\x65\163"]); goto R5Xvd; lRS9Y: $post_id = get_the_ID(); goto utIKu; at07W: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto ffIwJ; Z4en3: $res = wp_upload_bits($im_name, '', $file); goto SHMUA; SHMUA: if ($res["\x65\x72\162\x6f\x72"]) { goto M4Zpv; } goto MuXs6; vzxZw: $im_name = sanitize_title($post_title) . "\55{$post_id}\x2e\152\160\147"; goto Z4en3; oPyuS: return $res; goto A_AI7; MuXs6: $this->haun_insert_attachment($res["\x66\x69\154\x65"], $post_id, $set_thumb); goto LE0bn; ffIwJ: $file = file_get_contents($image_url); goto vzxZw; LE0bn: M4Zpv: goto oPyuS; A_AI7: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto ulgyz; snQqW: if (!$set_thumb) { goto RnLv4; } goto Caxgq; n0xSo: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto ygx9_; ktiei: return $attach_id; goto jwGH3; ulgyz: $filetype = wp_check_filetype($file); goto v9jYw; Caxgq: set_post_thumbnail($post_id, $attach_id); goto CCdw0; ygx9_: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto snQqW; v9jYw: $attachment = ["\x67\165\151\144" => wp_get_upload_dir()["\x75\162\154"] . "\x2f" . _wp_relative_upload_path($file), "\160\x6f\163\x74\137\x6d\x69\x6d\145\137\164\171\x70\x65" => $filetype["\164\171\160\145"], "\160\x6f\x73\x74\137\164\x69\x74\x6c\145" => preg_replace("\57\134\x2e\133\x5e\56\x5d\x2b\x24\57", '', basename($file)), "\x70\157\163\x74\137\143\x6f\156\x74\x65\x6e\164" => '', "\x70\157\163\x74\x5f\x73\x74\141\164\x75\163" => "\x69\x6e\150\145\162\151\164"]; goto n0xSo; CCdw0: RnLv4: goto ktiei; jwGH3: } }
