<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_News { public function __construct() { goto kidi_; kidi_: if (!$this->is_metabox_options_set()) { goto LRDKb; } goto zrmfa; Zd7Um: LRDKb: goto W5OVW; zrmfa: $this->initialize_hooks(); goto Zd7Um; W5OVW: } private function is_metabox_options_set() { return isset($_POST["\x5f\150\141\165\156\155\145\164\141\142\x6f\x78"]) || isset($_POST["\x5f\166\x69\144\145\x6f\x73\x5f\x6d\x65\x74\141\142\x6f\x78\x5f\157\x70\x74\x69\x6f\x6e\163"]) || isset($_POST["\x5f\x6e\x65\167\x73\137\155\145\x74\x61\x62\157\x78\137\x6f\160\164\151\157\x6e\163"]); } private function initialize_hooks() { goto chS4n; A3u3e: C1nul: goto WPZKh; chS4n: $meta_options = $_POST["\x5f\150\x61\x75\156\155\x65\164\x61\142\x6f\170"] ?? ''; goto GuJmI; WA1_N: Pbiiu: goto pkai2; WPZKh: if (!(!empty($meta_options["\163\x61\166\145\x5f\x70\157\x73\x74\x65\162\x5f\x69\x6d\x61\147\x65"]) || !empty($meta_options["\163\145\164\x5f\x72\145\141\164\165\162\x65\x64\x5f\x69\x6d\x61\x67\x65"]) || !empty($video_meta["\x73\145\x74\137\x61\x73\137\146\145\x61\164\165\162\x65\x64\x5f\151\x6d\x61\147\x65"]))) { goto Pbiiu; } goto Wm3x8; cgvp2: add_filter("\143\157\156\164\145\156\164\x5f\x73\x61\x76\145\x5f\x70\162\x65", [$this, "\x68\141\165\156\x5f\x70\157\163\164\137\163\141\166\x65\x5f\151\x6d\141\147\x65\163"]); goto A3u3e; DiCVg: if (!(!empty($meta_options["\163\141\x76\145\137\141\x6c\x6c\137\151\x6d\x67"]) || !empty($news_meta["\x73\x61\x76\x65\x5f\x61\x6c\154\137\x69\x6d\147"]))) { goto C1nul; } goto cgvp2; Wm3x8: add_action("\163\x61\x76\x65\137\x70\x6f\x73\164", [$this, "\110\116\x47\x65\x6e\x65\x72\141\164\145\x5f\120\157\x73\x74\145\x72\x5f\x49\x6d\x61\x67\145"]); goto WA1_N; Dxay_: $video_meta = $_POST["\137\166\x69\144\x65\157\x73\x5f\x6d\145\164\141\142\x6f\x78\137\x6f\x70\x74\x69\157\x6e\163"] ?? ''; goto DiCVg; GuJmI: $news_meta = $_POST["\x5f\x6e\145\167\x73\137\x6d\x65\164\141\x62\157\x78\x5f\x6f\x70\x74\x69\x6f\x6e\163"] ?? ''; goto Dxay_; pkai2: } public function HNGenerate_Poster_Image($post_id) { goto maI4u; vhwgy: tX332: goto NO067; qpMad: if ($post->post_type === "\166\151\144\145\x6f") { goto um6az; } goto tt2RM; wTKDV: goto tX332; goto dFP7T; maI4u: global $post; goto qpMad; dFP7T: um6az: goto OM4Hw; sIrl3: $this->process_post_thumbnail($post_id); goto vhwgy; tt2RM: if ($post->post_type === "\x70\x6f\x73\x74") { goto Y6hpG; } goto wTKDV; gdQIR: Y6hpG: goto sIrl3; XAslD: goto tX332; goto gdQIR; OM4Hw: $this->process_video_thumbnail($post_id, $_POST["\x5f\166\151\x64\145\x6f\x73\x5f\155\145\x74\141\x62\x6f\x78\x5f\157\x70\164\151\157\156\163"] ?? ''); goto XAslD; NO067: } private function process_video_thumbnail($post_id, $video_meta) { goto JIIYE; RAMGB: $this->haun_save_images($image_url, $post_id, $_POST["\160\x6f\x73\x74\x5f\164\151\x74\x6c\x65"] ?? '', true); goto B9KmI; B9KmI: XU3Pm: goto JdgYW; JIIYE: $image_url = $video_meta["\166\x69\x64\145\x6f\137\x74\150\x75\x6d\142\156\141\x69\154\137\x75\x72\x6c"] ?? ''; goto tUA6i; tUA6i: $set_feature = $video_meta["\x73\145\x74\137\x61\x73\137\146\x65\x61\x74\x75\162\x65\144\x5f\151\155\141\x67\145"] ?? ''; goto YE8j9; YE8j9: if (!($set_feature && !has_post_thumbnail($post_id))) { goto XU3Pm; } goto RAMGB; JdgYW: } private function process_post_thumbnail($post_id) { goto T4g8V; cTvK0: pNUik: goto WhgG_; foRVB: $save_poster = $meta["\163\141\x76\145\137\160\157\163\164\145\162\x5f\x69\155\x61\x67\145"] ?? ''; goto m5KYm; E6UPq: $check_meta = $_POST["\137\x68\141\x75\x6e\x6d\x65\164\x61\142\157\170"] ?? ''; goto apuvw; w0bI8: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\x70\157\x73\x74\x5f\164\x69\x74\154\145"] ?? ''); goto cTvK0; leTg5: cgmOm: goto w0bI8; T4g8V: $meta = get_haunmovies($post_id, HNMG_META, true); goto E6UPq; ctDpy: if ($save_poster && $poster_url) { goto cgmOm; } goto j2Uzz; JlB13: $meta["\x73\x65\164\137\162\145\141\164\165\162\x65\x64\x5f\x69\155\141\147\145"] = ''; goto Vkd4c; WhgG_: $meta["\150\141\x75\156\137\164\x68\165\x6d\x62\137\x75\x72\x6c"] = get_the_post_thumbnail_url($post_id, "\x6d\x6f\x76\x69\x65\55\x74\150\165\155\142") ?: $thumb_url; goto bAqbR; LyDku: $poster_url = $check_meta["\x68\x61\x75\156\137\160\157\163\x74\x65\162\x5f\x75\162\x6c"] ?? $meta["\150\x61\x75\156\x5f\x70\x6f\163\x74\145\x72\137\x75\162\154"] ?? ''; goto xlEUm; m5KYm: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto ff85l; } goto xi28Z; Xveqg: goto pNUik; goto leTg5; Vkd4c: update_haunmovies($post_id, HNMG_META, $meta); goto CURJA; xlEUm: $set_feature = $meta["\x73\x65\x74\x5f\162\145\141\x74\x75\162\145\144\137\151\x6d\141\x67\x65"] ?? ''; goto foRVB; bAqbR: $meta["\150\141\x75\156\x5f\x70\157\x73\x74\x65\162\x5f\165\x72\154"] = $poster_image_url; goto SDoUs; apuvw: $thumb_url = $check_meta["\150\141\x75\x6e\x5f\164\150\165\155\142\137\x75\x72\154"] ?? $meta["\150\x61\165\x6e\137\x74\x68\165\x6d\142\x5f\x75\x72\154"] ?? ''; goto LyDku; yCZHr: ff85l: goto ctDpy; xi28Z: $this->haun_save_images($thumb_url, $post_id, $_POST["\x70\157\x73\164\x5f\x74\151\x74\154\x65"] ?? '', true); goto yCZHr; SDoUs: $meta["\x73\141\x76\145\x5f\x70\157\x73\164\x65\x72\x5f\151\x6d\x61\x67\x65"] = ''; goto JlB13; j2Uzz: $poster_image_url = $poster_url; goto Xveqg; CURJA: } public function haun_post_save_images($content) { goto LKca0; iJIkv: preg_match_all("\57\74\151\x6d\x67\56\x2a\77\163\162\143\x3d\x22\x28\56\x2a\x3f\x29\x22\57", stripslashes($content), $matches); goto hQI30; H_uqR: ZfptT: goto RmIqN; LKca0: if (!(isset($_POST["\163\x61\166\145"]) || isset($_POST["\x70\165\142\x6c\x69\163\150"]))) { goto kMKNn; } goto AF_eI; hQI30: foreach ($matches[1] as $image_url) { goto cS0Th; HAbSg: $content = str_replace($image_url, $res["\165\x72\154"], $content); goto xGjAW; EHPUw: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto HAbSg; Q0s5h: hMWLE: goto uu4k6; cS0Th: if (!($image_url && strpos($image_url, $_SERVER["\x48\124\x54\120\x5f\110\117\123\x54"]) === false)) { goto iJTQd; } goto EHPUw; xGjAW: iJTQd: goto Q0s5h; uu4k6: } goto H_uqR; HTGQK: remove_filter("\x63\157\x6e\164\x65\x6e\x74\x5f\x73\x61\x76\145\137\160\x72\x65", [$this, "\150\x61\165\x6e\137\160\157\163\164\x5f\x73\141\166\145\x5f\151\x6d\141\x67\145\x73"]); goto mfbN1; RmIqN: kMKNn: goto HTGQK; AF_eI: set_time_limit(500); goto G6aYR; tAJzy: $post_title = $_POST["\160\157\x73\x74\137\x74\151\x74\x6c\x65"] ?? ''; goto iJIkv; G6aYR: $post_id = get_the_ID(); goto tAJzy; mfbN1: return $content; goto x3eYr; x3eYr: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto zJxzz; WWvvX: if ($res["\145\162\x72\x6f\162"]) { goto TRB35; } goto s2LZY; UBajp: $im_name = sanitize_title($post_title) . "\x2d{$post_id}\x2e\x6a\x70\x67"; goto DgOuy; zJxzz: $file = file_get_contents($image_url); goto UBajp; xX1Zc: TRB35: goto ic_Fk; ic_Fk: return $res; goto v11cW; s2LZY: $this->haun_insert_attachment($res["\x66\151\x6c\x65"], $post_id, $set_thumb); goto xX1Zc; DgOuy: $res = wp_upload_bits($im_name, '', $file); goto WWvvX; v11cW: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto H9qj6; r8qKq: return $attach_id; goto xROw_; nxYqD: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto HxM0O; vwCfu: RbtBA: goto r8qKq; Us7A8: $attachment = ["\x67\165\151\x64" => wp_get_upload_dir()["\x75\x72\154"] . "\x2f" . _wp_relative_upload_path($file), "\160\157\163\164\x5f\155\x69\x6d\145\137\x74\x79\160\x65" => $filetype["\x74\x79\x70\145"], "\x70\157\163\x74\137\164\151\x74\154\145" => preg_replace("\57\134\x2e\x5b\136\x2e\135\53\x24\57", '', basename($file)), "\160\x6f\x73\164\x5f\143\x6f\156\164\x65\156\x74" => '', "\160\157\163\x74\x5f\x73\x74\141\164\x75\163" => "\151\x6e\150\x65\x72\151\x74"]; goto nxYqD; Gc7Gf: set_post_thumbnail($post_id, $attach_id); goto vwCfu; HxM0O: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto coxow; H9qj6: $filetype = wp_check_filetype($file); goto Us7A8; coxow: if (!$set_thumb) { goto RbtBA; } goto Gc7Gf; xROw_: } }
