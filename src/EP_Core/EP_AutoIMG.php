<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_AutoIMG { public function __construct() { goto Z_yoL; RsJZ0: JCzfh: goto xT2si; gFUjp: $this->initialize_hooks(); goto RsJZ0; Z_yoL: if (!$this->is_metabox_options_set()) { goto JCzfh; } goto gFUjp; xT2si: } private function is_metabox_options_set() { return isset($_POST["\137\x68\141\165\x6e\137\155\145\164\x61\x62\157\170\137\x6f\160\164\151\x6f\x6e\x73"]) || isset($_POST["\137\166\151\x64\145\157\x73\x5f\x6d\145\x74\141\142\x6f\170\x5f\157\x70\164\x69\157\x6e\163"]) || isset($_POST["\137\x6e\145\167\163\x5f\155\x65\x74\141\142\157\x78\137\x6f\160\x74\x69\157\156\163"]); } private function initialize_hooks() { goto RixqL; HWxVO: sjVbi: goto UQG0J; HyWbU: add_action("\163\x61\166\x65\x5f\x70\157\163\x74", [$this, "\x48\x4e\x47\x65\156\145\x72\141\164\145\137\x50\157\163\x74\x65\x72\x5f\111\x6d\141\x67\145"]); goto z55lT; icWaL: add_filter("\143\x6f\156\x74\x65\x6e\x74\x5f\x73\141\x76\x65\137\160\162\145", [$this, "\150\141\165\156\137\160\157\163\x74\137\x73\141\x76\145\137\151\155\141\147\x65\163"]); goto HWxVO; xosIc: $news_meta = $_POST["\137\x6e\x65\x77\163\x5f\x6d\145\164\x61\142\x6f\x78\137\x6f\160\x74\151\157\156\x73"] ?? ''; goto WyV3K; no3LW: if (!(!empty($meta_options["\163\x61\x76\x65\137\x61\x6c\154\x5f\151\x6d\147"]) || !empty($news_meta["\x73\x61\166\145\137\141\x6c\154\137\x69\155\x67"]))) { goto sjVbi; } goto icWaL; WyV3K: $video_meta = $_POST["\x5f\166\x69\144\x65\157\163\137\155\145\164\x61\142\x6f\170\x5f\x6f\x70\164\151\157\x6e\x73"] ?? ''; goto no3LW; UQG0J: if (!(!empty($meta_options["\x73\141\166\x65\137\x70\x6f\163\x74\x65\x72\x5f\151\155\141\147\x65"]) || !empty($meta_options["\163\x65\164\137\162\145\x61\x74\x75\x72\x65\x64\137\151\x6d\141\147\x65"]) || !empty($video_meta["\x73\x65\164\x5f\x61\x73\x5f\x66\145\141\164\x75\162\145\144\137\x69\x6d\141\147\145"]))) { goto k1kk8; } goto HyWbU; z55lT: k1kk8: goto vdGoo; RixqL: $meta_options = $_POST["\137\x68\x61\165\x6e\137\155\x65\x74\x61\x62\157\170\137\157\x70\x74\x69\157\x6e\x73"] ?? ''; goto xosIc; vdGoo: } public function HNGenerate_Poster_Image($post_id) { goto VgvAY; FhYoF: goto MA6uJ; goto bzsMz; VgvAY: global $post; goto xvWc1; SFsyP: MA6uJ: goto a0lHC; g84Fd: goto MA6uJ; goto lLH5U; bzsMz: R6jNs: goto q6N_R; lLH5U: hB6hs: goto OPBVb; xvWc1: if ($post->post_type === "\166\151\x64\145\x6f") { goto hB6hs; } goto vwpxi; OPBVb: $this->process_video_thumbnail($post_id, $_POST["\137\x76\x69\144\145\x6f\163\137\x6d\145\164\141\x62\157\170\137\x6f\160\x74\x69\157\x6e\163"] ?? ''); goto FhYoF; q6N_R: $this->process_post_thumbnail($post_id); goto SFsyP; vwpxi: if ($post->post_type === "\160\157\x73\x74") { goto R6jNs; } goto g84Fd; a0lHC: } private function process_video_thumbnail($post_id, $video_meta) { goto oSYGO; KNOqG: $this->haun_save_images($image_url, $post_id, $_POST["\160\x6f\x73\164\137\x74\x69\164\x6c\x65"] ?? '', true); goto xNg2M; oSYGO: $image_url = $video_meta["\166\151\144\145\x6f\x5f\x74\x68\x75\155\142\156\x61\x69\154\137\165\162\154"] ?? ''; goto jRDFk; jRDFk: $set_feature = $video_meta["\x73\x65\164\x5f\141\x73\x5f\146\145\141\x74\x75\162\x65\144\137\151\x6d\141\147\x65"] ?? ''; goto Fv5VH; Fv5VH: if (!($set_feature && !has_post_thumbnail($post_id))) { goto EfMTg; } goto KNOqG; xNg2M: EfMTg: goto PYnTM; PYnTM: } private function process_post_thumbnail($post_id) { goto LVbz3; YwSVF: $set_feature = $meta["\163\145\164\x5f\x72\145\141\x74\x75\x72\x65\x64\137\151\155\x61\x67\x65"] ?? ''; goto uU6iN; SkDHA: $this->haun_save_images($thumb_url, $post_id, $_POST["\160\157\x73\x74\x5f\x74\151\x74\154\x65"] ?? '', true); goto Pli4G; LVbz3: $meta = get_post_meta($post_id, HNMG_META, true); goto OK9Ui; R4bG5: $poster_url = $check_meta["\150\x61\x75\x6e\x5f\x70\x6f\163\164\145\162\x5f\x75\162\x6c"] ?? $meta["\x68\141\x75\x6e\x5f\160\157\x73\164\145\162\x5f\x75\162\154"] ?? ''; goto YwSVF; m3EGs: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\x70\157\163\x74\137\164\151\x74\x6c\145"] ?? ''); goto W0TC1; Ntnoz: goto Fofjv; goto JEBBj; jKSlr: update_post_meta($post_id, HNMG_META, $meta); goto tcyez; yT8UR: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto tovpV; } goto SkDHA; OK9Ui: $check_meta = $_POST["\x5f\x68\x61\x75\156\137\155\145\x74\x61\142\x6f\170\137\157\160\164\151\157\156\163"] ?? ''; goto N80Bp; Pli4G: tovpV: goto q7F29; DUpC6: $meta["\x73\145\164\137\x72\145\x61\x74\165\162\x65\x64\137\x69\155\x61\147\x65"] = ''; goto jKSlr; Hekd9: $meta["\x73\x61\166\x65\137\x70\x6f\163\x74\x65\162\137\x69\155\141\147\x65"] = ''; goto DUpC6; Hn6X5: $meta["\150\x61\x75\x6e\137\x74\150\x75\x6d\142\x5f\x75\162\x6c"] = get_the_post_thumbnail_url($post_id, "\155\157\x76\151\x65\55\x74\150\x75\155\142") ?: $thumb_url; goto Z2SiU; uU6iN: $save_poster = $meta["\163\141\x76\x65\x5f\x70\157\x73\164\x65\x72\x5f\151\x6d\141\147\145"] ?? ''; goto yT8UR; Z2SiU: $meta["\x68\141\165\x6e\x5f\160\x6f\163\164\145\x72\x5f\165\162\154"] = $poster_image_url; goto Hekd9; W0TC1: Fofjv: goto Hn6X5; JEBBj: N4EgQ: goto m3EGs; wv1hI: $poster_image_url = $poster_url; goto Ntnoz; N80Bp: $thumb_url = $check_meta["\150\141\x75\x6e\x5f\164\x68\165\x6d\x62\137\x75\162\x6c"] ?? $meta["\x68\x61\165\x6e\x5f\x74\150\x75\x6d\142\x5f\165\x72\x6c"] ?? ''; goto R4bG5; q7F29: if ($save_poster && $poster_url) { goto N4EgQ; } goto wv1hI; tcyez: } public function haun_post_save_images($content) { goto To9mO; ZNySY: $post_id = get_the_ID(); goto dKQNQ; CED3q: y34fB: goto Cy02Q; dKQNQ: $post_title = $_POST["\x70\157\x73\164\x5f\164\151\x74\154\145"] ?? ''; goto Bwn9N; hsHFW: foreach ($matches[1] as $image_url) { goto hYhKD; PXppR: MEquv: goto MxrjH; hYhKD: if (!($image_url && strpos($image_url, $_SERVER["\110\x54\x54\x50\x5f\x48\x4f\123\124"]) === false)) { goto tWIgq; } goto kEHCx; IQYMr: $content = str_replace($image_url, $res["\x75\x72\x6c"], $content); goto hYF29; hYF29: tWIgq: goto PXppR; kEHCx: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto IQYMr; MxrjH: } goto Wmskh; Wmskh: OniXb: goto CED3q; To9mO: if (!(isset($_POST["\163\141\x76\x65"]) || isset($_POST["\160\x75\x62\x6c\151\163\x68"]))) { goto y34fB; } goto ofSe3; Bwn9N: preg_match_all("\x2f\x3c\x69\155\x67\56\x2a\x3f\163\162\143\75\42\x28\56\x2a\x3f\x29\x22\57", stripslashes($content), $matches); goto hsHFW; Cy02Q: remove_filter("\x63\x6f\x6e\164\145\156\164\x5f\163\141\166\145\x5f\160\162\145", [$this, "\150\141\x75\156\x5f\x70\157\163\164\137\x73\x61\x76\145\x5f\151\155\141\x67\x65\x73"]); goto EPSNe; EPSNe: return $content; goto z3D6e; ofSe3: set_time_limit(500); goto ZNySY; z3D6e: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto Ndm2f; Ndm2f: $file = file_get_contents($image_url); goto d3XIx; d3XIx: $im_name = sanitize_title($post_title) . "\55{$post_id}\56\152\160\147"; goto EeTtD; ch0zh: if ($res["\145\x72\162\157\162"]) { goto KrxcM; } goto L9MPx; EeTtD: $res = wp_upload_bits($im_name, '', $file); goto ch0zh; HKTXs: KrxcM: goto nNG63; nNG63: return $res; goto m6Z3a; L9MPx: $this->haun_insert_attachment($res["\146\151\x6c\x65"], $post_id, $set_thumb); goto HKTXs; m6Z3a: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto F0rQO; G9b4A: if (!$set_thumb) { goto pCWfD; } goto FVC4g; yHeKd: $attachment = ["\x67\x75\x69\x64" => wp_get_upload_dir()["\x75\x72\x6c"] . "\57" . _wp_relative_upload_path($file), "\x70\157\x73\x74\x5f\155\x69\155\145\x5f\x74\171\x70\x65" => $filetype["\164\x79\160\x65"], "\x70\x6f\163\164\x5f\164\x69\x74\x6c\x65" => preg_replace("\57\x5c\x2e\x5b\136\x2e\135\53\44\57", '', basename($file)), "\160\157\163\x74\137\x63\x6f\156\164\145\156\x74" => '', "\160\x6f\x73\164\137\163\164\x61\164\x75\x73" => "\x69\156\x68\145\162\x69\x74"]; goto dyatV; F0rQO: $filetype = wp_check_filetype($file); goto yHeKd; p74nq: return $attach_id; goto Id6ZX; blynx: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto G9b4A; QGCu5: pCWfD: goto p74nq; dyatV: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto blynx; FVC4g: set_post_thumbnail($post_id, $attach_id); goto QGCu5; Id6ZX: } }
