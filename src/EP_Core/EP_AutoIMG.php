<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_AutoIMG { public function __construct() { goto leY88; dtE2r: ipwaZ: goto sP2_E; leY88: if (!$this->is_metabox_options_set()) { goto ipwaZ; } goto Rx_Of; Rx_Of: $this->initialize_hooks(); goto dtE2r; sP2_E: } private function is_metabox_options_set() { return isset($_POST["\x5f\x68\141\165\x6e\x5f\x6d\145\164\141\x62\x6f\x78\x5f\x6f\160\x74\x69\157\156\163"]) || isset($_POST["\137\166\151\144\x65\157\x73\137\x6d\x65\164\x61\x62\x6f\x78\x5f\x6f\160\x74\x69\x6f\156\163"]) || isset($_POST["\x5f\156\x65\167\x73\137\x6d\145\164\141\x62\157\170\x5f\157\x70\164\x69\157\x6e\x73"]); } private function initialize_hooks() { goto xieV0; u6dA1: add_filter("\143\x6f\x6e\164\x65\x6e\164\x5f\163\141\x76\x65\x5f\x70\162\x65", [$this, "\150\141\165\x6e\137\160\157\x73\164\137\163\x61\166\145\x5f\x69\155\141\x67\145\x73"]); goto q0kC7; UT5v0: T_hpE: goto XEGOH; pxx1E: $video_meta = $_POST["\x5f\x76\151\x64\x65\x6f\163\x5f\155\x65\x74\x61\x62\x6f\170\x5f\157\x70\164\151\x6f\x6e\x73"] ?? ''; goto lwVX5; xieV0: $meta_options = $_POST["\x5f\150\x61\165\x6e\x5f\155\x65\x74\141\x62\x6f\170\x5f\157\160\x74\151\x6f\x6e\x73"] ?? ''; goto jEUbA; dqRtP: if (!(!empty($meta_options["\x73\x61\166\145\137\160\x6f\163\164\145\162\x5f\151\155\x61\x67\145"]) || !empty($meta_options["\163\145\164\137\162\x65\x61\164\165\162\145\x64\137\151\155\141\x67\145"]) || !empty($video_meta["\x73\145\164\x5f\141\x73\x5f\146\x65\141\164\165\162\x65\x64\137\151\155\x61\147\145"]))) { goto T_hpE; } goto XsYRN; q0kC7: EoL49: goto dqRtP; jEUbA: $news_meta = $_POST["\137\x6e\145\x77\x73\x5f\x6d\145\x74\141\x62\157\x78\x5f\x6f\160\x74\151\x6f\156\x73"] ?? ''; goto pxx1E; XsYRN: add_action("\x73\x61\x76\145\x5f\x70\157\x73\164", [$this, "\x48\x4e\x47\x65\x6e\x65\162\141\x74\x65\137\120\x6f\163\x74\145\162\x5f\x49\x6d\141\147\145"]); goto UT5v0; lwVX5: if (!(!empty($meta_options["\x73\141\166\145\x5f\x61\x6c\x6c\x5f\151\x6d\147"]) || !empty($news_meta["\x73\141\166\x65\137\141\154\154\x5f\x69\x6d\x67"]))) { goto EoL49; } goto u6dA1; XEGOH: } public function HNGenerate_Poster_Image($post_id) { goto PIgiU; M9yTP: if ($post->post_type === "\160\157\x73\164") { goto lQaRf; } goto yOQQY; CsY2z: Tig1s: goto v1WqI; T4IZb: $this->process_post_thumbnail($post_id); goto KoE7F; B3psq: lQaRf: goto T4IZb; yOQQY: goto e7Qzz; goto CsY2z; KoE7F: e7Qzz: goto xqFSp; PIgiU: global $post; goto ssW63; ogDRZ: goto e7Qzz; goto B3psq; ssW63: if ($post->post_type === "\166\x69\x64\145\x6f") { goto Tig1s; } goto M9yTP; v1WqI: $this->process_video_thumbnail($post_id, $_POST["\137\x76\x69\144\x65\x6f\x73\x5f\x6d\145\x74\141\x62\157\x78\137\x6f\160\x74\x69\157\x6e\x73"] ?? ''); goto ogDRZ; xqFSp: } private function process_video_thumbnail($post_id, $video_meta) { goto A_R5o; V480Z: DkxBX: goto S5VDD; v6kPb: $this->haun_save_images($image_url, $post_id, $_POST["\x70\x6f\163\164\137\164\x69\164\154\145"] ?? '', true); goto V480Z; uwjYv: $set_feature = $video_meta["\163\145\x74\137\141\x73\x5f\x66\145\x61\164\x75\x72\145\x64\137\151\155\141\147\145"] ?? ''; goto FQ4N8; FQ4N8: if (!($set_feature && !has_post_thumbnail($post_id))) { goto DkxBX; } goto v6kPb; A_R5o: $image_url = $video_meta["\x76\x69\x64\145\x6f\x5f\x74\150\x75\x6d\x62\156\141\x69\154\x5f\x75\162\x6c"] ?? ''; goto uwjYv; S5VDD: } private function process_post_thumbnail($post_id) { goto m_zMc; WXbC2: Mxwf6: goto PA2AC; hlXgu: $set_feature = $meta["\163\x65\164\137\x72\145\x61\164\165\x72\145\x64\x5f\x69\x6d\141\147\x65"] ?? ''; goto v8hAM; wN0qk: $check_meta = $_POST["\137\x68\141\165\x6e\x5f\155\145\x74\x61\142\x6f\x78\137\x6f\160\164\151\x6f\156\x73"] ?? ''; goto R4Ns1; qmNz9: XlKIo: goto Ykl8U; aNUsB: $poster_image_url = $poster_url; goto XVKD2; v8hAM: $save_poster = $meta["\x73\x61\x76\x65\x5f\x70\157\x73\164\x65\162\137\x69\x6d\x61\147\145"] ?? ''; goto cSOj0; m_zMc: $meta = get_post_meta($post_id, HNMG_META, true); goto wN0qk; XVKD2: goto Mxwf6; goto GpEnN; TyPwR: $meta["\163\x61\x76\145\137\160\x6f\x73\x74\145\162\x5f\151\x6d\141\147\x65"] = ''; goto aj8iX; Ykl8U: if ($save_poster && $poster_url) { goto PAZG0; } goto aNUsB; GpEnN: PAZG0: goto pj1i4; PA2AC: $meta["\x68\x61\165\x6e\137\164\150\x75\x6d\142\x5f\165\162\x6c"] = get_the_post_thumbnail_url($post_id, "\x6d\x6f\x76\x69\145\x2d\164\150\x75\x6d\x62") ?: $thumb_url; goto BhBXd; pj1i4: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\160\157\163\164\x5f\164\x69\164\x6c\x65"] ?? ''); goto WXbC2; R4Ns1: $thumb_url = $check_meta["\x68\x61\165\x6e\x5f\x74\150\x75\155\142\137\x75\162\154"] ?? $meta["\150\141\x75\x6e\x5f\x74\150\x75\155\142\137\x75\162\x6c"] ?? ''; goto XNqfz; BhBXd: $meta["\150\141\165\x6e\x5f\160\x6f\x73\164\x65\x72\x5f\x75\x72\x6c"] = $poster_image_url; goto TyPwR; XNqfz: $poster_url = $check_meta["\150\x61\x75\156\137\160\157\163\x74\145\162\137\165\162\154"] ?? $meta["\x68\x61\x75\x6e\137\160\x6f\x73\164\x65\162\x5f\165\x72\x6c"] ?? ''; goto hlXgu; OpnEZ: $this->haun_save_images($thumb_url, $post_id, $_POST["\x70\x6f\163\x74\137\x74\151\x74\x6c\x65"] ?? '', true); goto qmNz9; aj8iX: $meta["\163\145\164\137\x72\x65\141\164\x75\162\x65\144\137\x69\155\x61\147\x65"] = ''; goto ZFN03; cSOj0: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto XlKIo; } goto OpnEZ; ZFN03: update_post_meta($post_id, HNMG_META, $meta); goto lWrPq; lWrPq: } public function haun_post_save_images($content) { goto OoElG; na5s4: return $content; goto Phnh1; opJ0h: preg_match_all("\57\x3c\x69\155\147\x2e\x2a\77\x73\162\143\x3d\42\50\56\x2a\x3f\51\x22\x2f", stripslashes($content), $matches); goto cJ1md; s_VKf: XItzi: goto oEgDJ; JGVac: $post_id = get_the_ID(); goto LLvLn; sJ0_T: set_time_limit(500); goto JGVac; cJ1md: foreach ($matches[1] as $image_url) { goto DlmQJ; kjR7a: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto dHwEl; dHwEl: $content = str_replace($image_url, $res["\x75\162\154"], $content); goto cr3Yw; cr3Yw: swmne: goto oWBeA; oWBeA: Dpe_X: goto k1sZg; DlmQJ: if (!($image_url && strpos($image_url, $_SERVER["\x48\124\x54\x50\137\110\117\x53\124"]) === false)) { goto swmne; } goto kjR7a; k1sZg: } goto AL49B; oEgDJ: remove_filter("\143\157\156\x74\x65\x6e\164\x5f\x73\x61\x76\145\x5f\160\162\145", [$this, "\150\141\165\156\x5f\x70\x6f\163\x74\137\x73\141\166\145\137\151\x6d\x61\x67\145\163"]); goto na5s4; LLvLn: $post_title = $_POST["\160\157\163\x74\137\x74\151\x74\x6c\x65"] ?? ''; goto opJ0h; AL49B: mRMlK: goto s_VKf; OoElG: if (!(isset($_POST["\x73\141\166\x65"]) || isset($_POST["\160\x75\x62\154\x69\163\x68"]))) { goto XItzi; } goto sJ0_T; Phnh1: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto djD92; BSvzk: $res = wp_upload_bits($im_name, '', $file); goto fdlaf; djD92: $file = file_get_contents($image_url); goto KCGRG; Q0CYw: $this->haun_insert_attachment($res["\146\151\x6c\145"], $post_id, $set_thumb); goto c73nu; uuGfc: return $res; goto B8FPu; c73nu: Bg81b: goto uuGfc; fdlaf: if ($res["\x65\x72\x72\157\x72"]) { goto Bg81b; } goto Q0CYw; KCGRG: $im_name = sanitize_title($post_title) . "\x2d{$post_id}\x2e\x6a\160\x67"; goto BSvzk; B8FPu: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto q_PdZ; Bz4iL: if (!$set_thumb) { goto x092v; } goto e8JDV; aXsYa: x092v: goto CKPHN; bMOIe: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto NPY76; e8JDV: set_post_thumbnail($post_id, $attach_id); goto aXsYa; NPY76: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto Bz4iL; q_PdZ: $filetype = wp_check_filetype($file); goto XYEeU; CKPHN: return $attach_id; goto SkARF; XYEeU: $attachment = ["\147\165\x69\x64" => wp_get_upload_dir()["\165\162\154"] . "\57" . _wp_relative_upload_path($file), "\160\157\163\x74\137\155\x69\155\145\x5f\x74\171\x70\x65" => $filetype["\164\x79\160\x65"], "\x70\157\x73\x74\x5f\x74\151\164\x6c\145" => preg_replace("\x2f\134\56\x5b\x5e\56\x5d\53\x24\x2f", '', basename($file)), "\160\x6f\163\164\x5f\x63\x6f\x6e\x74\145\x6e\164" => '', "\160\157\x73\x74\x5f\x73\164\141\x74\x75\x73" => "\x69\x6e\150\145\162\x69\164"]; goto bMOIe; SkARF: } }
