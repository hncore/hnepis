<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_News { public function __construct() { goto PnNoh; PnNoh: if (!$this->is_metabox_options_set()) { goto tnYt0; } goto zMjyH; m4pp3: tnYt0: goto gsNTe; zMjyH: $this->initialize_hooks(); goto m4pp3; gsNTe: } private function is_metabox_options_set() { return isset($_POST["\x5f\x68\141\x75\x6e\137\155\145\x74\141\142\157\170\x5f\157\160\164\x69\x6f\x6e\163"]) || isset($_POST["\x5f\166\151\144\x65\x6f\x73\137\x6d\145\x74\x61\x62\x6f\x78\137\x6f\x70\x74\151\x6f\x6e\x73"]) || isset($_POST["\x5f\x6e\x65\x77\163\137\155\x65\164\141\142\x6f\170\x5f\157\x70\x74\151\157\x6e\163"]); } private function initialize_hooks() { goto QZFBA; rgMQH: add_filter("\x63\157\x6e\x74\145\x6e\x74\137\x73\x61\x76\x65\137\160\x72\145", [$this, "\150\141\x75\x6e\x5f\x70\x6f\x73\164\x5f\163\x61\x76\x65\x5f\151\x6d\x61\x67\x65\x73"]); goto EQfyu; EEZu0: $video_meta = $_POST["\137\x76\151\144\145\157\163\x5f\x6d\x65\x74\141\142\x6f\170\x5f\157\160\164\151\x6f\x6e\163"] ?? ''; goto oDeRx; QZFBA: $meta_options = $_POST["\x5f\150\x61\165\x6e\x5f\x6d\x65\x74\x61\x62\157\170\x5f\157\160\x74\x69\157\156\163"] ?? ''; goto X5906; oDeRx: if (!(!empty($meta_options["\163\x61\166\145\x5f\141\154\x6c\137\x69\x6d\x67"]) || !empty($news_meta["\x73\141\166\145\137\x61\x6c\x6c\137\151\155\x67"]))) { goto NAu6d; } goto rgMQH; X5906: $news_meta = $_POST["\137\x6e\145\x77\x73\137\155\x65\x74\x61\x62\157\170\x5f\157\x70\164\151\157\x6e\163"] ?? ''; goto EEZu0; AtMHs: if (!(!empty($meta_options["\x73\141\166\x65\x5f\160\157\x73\x74\145\x72\x5f\151\x6d\x61\147\x65"]) || !empty($meta_options["\x73\145\x74\x5f\x72\x65\141\164\x75\162\145\144\x5f\151\155\x61\x67\x65"]) || !empty($video_meta["\163\x65\164\137\141\x73\137\x66\145\x61\x74\165\x72\145\144\137\151\155\x61\147\145"]))) { goto oad56; } goto NWonW; NWonW: add_action("\x73\x61\166\x65\x5f\x70\x6f\x73\164", [$this, "\x48\116\x47\145\156\x65\x72\141\x74\x65\137\120\x6f\163\164\x65\162\x5f\111\x6d\x61\x67\145"]); goto Kj4rA; EQfyu: NAu6d: goto AtMHs; Kj4rA: oad56: goto O3Tyk; O3Tyk: } public function HNGenerate_Poster_Image($post_id) { goto R6l1F; HWEY_: goto EdeRo; goto fbIpT; mFX5l: goto EdeRo; goto L3Xpn; UywVg: $this->process_video_thumbnail($post_id, $_POST["\x5f\x76\151\x64\145\x6f\x73\137\155\145\x74\141\142\157\x78\137\157\x70\x74\151\x6f\x6e\x73"] ?? ''); goto mFX5l; v75__: $this->process_post_thumbnail($post_id); goto HU5e5; L3Xpn: c9Kl2: goto v75__; FXSln: if ($post->post_type === "\x76\x69\x64\145\157") { goto joU6k; } goto yeiDL; HU5e5: EdeRo: goto x8FhG; yeiDL: if ($post->post_type === "\x70\157\163\164") { goto c9Kl2; } goto HWEY_; fbIpT: joU6k: goto UywVg; R6l1F: global $post; goto FXSln; x8FhG: } private function process_video_thumbnail($post_id, $video_meta) { goto awz41; KaW3S: Xwlxi: goto PVMHc; awz41: $image_url = $video_meta["\166\x69\x64\x65\x6f\137\x74\x68\x75\155\142\x6e\141\x69\154\x5f\165\x72\x6c"] ?? ''; goto oUSzh; oUSzh: $set_feature = $video_meta["\x73\x65\x74\137\141\163\x5f\146\145\x61\164\x75\162\145\144\x5f\x69\x6d\141\x67\x65"] ?? ''; goto y9rLl; y9rLl: if (!($set_feature && !has_post_thumbnail($post_id))) { goto Xwlxi; } goto ESB7Y; ESB7Y: $this->haun_save_images($image_url, $post_id, $_POST["\160\157\x73\x74\x5f\x74\151\x74\154\x65"] ?? '', true); goto KaW3S; PVMHc: } private function process_post_thumbnail($post_id) { goto wN_Oi; GXIN2: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto Ry7AP; } goto Bcnss; wN_Oi: $meta = get_post_meta($post_id, HNMG_META, true); goto ZIGCl; ZIGCl: $check_meta = $_POST["\137\x68\141\165\x6e\137\155\145\164\x61\142\157\170\137\157\160\164\x69\157\x6e\163"] ?? ''; goto fpxBG; fpxBG: $thumb_url = $check_meta["\150\x61\x75\156\x5f\164\150\x75\155\142\137\165\162\154"] ?? $meta["\x68\141\165\156\137\x74\x68\x75\x6d\142\137\x75\162\x6c"] ?? ''; goto FAupC; ZrFlW: if ($save_poster && $poster_url) { goto Cs4SK; } goto ATiid; FU4Ck: goto UBGZA; goto D_UCY; HoIm0: $meta["\x73\x61\166\x65\x5f\160\x6f\163\164\x65\162\137\x69\x6d\141\147\145"] = ''; goto m3RNV; OnkES: $set_feature = $meta["\163\145\x74\x5f\x72\x65\141\164\x75\162\145\x64\137\x69\155\x61\147\145"] ?? ''; goto eH3sL; T3FQj: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\x70\157\163\x74\x5f\x74\x69\164\154\x65"] ?? ''); goto oJlEt; Bcnss: $this->haun_save_images($thumb_url, $post_id, $_POST["\x70\157\x73\164\137\x74\151\164\154\145"] ?? '', true); goto Bx1Pv; Bx1Pv: Ry7AP: goto ZrFlW; osnd0: $meta["\x68\x61\x75\156\137\x74\x68\165\155\x62\137\x75\162\154"] = get_the_post_thumbnail_url($post_id, "\155\x6f\166\x69\145\55\164\150\x75\x6d\x62") ?: $thumb_url; goto Ckg0J; Fpux0: update_post_meta($post_id, HNMG_META, $meta); goto RO1tX; D_UCY: Cs4SK: goto T3FQj; m3RNV: $meta["\163\145\x74\137\162\145\141\x74\x75\x72\x65\144\137\151\155\141\x67\145"] = ''; goto Fpux0; eH3sL: $save_poster = $meta["\163\141\x76\145\x5f\160\x6f\x73\164\x65\x72\x5f\x69\155\141\147\145"] ?? ''; goto GXIN2; oJlEt: UBGZA: goto osnd0; Ckg0J: $meta["\150\141\165\156\x5f\x70\157\163\164\145\x72\137\165\x72\x6c"] = $poster_image_url; goto HoIm0; ATiid: $poster_image_url = $poster_url; goto FU4Ck; FAupC: $poster_url = $check_meta["\x68\x61\165\156\x5f\x70\157\163\x74\x65\x72\x5f\165\162\154"] ?? $meta["\150\141\x75\x6e\x5f\160\157\163\164\145\162\137\165\162\154"] ?? ''; goto OnkES; RO1tX: } public function haun_post_save_images($content) { goto IUCPW; nQ40h: Wz9qJ: goto XtT0E; t5PK3: $post_title = $_POST["\160\x6f\163\x74\x5f\x74\151\164\x6c\145"] ?? ''; goto N3So8; IUCPW: if (!(isset($_POST["\x73\141\166\145"]) || isset($_POST["\160\x75\x62\154\151\163\150"]))) { goto Wz9qJ; } goto wOUIJ; N3So8: preg_match_all("\x2f\74\151\x6d\147\56\x2a\77\163\x72\x63\x3d\x22\x28\56\x2a\x3f\x29\x22\57", stripslashes($content), $matches); goto PO1KQ; XtT0E: remove_filter("\x63\157\x6e\x74\x65\156\x74\137\x73\x61\166\145\x5f\160\162\x65", [$this, "\150\141\165\156\137\x70\x6f\163\164\137\x73\141\x76\x65\x5f\151\155\141\x67\x65\x73"]); goto YdETB; YdETB: return $content; goto wKU0_; EwfLt: WG5b3: goto nQ40h; wOUIJ: set_time_limit(500); goto EyUm_; EyUm_: $post_id = get_the_ID(); goto t5PK3; PO1KQ: foreach ($matches[1] as $image_url) { goto l6RQx; gDTHU: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto w6iyi; w6iyi: $content = str_replace($image_url, $res["\165\x72\x6c"], $content); goto CwQCG; wWku5: rkIz3: goto oqalO; l6RQx: if (!($image_url && strpos($image_url, $_SERVER["\x48\124\124\120\x5f\110\x4f\x53\124"]) === false)) { goto WVf3t; } goto gDTHU; CwQCG: WVf3t: goto wWku5; oqalO: } goto EwfLt; wKU0_: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto RXYtm; rrClT: $res = wp_upload_bits($im_name, '', $file); goto nrpXq; zj2yq: $im_name = sanitize_title($post_title) . "\x2d{$post_id}\56\x6a\x70\147"; goto rrClT; UM7Iw: return $res; goto DK9Zx; nrpXq: if ($res["\145\162\162\x6f\x72"]) { goto pLVH1; } goto VItHm; VItHm: $this->haun_insert_attachment($res["\146\151\x6c\x65"], $post_id, $set_thumb); goto tcTLp; tcTLp: pLVH1: goto UM7Iw; RXYtm: $file = file_get_contents($image_url); goto zj2yq; DK9Zx: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto W_1Km; G_v1j: $attachment = ["\x67\165\x69\x64" => wp_get_upload_dir()["\165\162\154"] . "\57" . _wp_relative_upload_path($file), "\x70\x6f\x73\x74\137\x6d\151\x6d\x65\137\164\x79\x70\145" => $filetype["\x74\171\160\x65"], "\x70\x6f\x73\164\137\164\x69\164\x6c\x65" => preg_replace("\57\x5c\x2e\133\x5e\56\x5d\53\44\57", '', basename($file)), "\160\157\163\x74\x5f\143\x6f\x6e\164\145\156\x74" => '', "\x70\x6f\x73\164\137\x73\x74\141\164\x75\163" => "\151\x6e\150\x65\162\x69\164"]; goto OG0Jt; iFnUj: return $attach_id; goto q0ghk; CB12E: LjNyR: goto iFnUj; W_1Km: $filetype = wp_check_filetype($file); goto G_v1j; OG0Jt: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto jv3qO; Va1Nc: set_post_thumbnail($post_id, $attach_id); goto CB12E; Yzd36: if (!$set_thumb) { goto LjNyR; } goto Va1Nc; jv3qO: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto Yzd36; q0ghk: } }
