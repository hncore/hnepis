<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_AutoIMG { public function __construct() { goto WvxDt; O0WrA: $this->initialize_hooks(); goto tE4CL; WvxDt: if (!$this->is_metabox_options_set()) { goto dhNa7; } goto O0WrA; tE4CL: dhNa7: goto yJbBz; yJbBz: } private function is_metabox_options_set() { return isset($_POST["\137\x68\141\x75\156\137\x6d\145\164\141\x62\157\170\137\x6f\160\164\151\x6f\156\163"]) || isset($_POST["\137\x76\151\144\x65\157\x73\137\155\145\164\141\x62\x6f\170\137\157\x70\164\151\x6f\156\x73"]) || isset($_POST["\137\x6e\x65\167\x73\137\155\x65\164\141\142\x6f\170\137\157\160\164\x69\157\156\163"]); } private function initialize_hooks() { goto cfk5b; edDbx: if (!(!empty($meta_options["\x73\141\166\x65\x5f\x70\x6f\163\164\145\x72\137\151\155\x61\x67\x65"]) || !empty($meta_options["\x73\x65\164\x5f\x72\x65\141\x74\x75\162\x65\x64\137\x69\x6d\x61\147\x65"]) || !empty($video_meta["\x73\145\164\137\x61\x73\137\146\x65\x61\164\x75\162\x65\144\x5f\151\x6d\141\x67\145"]))) { goto KKFjz; } goto Gi6KA; WKxU9: sor83: goto edDbx; KTq4u: add_filter("\143\157\156\x74\x65\x6e\164\x5f\x73\x61\x76\x65\137\x70\162\x65", [$this, "\x68\141\x75\156\137\160\x6f\x73\x74\137\163\141\166\x65\x5f\151\x6d\x61\147\x65\163"]); goto WKxU9; Rbp16: KKFjz: goto wuPh5; Gi6KA: add_action("\x73\x61\x76\145\x5f\160\x6f\x73\x74", [$this, "\110\116\x47\145\156\145\x72\141\164\145\137\120\x6f\163\x74\x65\162\137\111\x6d\x61\147\145"]); goto Rbp16; NBKKG: $news_meta = $_POST["\x5f\156\145\x77\163\137\155\145\164\x61\x62\x6f\170\137\157\x70\x74\151\157\156\163"] ?? ''; goto y3J5A; cfk5b: $meta_options = $_POST["\x5f\150\x61\165\156\137\x6d\x65\164\x61\142\157\170\137\157\160\x74\151\x6f\x6e\163"] ?? ''; goto NBKKG; y3J5A: $video_meta = $_POST["\137\166\151\x64\145\x6f\x73\x5f\x6d\145\164\x61\x62\x6f\x78\137\x6f\x70\x74\x69\157\x6e\x73"] ?? ''; goto BBRTJ; BBRTJ: if (!(!empty($meta_options["\163\141\166\x65\137\x61\154\x6c\137\x69\155\x67"]) || !empty($news_meta["\163\x61\x76\145\x5f\141\154\x6c\x5f\151\155\147"]))) { goto sor83; } goto KTq4u; wuPh5: } public function HNGenerate_Poster_Image($post_id) { goto gLG2C; gLG2C: global $post; goto dDmTp; dDmTp: if ($post->post_type === "\x76\151\144\145\157") { goto I_tBq; } goto l0VFO; uJbAK: ALvLK: goto Iea4O; bHgV7: PAwEs: goto KHcHi; vj2pZ: $this->process_video_thumbnail($post_id, $_POST["\137\x76\151\144\x65\x6f\x73\x5f\x6d\145\164\x61\x62\x6f\x78\x5f\157\160\x74\151\x6f\x6e\x73"] ?? ''); goto nNxyy; KHcHi: $this->process_post_thumbnail($post_id); goto uJbAK; nNxyy: goto ALvLK; goto bHgV7; l0VFO: if ($post->post_type === "\x70\x6f\x73\x74") { goto PAwEs; } goto jZXFJ; jZXFJ: goto ALvLK; goto mMX_J; mMX_J: I_tBq: goto vj2pZ; Iea4O: } private function process_video_thumbnail($post_id, $video_meta) { goto OY5Iq; OY5Iq: $image_url = $video_meta["\x76\x69\144\145\x6f\x5f\x74\x68\165\155\x62\156\141\151\154\x5f\165\162\154"] ?? ''; goto ArXlq; Eyg1F: $this->haun_save_images($image_url, $post_id, $_POST["\160\157\163\164\x5f\x74\151\164\154\145"] ?? '', true); goto tACs9; tACs9: ki9YK: goto tWGSZ; jA7hJ: if (!($set_feature && !has_post_thumbnail($post_id))) { goto ki9YK; } goto Eyg1F; ArXlq: $set_feature = $video_meta["\163\x65\x74\137\141\x73\137\146\x65\x61\x74\x75\x72\145\144\x5f\151\155\141\147\145"] ?? ''; goto jA7hJ; tWGSZ: } private function process_post_thumbnail($post_id) { goto wcTSu; a1RXP: goto hTz6q; goto QbubS; TPuzc: $check_meta = $_POST["\x5f\150\141\165\156\137\155\145\x74\x61\142\x6f\x78\137\157\160\164\x69\x6f\x6e\x73"] ?? ''; goto lVDsV; amEF5: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto qJfuW; } goto xgcoD; wcTSu: $meta = get_post_meta($post_id, HNMG_META, true); goto TPuzc; mAQoF: update_post_meta($post_id, HNMG_META, $meta); goto uwIdJ; QbubS: XVa14: goto arNZA; u3QEp: if ($save_poster && $poster_url) { goto XVa14; } goto Uc5Dh; p9Ss7: $meta["\163\x61\x76\145\x5f\x70\157\x73\x74\x65\x72\137\151\x6d\141\147\145"] = ''; goto rWXTw; Uc5Dh: $poster_image_url = $poster_url; goto a1RXP; qFTgc: $save_poster = $meta["\163\141\x76\x65\137\160\157\163\x74\x65\162\x5f\x69\155\x61\x67\145"] ?? ''; goto amEF5; CC1uI: $meta["\150\141\165\x6e\x5f\x70\157\x73\x74\145\x72\x5f\x75\162\154"] = $poster_image_url; goto p9Ss7; arNZA: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\x70\157\163\x74\137\x74\x69\164\154\x65"] ?? ''); goto Gqdvb; y7xRH: $meta["\x68\141\x75\156\x5f\x74\x68\165\x6d\x62\137\165\162\154"] = get_the_post_thumbnail_url($post_id, "\x6d\x6f\166\151\x65\55\x74\x68\x75\155\x62") ?: $thumb_url; goto CC1uI; YiQWb: qJfuW: goto u3QEp; Cb8fS: $set_feature = $meta["\x73\x65\164\137\x72\x65\x61\164\165\162\x65\x64\x5f\151\155\141\x67\145"] ?? ''; goto qFTgc; Gqdvb: hTz6q: goto y7xRH; lVDsV: $thumb_url = $check_meta["\x68\141\x75\156\x5f\x74\150\x75\155\x62\x5f\x75\162\x6c"] ?? $meta["\x68\x61\165\x6e\x5f\x74\x68\165\x6d\142\x5f\165\x72\154"] ?? ''; goto hRFpZ; hRFpZ: $poster_url = $check_meta["\150\x61\165\x6e\x5f\160\x6f\x73\164\x65\x72\x5f\165\x72\x6c"] ?? $meta["\x68\x61\165\156\x5f\160\157\163\x74\x65\162\137\165\x72\x6c"] ?? ''; goto Cb8fS; rWXTw: $meta["\x73\x65\x74\137\x72\145\141\x74\165\162\x65\x64\x5f\x69\155\x61\x67\x65"] = ''; goto mAQoF; xgcoD: $this->haun_save_images($thumb_url, $post_id, $_POST["\160\x6f\163\164\x5f\164\151\164\x6c\x65"] ?? '', true); goto YiQWb; uwIdJ: } public function haun_post_save_images($content) { goto OoEVk; Cfg_i: hRkuO: goto cxlHr; Jn3Pv: foreach ($matches[1] as $image_url) { goto nwEKe; XiHON: HEqpx: goto g5KrF; nwEKe: if (!($image_url && strpos($image_url, $_SERVER["\110\x54\x54\x50\x5f\110\117\x53\x54"]) === false)) { goto HEqpx; } goto LX8j7; g5KrF: dmvlD: goto zbr35; g9erP: $content = str_replace($image_url, $res["\165\162\154"], $content); goto XiHON; LX8j7: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto g9erP; zbr35: } goto Cfg_i; d106a: $post_title = $_POST["\x70\x6f\x73\164\x5f\164\x69\164\x6c\x65"] ?? ''; goto whIxA; whIxA: preg_match_all("\57\x3c\x69\155\147\x2e\x2a\77\x73\x72\x63\75\42\50\x2e\52\77\x29\42\x2f", stripslashes($content), $matches); goto Jn3Pv; OoEVk: if (!(isset($_POST["\163\x61\166\145"]) || isset($_POST["\160\x75\142\x6c\151\163\x68"]))) { goto kMOln; } goto qwsmJ; cxlHr: kMOln: goto Sw5cg; qwsmJ: set_time_limit(500); goto cKs_g; FSly2: return $content; goto cOuCi; Sw5cg: remove_filter("\x63\157\156\x74\x65\x6e\164\x5f\x73\x61\x76\145\x5f\x70\162\x65", [$this, "\x68\141\165\x6e\137\x70\157\x73\x74\137\x73\141\166\145\137\151\155\x61\147\x65\x73"]); goto FSly2; cKs_g: $post_id = get_the_ID(); goto d106a; cOuCi: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto YugqJ; MhNrX: $this->haun_insert_attachment($res["\146\151\x6c\145"], $post_id, $set_thumb); goto cBiHj; v1XUJ: $im_name = sanitize_title($post_title) . "\x2d{$post_id}\56\x6a\x70\147"; goto e2pov; EL4GH: return $res; goto zdM3E; e2pov: $res = wp_upload_bits($im_name, '', $file); goto Nntg6; Nntg6: if ($res["\x65\x72\x72\157\162"]) { goto fQSFV; } goto MhNrX; cBiHj: fQSFV: goto EL4GH; YugqJ: $file = file_get_contents($image_url); goto v1XUJ; zdM3E: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto rjFvC; t1A8H: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto b7KNa; uG9kO: if (!$set_thumb) { goto dGXWM; } goto K6p0Y; Xlp1Z: return $attach_id; goto fwqsN; rjFvC: $filetype = wp_check_filetype($file); goto t6pTz; t6pTz: $attachment = ["\x67\165\x69\x64" => wp_get_upload_dir()["\x75\162\x6c"] . "\x2f" . _wp_relative_upload_path($file), "\160\x6f\x73\x74\137\155\151\155\145\x5f\164\x79\160\145" => $filetype["\164\x79\160\145"], "\160\157\x73\x74\x5f\x74\151\164\x6c\145" => preg_replace("\57\x5c\x2e\133\136\56\x5d\53\x24\x2f", '', basename($file)), "\x70\x6f\x73\x74\x5f\143\157\156\x74\x65\x6e\164" => '', "\x70\157\x73\164\137\163\164\x61\164\165\163" => "\x69\156\x68\x65\162\151\x74"]; goto t1A8H; K6p0Y: set_post_thumbnail($post_id, $attach_id); goto juMLa; b7KNa: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto uG9kO; juMLa: dGXWM: goto Xlp1Z; fwqsN: } }
