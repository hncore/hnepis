<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_News { public function __construct() { goto dbVsb; JN4mY: $this->initialize_hooks(); goto QuTpD; QuTpD: sHLG2: goto y7tH2; dbVsb: if (!$this->is_metabox_options_set()) { goto sHLG2; } goto JN4mY; y7tH2: } private function is_metabox_options_set() { return isset($_POST["\137\x68\x61\x75\x6e\137\155\x65\164\x61\x62\157\170\x5f\x6f\160\164\151\x6f\156\x73"]) || isset($_POST["\x5f\166\x69\x64\145\157\x73\137\x6d\x65\x74\141\142\157\x78\x5f\x6f\x70\164\x69\157\x6e\163"]) || isset($_POST["\x5f\x6e\145\x77\x73\x5f\x6d\145\x74\141\142\x6f\x78\137\x6f\160\164\x69\x6f\156\x73"]); } private function initialize_hooks() { goto tJN7x; qw93a: tdwSM: goto xbNkK; lajZB: $news_meta = $_POST["\x5f\x6e\x65\167\163\x5f\x6d\x65\164\141\x62\x6f\x78\137\x6f\160\x74\151\157\156\x73"] ?? ''; goto XCJbZ; tJN7x: $meta_options = $_POST["\137\150\x61\x75\156\x5f\x6d\145\164\141\142\157\170\x5f\157\160\x74\x69\x6f\156\x73"] ?? ''; goto lajZB; qbayM: add_filter("\143\x6f\156\x74\145\156\x74\137\x73\x61\166\x65\137\160\x72\x65", [$this, "\x68\141\165\156\137\x70\157\x73\164\137\x73\x61\166\145\137\x69\x6d\141\147\145\x73"]); goto qw93a; XCJbZ: $video_meta = $_POST["\x5f\166\151\x64\x65\x6f\x73\137\x6d\x65\164\x61\x62\x6f\170\137\157\160\x74\x69\157\x6e\x73"] ?? ''; goto Bxwfk; Bxwfk: if (!(!empty($meta_options["\163\x61\166\145\x5f\x61\x6c\154\x5f\x69\155\x67"]) || !empty($news_meta["\x73\x61\x76\x65\x5f\x61\154\154\x5f\151\x6d\147"]))) { goto tdwSM; } goto qbayM; xbNkK: if (!(!empty($meta_options["\x73\141\x76\145\137\x70\157\x73\164\x65\x72\137\151\155\141\147\145"]) || !empty($meta_options["\x73\x65\164\x5f\162\145\x61\164\165\x72\x65\x64\x5f\151\155\141\147\145"]) || !empty($video_meta["\163\145\x74\137\x61\163\137\146\x65\141\164\165\x72\x65\x64\137\x69\x6d\x61\147\x65"]))) { goto x4pLj; } goto C4fYx; bea5C: x4pLj: goto HIUxn; C4fYx: add_action("\163\x61\x76\145\137\x70\157\163\164", [$this, "\110\x4e\x47\x65\156\145\x72\141\x74\x65\x5f\x50\x6f\163\164\x65\x72\x5f\111\155\141\147\x65"]); goto bea5C; HIUxn: } public function HNGenerate_Poster_Image($post_id) { goto hI9vo; HxlQZ: n3LIY: goto wUu3h; rXWYK: wfiN1: goto Dz51w; Dz51w: $this->process_post_thumbnail($post_id); goto k0UbW; wUu3h: $this->process_video_thumbnail($post_id, $_POST["\x5f\x76\x69\144\x65\157\163\137\155\x65\x74\x61\142\x6f\x78\x5f\x6f\x70\x74\151\x6f\x6e\x73"] ?? ''); goto tTyJN; q6WRN: if ($post->post_type === "\x76\x69\x64\x65\157") { goto n3LIY; } goto pB1UU; k0UbW: O8ExG: goto RzDT6; hI9vo: global $post; goto q6WRN; tTyJN: goto O8ExG; goto rXWYK; C2UjM: goto O8ExG; goto HxlQZ; pB1UU: if ($post->post_type === "\x70\157\163\164") { goto wfiN1; } goto C2UjM; RzDT6: } private function process_video_thumbnail($post_id, $video_meta) { goto rWkL3; PP3da: if (!($set_feature && !has_post_thumbnail($post_id))) { goto Jge2c; } goto UjEkP; UjEkP: $this->haun_save_images($image_url, $post_id, $_POST["\x70\157\163\164\137\x74\151\x74\154\x65"] ?? '', true); goto i2lrN; RONqX: $set_feature = $video_meta["\x73\x65\164\137\x61\163\137\x66\x65\x61\x74\165\162\x65\144\137\x69\x6d\141\147\145"] ?? ''; goto PP3da; i2lrN: Jge2c: goto QObMd; rWkL3: $image_url = $video_meta["\166\151\x64\145\157\x5f\x74\x68\165\x6d\x62\x6e\x61\151\x6c\x5f\x75\162\154"] ?? ''; goto RONqX; QObMd: } private function process_post_thumbnail($post_id) { goto S38F2; f2N6G: tC06o: goto T2AWJ; EC3MD: update_post_meta($post_id, HNMG_META, $meta); goto ZZBMc; En3Wf: if ($save_poster && $poster_url) { goto nZKGU; } goto nMGUx; IJHgV: goto tC06o; goto E8Y7G; gxTWU: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\x70\x6f\163\164\137\164\x69\164\154\x65"] ?? ''); goto f2N6G; kZtMp: CoshL: goto En3Wf; lgbNR: $set_feature = $meta["\163\x65\164\x5f\162\145\x61\x74\165\162\145\x64\x5f\x69\155\141\x67\x65"] ?? ''; goto uyeSt; caxL5: $meta["\x73\145\x74\x5f\x72\145\141\x74\x75\162\145\144\x5f\x69\x6d\141\147\145"] = ''; goto EC3MD; nMGUx: $poster_image_url = $poster_url; goto IJHgV; Ttv_O: $meta["\x68\141\x75\156\137\x70\157\x73\x74\145\x72\137\x75\162\154"] = $poster_image_url; goto uE7P8; uyeSt: $save_poster = $meta["\163\141\166\145\137\160\157\163\x74\145\x72\x5f\151\x6d\141\x67\x65"] ?? ''; goto zzlBz; S38F2: $meta = get_post_meta($post_id, HNMG_META, true); goto Zcw2c; zzlBz: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto CoshL; } goto Oh0Q6; Oh0Q6: $this->haun_save_images($thumb_url, $post_id, $_POST["\x70\x6f\163\164\x5f\164\x69\164\x6c\145"] ?? '', true); goto kZtMp; xpCwK: $thumb_url = $check_meta["\150\x61\x75\x6e\137\164\x68\x75\x6d\142\x5f\x75\x72\x6c"] ?? $meta["\x68\141\x75\x6e\137\164\x68\x75\155\x62\137\x75\162\x6c"] ?? ''; goto v9Ive; uE7P8: $meta["\x73\x61\166\x65\x5f\160\x6f\163\164\145\x72\x5f\x69\x6d\141\147\145"] = ''; goto caxL5; E8Y7G: nZKGU: goto gxTWU; Zcw2c: $check_meta = $_POST["\137\x68\141\165\x6e\x5f\x6d\x65\164\x61\142\x6f\170\137\157\x70\164\151\x6f\156\163"] ?? ''; goto xpCwK; v9Ive: $poster_url = $check_meta["\150\141\x75\156\x5f\x70\x6f\x73\x74\x65\x72\137\165\x72\x6c"] ?? $meta["\x68\x61\165\156\x5f\160\x6f\x73\164\145\162\x5f\165\x72\x6c"] ?? ''; goto lgbNR; T2AWJ: $meta["\x68\141\165\x6e\x5f\164\150\x75\x6d\142\137\x75\x72\154"] = get_the_post_thumbnail_url($post_id, "\155\x6f\x76\x69\145\55\164\150\x75\x6d\x62") ?: $thumb_url; goto Ttv_O; ZZBMc: } public function haun_post_save_images($content) { goto dQgeF; lEKn_: $post_title = $_POST["\x70\157\163\164\137\164\151\x74\x6c\145"] ?? ''; goto D56xZ; nY0ja: remove_filter("\x63\x6f\156\164\145\x6e\164\137\x73\x61\x76\145\x5f\x70\x72\x65", [$this, "\x68\141\x75\156\137\160\x6f\x73\x74\x5f\x73\x61\x76\x65\x5f\151\155\141\x67\x65\x73"]); goto etcmt; ybmYx: $post_id = get_the_ID(); goto lEKn_; uFFqF: lt_7D: goto nY0ja; dQgeF: if (!(isset($_POST["\163\141\x76\145"]) || isset($_POST["\x70\x75\142\154\151\x73\x68"]))) { goto lt_7D; } goto ISRmY; etcmt: return $content; goto o19Sa; cGhmW: foreach ($matches[1] as $image_url) { goto IYCS2; yJe17: pjXI4: goto CP815; l67Mq: $content = str_replace($image_url, $res["\x75\x72\154"], $content); goto yJe17; CP815: P2G_N: goto rytP9; XoUet: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto l67Mq; IYCS2: if (!($image_url && strpos($image_url, $_SERVER["\110\124\x54\x50\x5f\x48\117\123\124"]) === false)) { goto pjXI4; } goto XoUet; rytP9: } goto GMw27; GMw27: rmt5Q: goto uFFqF; D56xZ: preg_match_all("\57\x3c\x69\155\147\56\52\77\x73\x72\x63\75\42\50\x2e\52\x3f\x29\42\57", stripslashes($content), $matches); goto cGhmW; ISRmY: set_time_limit(500); goto ybmYx; o19Sa: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto Tw2Nx; HU41K: $this->haun_insert_attachment($res["\146\151\x6c\145"], $post_id, $set_thumb); goto h_A7p; llm86: return $res; goto q2RBV; h_A7p: aWQRd: goto llm86; ZQGhX: if ($res["\x65\162\x72\157\x72"]) { goto aWQRd; } goto HU41K; XPCuw: $im_name = sanitize_title($post_title) . "\55{$post_id}\56\152\160\147"; goto PdxqC; Tw2Nx: $file = file_get_contents($image_url); goto XPCuw; PdxqC: $res = wp_upload_bits($im_name, '', $file); goto ZQGhX; q2RBV: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto Hf7eS; Hf7eS: $filetype = wp_check_filetype($file); goto n8EYr; lD8Wj: return $attach_id; goto b0ARK; Yj1EW: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto b1rvh; LQ_f0: set_post_thumbnail($post_id, $attach_id); goto VKjhn; b1rvh: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto Zy13T; VKjhn: bRHkZ: goto lD8Wj; Zy13T: if (!$set_thumb) { goto bRHkZ; } goto LQ_f0; n8EYr: $attachment = ["\147\165\x69\144" => wp_get_upload_dir()["\165\162\x6c"] . "\x2f" . _wp_relative_upload_path($file), "\160\157\x73\x74\137\155\151\x6d\145\x5f\x74\171\x70\x65" => $filetype["\x74\171\x70\145"], "\x70\157\x73\x74\137\164\x69\x74\154\145" => preg_replace("\x2f\x5c\56\133\x5e\x2e\135\x2b\44\x2f", '', basename($file)), "\160\x6f\x73\x74\137\143\157\156\164\x65\x6e\x74" => '', "\160\x6f\163\x74\137\163\164\x61\164\x75\x73" => "\x69\156\x68\x65\x72\151\164"]; goto Yj1EW; b0ARK: } }
