<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_AutoIMG { public function __construct() { goto J897Q; J897Q: if (!$this->is_metabox_options_set()) { goto PD3Cj; } goto maRWv; iZcC_: PD3Cj: goto tvq0J; maRWv: $this->initialize_hooks(); goto iZcC_; tvq0J: } private function is_metabox_options_set() { return isset($_POST["\137\x68\141\165\x6e\155\145\164\x61\142\157\170"]) || isset($_POST["\137\166\x69\144\145\x6f\x73\137\x6d\145\164\x61\142\157\x78\x5f\157\x70\164\x69\157\x6e\x73"]) || isset($_POST["\137\156\145\167\x73\x5f\x6d\145\x74\x61\142\x6f\170\137\157\160\x74\x69\157\156\x73"]); } private function initialize_hooks() { goto hm5_6; c1rnn: add_action("\x73\141\166\x65\x5f\x70\157\163\x74", [$this, "\110\x4e\107\x65\156\x65\x72\141\x74\x65\x5f\x50\x6f\163\x74\145\x72\x5f\111\155\x61\x67\x65"]); goto zY4ON; KXa3c: $news_meta = $_POST["\137\x6e\145\167\163\x5f\155\x65\x74\141\142\157\170\137\x6f\160\164\151\157\156\163"] ?? ''; goto X22Qv; zY4ON: lpDq2: goto tsMXk; hm5_6: $meta_options = $_POST["\137\150\x61\165\x6e\x6d\x65\x74\141\x62\x6f\170"] ?? ''; goto KXa3c; G_MXt: add_filter("\143\157\156\x74\145\156\164\x5f\163\141\166\x65\137\160\x72\145", [$this, "\x68\x61\x75\x6e\x5f\160\157\x73\164\x5f\x73\x61\166\145\x5f\x69\155\141\147\145\163"]); goto abEzc; CxnN2: if (!(!empty($meta_options["\163\141\166\145\137\141\154\154\137\x69\155\x67"]) || !empty($news_meta["\x73\141\166\x65\137\x61\154\x6c\137\x69\155\x67"]))) { goto kWFb9; } goto G_MXt; zaMcU: if (!(!empty($meta_options["\x73\141\166\145\x5f\x70\x6f\x73\x74\145\162\137\x69\x6d\x61\147\145"]) || !empty($meta_options["\x73\145\x74\x5f\162\x65\x61\164\x75\162\x65\144\137\x69\x6d\x61\147\145"]) || !empty($video_meta["\x73\x65\164\137\141\x73\137\146\145\x61\164\165\162\145\144\137\x69\155\x61\147\145"]))) { goto lpDq2; } goto c1rnn; X22Qv: $video_meta = $_POST["\x5f\166\x69\144\x65\x6f\163\x5f\x6d\x65\164\x61\x62\157\x78\x5f\x6f\x70\x74\x69\x6f\x6e\163"] ?? ''; goto CxnN2; abEzc: kWFb9: goto zaMcU; tsMXk: } public function HNGenerate_Poster_Image($post_id) { goto rzYqs; Deh6a: if ($post->post_type === "\160\x6f\x73\164") { goto l6BAv; } goto pjgWo; pjgWo: goto jlMDg; goto p0uz6; rzYqs: global $post; goto z0z0t; p0uz6: UfuQN: goto MfAa9; w4OzX: l6BAv: goto DSq8c; z0z0t: if ($post->post_type === "\x76\x69\144\x65\157") { goto UfuQN; } goto Deh6a; MfAa9: $this->process_video_thumbnail($post_id, $_POST["\137\166\x69\x64\145\x6f\163\x5f\155\x65\x74\141\142\x6f\170\x5f\157\x70\x74\151\157\156\x73"] ?? ''); goto Bd3gx; rzZu9: jlMDg: goto xy1nI; Bd3gx: goto jlMDg; goto w4OzX; DSq8c: $this->process_post_thumbnail($post_id); goto rzZu9; xy1nI: } private function process_video_thumbnail($post_id, $video_meta) { goto Iw1wo; Iw1wo: $image_url = $video_meta["\x76\x69\x64\x65\x6f\137\164\150\165\155\142\x6e\141\x69\x6c\x5f\x75\162\x6c"] ?? ''; goto SZDqq; yX_xK: afTkr: goto yTWxO; J1Ozj: $this->haun_save_images($image_url, $post_id, $_POST["\160\157\x73\x74\x5f\x74\151\x74\154\x65"] ?? '', true); goto yX_xK; HUx2k: if (!($set_feature && !has_post_thumbnail($post_id))) { goto afTkr; } goto J1Ozj; SZDqq: $set_feature = $video_meta["\x73\x65\164\x5f\x61\x73\137\146\145\141\x74\x75\162\145\144\137\151\155\141\x67\x65"] ?? ''; goto HUx2k; yTWxO: } private function process_post_thumbnail($post_id) { goto bdF9F; TQfmW: $meta["\x68\141\x75\156\137\160\x6f\163\164\145\x72\x5f\165\x72\x6c"] = $poster_image_url; goto AtVK9; envjh: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto RRgwj; } goto vB6nD; vB6nD: $this->haun_save_images($thumb_url, $post_id, $_POST["\x70\157\x73\164\137\164\151\x74\154\145"] ?? '', true); goto Ki90K; qhONV: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\160\157\x73\164\x5f\164\x69\x74\154\145"] ?? ''); goto KZkBW; hvwpF: E0AIz: goto qhONV; qhCZl: if ($save_poster && $poster_url) { goto E0AIz; } goto p5uqC; cSXG0: update_haunmovies($post_id, HNMG_META, $meta); goto bq5Gc; mouFc: $check_meta = $_POST["\137\x68\141\165\156\x6d\145\164\141\x62\x6f\x78"] ?? ''; goto wYAcH; AtVK9: $meta["\x73\141\166\x65\x5f\x70\157\163\164\x65\x72\137\151\x6d\x61\x67\145"] = ''; goto IHY_O; IHY_O: $meta["\163\x65\164\x5f\162\145\141\x74\x75\x72\145\x64\137\151\155\141\x67\145"] = ''; goto cSXG0; KZkBW: S3VuY: goto NdLvh; Ki90K: RRgwj: goto qhCZl; Ml6iK: $save_poster = $meta["\163\141\x76\x65\x5f\160\157\x73\164\145\162\x5f\x69\155\141\x67\x65"] ?? ''; goto envjh; P0ubn: $set_feature = $meta["\163\145\164\137\162\x65\141\x74\165\x72\x65\x64\137\151\x6d\141\x67\x65"] ?? ''; goto Ml6iK; wYAcH: $thumb_url = $check_meta["\x68\141\x75\x6e\x5f\164\x68\x75\x6d\142\137\165\162\x6c"] ?? $meta["\x68\x61\x75\x6e\137\x74\150\165\x6d\142\137\165\162\154"] ?? ''; goto TOkrN; bdF9F: $meta = get_haunmovies($post_id, HNMG_META, true); goto mouFc; p5uqC: $poster_image_url = $poster_url; goto FPTmW; NdLvh: $meta["\x68\141\x75\156\137\164\150\x75\155\x62\137\165\162\154"] = get_the_post_thumbnail_url($post_id, "\155\x6f\166\x69\x65\55\164\x68\165\155\x62") ?: $thumb_url; goto TQfmW; FPTmW: goto S3VuY; goto hvwpF; TOkrN: $poster_url = $check_meta["\x68\x61\165\x6e\137\x70\157\x73\164\x65\x72\137\165\162\x6c"] ?? $meta["\x68\x61\165\x6e\137\160\157\163\164\x65\162\x5f\x75\162\x6c"] ?? ''; goto P0ubn; bq5Gc: } public function haun_post_save_images($content) { goto OCR6i; yP4K3: return $content; goto BKwH_; OCR6i: if (!(isset($_POST["\163\141\166\x65"]) || isset($_POST["\x70\x75\x62\154\151\x73\x68"]))) { goto rXjGv; } goto KvHr8; UCyfD: remove_filter("\143\x6f\156\164\145\156\164\137\x73\141\x76\x65\137\x70\162\145", [$this, "\150\141\165\x6e\137\x70\x6f\163\164\x5f\163\141\x76\x65\x5f\151\x6d\x61\147\x65\163"]); goto yP4K3; KvHr8: set_time_limit(500); goto tSsrr; VPQ4k: dZlib: goto hRbuB; xz5ej: foreach ($matches[1] as $image_url) { goto k6gb_; Lg9Ur: $content = str_replace($image_url, $res["\165\x72\154"], $content); goto ch1y4; ch1y4: FKHls: goto uFLfB; n7s_s: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto Lg9Ur; uFLfB: ZlhI3: goto IOqHz; k6gb_: if (!($image_url && strpos($image_url, $_SERVER["\x48\x54\124\120\x5f\x48\x4f\123\124"]) === false)) { goto FKHls; } goto n7s_s; IOqHz: } goto VPQ4k; hRbuB: rXjGv: goto UCyfD; JiptY: $post_title = $_POST["\160\x6f\x73\164\137\x74\x69\164\x6c\x65"] ?? ''; goto AMkx_; AMkx_: preg_match_all("\57\x3c\151\155\147\56\52\x3f\x73\162\143\75\x22\50\56\x2a\77\x29\42\57", stripslashes($content), $matches); goto xz5ej; tSsrr: $post_id = get_the_ID(); goto JiptY; BKwH_: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto sOO27; CT5Vv: if ($res["\x65\162\x72\x6f\162"]) { goto pPCdE; } goto iwLdq; KV0Za: $im_name = sanitize_title($post_title) . "\x2d{$post_id}\56\152\x70\x67"; goto kwbvs; v0AH5: pPCdE: goto hf03k; iwLdq: $this->haun_insert_attachment($res["\x66\151\x6c\145"], $post_id, $set_thumb); goto v0AH5; kwbvs: $res = wp_upload_bits($im_name, '', $file); goto CT5Vv; sOO27: $file = file_get_contents($image_url); goto KV0Za; hf03k: return $res; goto VXVgw; VXVgw: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto SDS3g; yRQJd: $attachment = ["\147\165\x69\144" => wp_get_upload_dir()["\165\162\154"] . "\x2f" . _wp_relative_upload_path($file), "\x70\x6f\163\x74\137\155\x69\x6d\x65\x5f\164\x79\160\145" => $filetype["\x74\x79\160\145"], "\x70\x6f\163\x74\137\164\151\x74\154\145" => preg_replace("\x2f\134\56\x5b\x5e\56\135\x2b\44\57", '', basename($file)), "\160\x6f\x73\x74\137\143\157\x6e\x74\x65\156\x74" => '', "\x70\x6f\163\164\137\x73\164\141\x74\x75\x73" => "\151\156\150\145\x72\151\x74"]; goto y1nDI; fuT44: if (!$set_thumb) { goto zDMlV; } goto MBewq; MBewq: set_post_thumbnail($post_id, $attach_id); goto tBBvJ; y1nDI: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto dC2Cw; tBBvJ: zDMlV: goto cpW0L; SDS3g: $filetype = wp_check_filetype($file); goto yRQJd; cpW0L: return $attach_id; goto QL8Iq; dC2Cw: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto fuT44; QL8Iq: } }
