<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_AutoIMG { public function __construct() { goto FZ2sB; IcHAx: $this->initialize_hooks(); goto tWZIp; FZ2sB: if (!$this->is_metabox_options_set()) { goto ylW9m; } goto IcHAx; tWZIp: ylW9m: goto vxhXR; vxhXR: } private function is_metabox_options_set() { return isset($_POST["\x5f\x68\141\165\x6e\137\x6d\x65\x74\x61\142\x6f\x78\137\x6f\160\x74\151\x6f\156\163"]) || isset($_POST["\137\166\x69\144\x65\157\x73\137\155\145\x74\x61\142\157\x78\137\157\x70\x74\151\157\x6e\x73"]) || isset($_POST["\x5f\156\x65\x77\x73\137\155\x65\164\x61\142\157\x78\x5f\157\x70\x74\x69\157\x6e\x73"]); } private function initialize_hooks() { goto EhIAJ; aK4KL: add_filter("\143\x6f\x6e\164\x65\x6e\x74\137\163\141\166\x65\137\160\162\x65", [$this, "\x68\141\x75\x6e\x5f\160\x6f\x73\x74\137\163\x61\x76\x65\137\x69\x6d\x61\x67\145\163"]); goto o3YIL; uVCMu: $news_meta = $_POST["\137\x6e\x65\x77\x73\137\155\145\164\x61\142\157\170\x5f\x6f\x70\164\151\x6f\156\163"] ?? ''; goto QV4Lg; W_Hkz: if (!(!empty($meta_options["\x73\141\166\145\137\x70\x6f\x73\x74\x65\x72\137\151\x6d\141\x67\145"]) || !empty($meta_options["\163\x65\164\x5f\x72\145\x61\164\165\162\x65\144\x5f\x69\155\141\x67\x65"]) || !empty($video_meta["\163\145\x74\137\141\163\x5f\146\145\141\x74\x75\162\145\144\x5f\x69\155\x61\x67\145"]))) { goto KvQ2b; } goto l2KtE; l2KtE: add_action("\x73\141\x76\x65\137\x70\157\x73\x74", [$this, "\110\x4e\x47\x65\156\145\162\x61\164\x65\137\x50\x6f\x73\x74\x65\x72\x5f\111\x6d\141\147\x65"]); goto sXWZl; o3YIL: U3TRx: goto W_Hkz; iuofE: if (!(!empty($meta_options["\163\x61\x76\145\137\x61\154\x6c\137\151\x6d\147"]) || !empty($news_meta["\163\x61\x76\x65\x5f\141\x6c\154\x5f\151\155\147"]))) { goto U3TRx; } goto aK4KL; QV4Lg: $video_meta = $_POST["\x5f\166\x69\x64\145\157\x73\137\x6d\x65\x74\141\x62\x6f\170\x5f\x6f\160\x74\x69\157\x6e\163"] ?? ''; goto iuofE; EhIAJ: $meta_options = $_POST["\x5f\150\141\165\156\x5f\155\145\x74\x61\x62\x6f\170\x5f\x6f\160\164\x69\x6f\x6e\163"] ?? ''; goto uVCMu; sXWZl: KvQ2b: goto m9IrL; m9IrL: } public function HNGenerate_Poster_Image($post_id) { goto ElfBI; z00PQ: C0SoH: goto XXIU_; x6MtY: $this->process_post_thumbnail($post_id); goto vWE0X; B_1po: qkXC0: goto x6MtY; TNFjg: goto PcP67; goto z00PQ; vWE0X: PcP67: goto zOCby; XXIU_: $this->process_video_thumbnail($post_id, $_POST["\x5f\x76\x69\144\x65\157\163\137\155\x65\x74\x61\x62\157\x78\x5f\157\160\164\151\x6f\x6e\x73"] ?? ''); goto x8A50; MR0cq: if ($post->post_type === "\x70\157\x73\164") { goto qkXC0; } goto TNFjg; x8A50: goto PcP67; goto B_1po; ElfBI: global $post; goto li17J; li17J: if ($post->post_type === "\x76\151\x64\145\157") { goto C0SoH; } goto MR0cq; zOCby: } private function process_video_thumbnail($post_id, $video_meta) { goto aYtV2; aYtV2: $image_url = $video_meta["\x76\151\144\145\157\x5f\164\x68\x75\155\x62\156\141\151\x6c\137\165\x72\154"] ?? ''; goto dFK01; IRc2r: RhGmh: goto TDH40; wg6fw: $this->haun_save_images($image_url, $post_id, $_POST["\160\x6f\163\x74\x5f\x74\151\164\x6c\145"] ?? '', true); goto IRc2r; dFK01: $set_feature = $video_meta["\163\145\164\x5f\141\163\x5f\x66\145\141\x74\165\x72\145\x64\x5f\151\x6d\141\147\145"] ?? ''; goto W3YFR; W3YFR: if (!($set_feature && !has_post_thumbnail($post_id))) { goto RhGmh; } goto wg6fw; TDH40: } private function process_post_thumbnail($post_id) { goto ToL0M; YmfxF: if ($save_poster && $poster_url) { goto vCX1x; } goto hcXWt; MYWbl: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto HZHNy; } goto Q2Iju; o6j0s: $meta["\x68\x61\165\x6e\137\164\x68\165\155\142\137\x75\x72\x6c"] = get_the_post_thumbnail_url($post_id, "\155\157\166\151\x65\x2d\x74\x68\x75\x6d\x62") ?: $thumb_url; goto Nt50d; hcXWt: $poster_image_url = $poster_url; goto odbYM; DW_x5: $save_poster = $meta["\x73\x61\166\145\137\x70\157\163\x74\145\x72\x5f\151\x6d\x61\x67\145"] ?? ''; goto MYWbl; XaNDQ: HZHNy: goto YmfxF; NyINW: $meta["\x73\141\x76\145\137\x70\157\163\164\145\x72\x5f\151\x6d\141\147\145"] = ''; goto UL61t; Nt50d: $meta["\x68\x61\x75\156\137\160\x6f\x73\x74\x65\162\137\165\x72\154"] = $poster_image_url; goto NyINW; YU9n2: vlgAO: goto o6j0s; odbYM: goto vlgAO; goto RUJBO; MBB_O: $check_meta = $_POST["\x5f\150\x61\165\x6e\x5f\155\x65\164\141\x62\157\x78\x5f\x6f\x70\164\x69\157\156\163"] ?? ''; goto GVrxS; GVrxS: $thumb_url = $check_meta["\x68\x61\165\156\x5f\x74\x68\x75\155\142\137\165\x72\x6c"] ?? $meta["\x68\141\x75\x6e\137\x74\150\165\155\x62\137\x75\x72\x6c"] ?? ''; goto a1mU1; Q2Iju: $this->haun_save_images($thumb_url, $post_id, $_POST["\x70\x6f\x73\x74\137\x74\x69\164\154\x65"] ?? '', true); goto XaNDQ; ToL0M: $meta = get_post_meta($post_id, HNMG_META, true); goto MBB_O; RUJBO: vCX1x: goto prxlh; UL61t: $meta["\x73\145\x74\137\162\145\141\164\x75\162\x65\x64\x5f\x69\x6d\x61\147\145"] = ''; goto fu6DF; prxlh: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\x70\x6f\163\164\137\x74\151\164\154\x65"] ?? ''); goto YU9n2; a1mU1: $poster_url = $check_meta["\x68\x61\x75\x6e\137\160\157\x73\x74\145\x72\x5f\165\162\x6c"] ?? $meta["\150\141\165\156\137\x70\x6f\x73\164\145\162\137\165\x72\154"] ?? ''; goto ebyaz; ebyaz: $set_feature = $meta["\163\x65\x74\x5f\x72\x65\141\164\x75\x72\145\x64\137\x69\x6d\141\x67\145"] ?? ''; goto DW_x5; fu6DF: update_post_meta($post_id, HNMG_META, $meta); goto nOs8X; nOs8X: } public function haun_post_save_images($content) { goto BR8pf; JW2rY: return $content; goto AiS6A; lu3gf: set_time_limit(500); goto S9reX; PylgZ: LWN9k: goto yChB_; gUQiz: preg_match_all("\57\x3c\x69\155\x67\56\x2a\77\x73\162\143\75\42\50\56\x2a\77\51\42\x2f", stripslashes($content), $matches); goto A2rqR; BR8pf: if (!(isset($_POST["\163\x61\x76\x65"]) || isset($_POST["\160\x75\x62\154\x69\163\x68"]))) { goto aoeh1; } goto lu3gf; dcTID: remove_filter("\143\x6f\156\x74\145\x6e\x74\x5f\x73\x61\166\x65\x5f\160\x72\145", [$this, "\x68\x61\x75\x6e\x5f\160\x6f\163\x74\x5f\x73\x61\166\x65\137\151\x6d\141\x67\145\x73"]); goto JW2rY; S9reX: $post_id = get_the_ID(); goto WIrcq; WIrcq: $post_title = $_POST["\160\x6f\x73\x74\137\x74\151\x74\x6c\x65"] ?? ''; goto gUQiz; A2rqR: foreach ($matches[1] as $image_url) { goto MF1sa; XVfLR: eA4VR: goto aUqP6; fN7_V: $content = str_replace($image_url, $res["\165\x72\154"], $content); goto eRhhe; eRhhe: ojVe_: goto XVfLR; MF1sa: if (!($image_url && strpos($image_url, $_SERVER["\110\x54\124\120\x5f\x48\x4f\x53\124"]) === false)) { goto ojVe_; } goto NC5hl; NC5hl: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto fN7_V; aUqP6: } goto PylgZ; yChB_: aoeh1: goto dcTID; AiS6A: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto DwC5m; hdJxJ: if ($res["\145\x72\x72\157\x72"]) { goto fbixq; } goto As2Wy; DD58L: $im_name = sanitize_title($post_title) . "\x2d{$post_id}\56\152\x70\147"; goto vXQuZ; As2Wy: $this->haun_insert_attachment($res["\146\151\x6c\x65"], $post_id, $set_thumb); goto cZksq; cZksq: fbixq: goto LW1fr; vXQuZ: $res = wp_upload_bits($im_name, '', $file); goto hdJxJ; LW1fr: return $res; goto IXXlF; DwC5m: $file = file_get_contents($image_url); goto DD58L; IXXlF: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto he7Sw; pY4GZ: if (!$set_thumb) { goto uJRID; } goto vbDLk; he7Sw: $filetype = wp_check_filetype($file); goto U_02i; vbDLk: set_post_thumbnail($post_id, $attach_id); goto Wtxtt; KVgg3: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto pY4GZ; U_02i: $attachment = ["\147\165\151\x64" => wp_get_upload_dir()["\165\162\x6c"] . "\57" . _wp_relative_upload_path($file), "\160\157\x73\164\x5f\x6d\151\155\x65\x5f\164\x79\x70\145" => $filetype["\164\171\x70\145"], "\x70\157\163\164\137\164\x69\164\154\145" => preg_replace("\57\x5c\56\x5b\136\56\135\x2b\x24\57", '', basename($file)), "\x70\x6f\x73\164\x5f\143\x6f\x6e\164\x65\156\x74" => '', "\x70\x6f\x73\164\137\x73\164\x61\x74\165\x73" => "\151\156\x68\x65\x72\151\164"]; goto TCxgp; sc0U_: return $attach_id; goto xUwXK; Wtxtt: uJRID: goto sc0U_; TCxgp: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto KVgg3; xUwXK: } }
