<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_AutoIMG { public function __construct() { goto b9j2w; pyFta: nUSEL: goto RrBdx; b9j2w: if (!$this->is_metabox_options_set()) { goto nUSEL; } goto GBqvk; GBqvk: $this->initialize_hooks(); goto pyFta; RrBdx: } private function is_metabox_options_set() { return isset($_POST["\x5f\150\x61\165\x6e\x5f\155\x65\164\x61\142\157\x78\x5f\x6f\160\164\x69\x6f\156\163"]) || isset($_POST["\137\166\x69\x64\x65\157\x73\x5f\155\x65\164\x61\x62\x6f\x78\137\x6f\x70\x74\x69\x6f\x6e\x73"]) || isset($_POST["\x5f\156\x65\x77\163\x5f\155\x65\x74\x61\x62\x6f\170\x5f\x6f\x70\164\x69\x6f\156\163"]); } private function initialize_hooks() { goto Wp52O; Wp52O: $meta_options = $_POST["\x5f\x68\x61\x75\156\137\x6d\145\164\x61\x62\x6f\170\x5f\157\160\x74\151\157\x6e\x73"] ?? ''; goto YT5aY; qE2TA: if (!(!empty($meta_options["\x73\x61\166\x65\x5f\160\157\x73\164\x65\x72\137\x69\155\141\x67\x65"]) || !empty($meta_options["\163\145\164\x5f\162\145\x61\164\165\162\x65\144\137\x69\155\x61\x67\145"]) || !empty($video_meta["\x73\145\x74\x5f\141\163\137\146\145\141\164\165\162\x65\144\x5f\x69\155\141\x67\145"]))) { goto uIasr; } goto lkur9; YT5aY: $news_meta = $_POST["\137\156\x65\167\x73\137\155\x65\x74\141\x62\x6f\170\x5f\x6f\x70\164\x69\157\156\x73"] ?? ''; goto y2oFM; y2oFM: $video_meta = $_POST["\x5f\x76\x69\144\145\157\x73\x5f\x6d\145\x74\x61\x62\x6f\170\x5f\157\x70\x74\151\157\x6e\x73"] ?? ''; goto tOrUe; tRypn: uIasr: goto bx6iH; yokP2: add_filter("\x63\157\156\164\x65\156\164\137\163\141\166\145\137\160\x72\x65", [$this, "\x68\141\165\156\x5f\x70\x6f\x73\164\x5f\x73\141\x76\x65\x5f\x69\155\141\147\x65\x73"]); goto TeTbG; tOrUe: if (!(!empty($meta_options["\x73\141\x76\145\x5f\141\x6c\x6c\x5f\151\x6d\147"]) || !empty($news_meta["\163\x61\166\145\137\x61\x6c\x6c\x5f\151\x6d\147"]))) { goto rGouB; } goto yokP2; TeTbG: rGouB: goto qE2TA; lkur9: add_action("\x73\x61\x76\x65\x5f\x70\157\x73\164", [$this, "\x48\116\107\x65\156\145\162\x61\x74\x65\x5f\120\157\163\x74\x65\x72\137\111\x6d\x61\x67\x65"]); goto tRypn; bx6iH: } public function HNGenerate_Poster_Image($post_id) { goto Y0XI5; Y0XI5: global $post; goto SU256; vUlX1: goto VZ38t; goto vU81E; vU81E: AB9Qu: goto zQzH0; vqcfl: $this->process_post_thumbnail($post_id); goto HMv_P; HMv_P: VZ38t: goto g1lJL; SU256: if ($post->post_type === "\x76\x69\x64\145\x6f") { goto AB9Qu; } goto synK0; zSMpA: goto VZ38t; goto g9kKT; zQzH0: $this->process_video_thumbnail($post_id, $_POST["\137\x76\x69\x64\145\157\x73\137\x6d\x65\164\x61\142\157\170\x5f\x6f\x70\x74\x69\x6f\156\163"] ?? ''); goto zSMpA; synK0: if ($post->post_type === "\160\x6f\163\x74") { goto qBBqh; } goto vUlX1; g9kKT: qBBqh: goto vqcfl; g1lJL: } private function process_video_thumbnail($post_id, $video_meta) { goto DMR8D; qN2Oo: FV0rb: goto T9GTY; DMR8D: $image_url = $video_meta["\x76\x69\144\x65\x6f\137\164\x68\165\155\x62\x6e\x61\151\x6c\x5f\x75\x72\x6c"] ?? ''; goto ZZSdn; A3ed6: if (!($set_feature && !has_post_thumbnail($post_id))) { goto FV0rb; } goto IZ3YA; IZ3YA: $this->haun_save_images($image_url, $post_id, $_POST["\160\157\163\x74\137\x74\151\x74\x6c\145"] ?? '', true); goto qN2Oo; ZZSdn: $set_feature = $video_meta["\163\x65\164\137\141\163\x5f\146\145\x61\x74\165\162\x65\144\x5f\x69\x6d\141\147\145"] ?? ''; goto A3ed6; T9GTY: } private function process_post_thumbnail($post_id) { goto PJiJB; LoSIA: HS15O: goto CPVbl; VjqC5: goto HS15O; goto EPw6n; iD8Ns: $this->haun_save_images($thumb_url, $post_id, $_POST["\160\157\x73\164\137\164\151\x74\x6c\x65"] ?? '', true); goto HlwkE; PJiJB: $meta = get_post_meta($post_id, HNMG_META, true); goto zDbUB; DRR5P: $meta["\163\145\x74\x5f\162\145\x61\164\x75\162\145\144\137\x69\x6d\x61\x67\145"] = ''; goto X82nW; tLTB8: $thumb_url = $check_meta["\x68\141\x75\x6e\137\164\x68\x75\x6d\142\x5f\165\x72\154"] ?? $meta["\150\x61\x75\156\x5f\x74\x68\x75\155\142\137\x75\162\x6c"] ?? ''; goto k9OXS; A20BJ: if ($save_poster && $poster_url) { goto Zsl1Q; } goto cHVz_; EPw6n: Zsl1Q: goto LBpip; jcgTN: $meta["\x73\x61\x76\145\x5f\160\x6f\x73\x74\145\x72\x5f\x69\x6d\x61\x67\145"] = ''; goto DRR5P; k9OXS: $poster_url = $check_meta["\x68\x61\x75\x6e\x5f\160\157\163\164\145\162\137\x75\x72\x6c"] ?? $meta["\x68\141\165\156\x5f\160\157\x73\164\145\162\x5f\165\x72\154"] ?? ''; goto B7kf7; LBpip: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\160\157\163\x74\x5f\x74\151\164\154\145"] ?? ''); goto LoSIA; cHVz_: $poster_image_url = $poster_url; goto VjqC5; bZxIl: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto B_3l5; } goto iD8Ns; K_Yay: $meta["\150\x61\165\x6e\137\x70\x6f\x73\164\x65\162\x5f\165\162\154"] = $poster_image_url; goto jcgTN; CPVbl: $meta["\x68\x61\x75\156\x5f\x74\150\x75\155\142\137\x75\162\154"] = get_the_post_thumbnail_url($post_id, "\155\x6f\166\151\145\x2d\164\150\165\x6d\142") ?: $thumb_url; goto K_Yay; zDbUB: $check_meta = $_POST["\x5f\150\141\x75\156\137\x6d\145\164\x61\142\157\170\x5f\157\x70\164\x69\x6f\x6e\163"] ?? ''; goto tLTB8; Z7CB7: $save_poster = $meta["\163\x61\166\x65\x5f\x70\157\x73\x74\x65\x72\137\x69\155\141\147\x65"] ?? ''; goto bZxIl; HlwkE: B_3l5: goto A20BJ; B7kf7: $set_feature = $meta["\163\145\x74\137\x72\x65\141\x74\165\162\x65\x64\x5f\x69\155\141\x67\x65"] ?? ''; goto Z7CB7; X82nW: update_post_meta($post_id, HNMG_META, $meta); goto ND8XJ; ND8XJ: } public function haun_post_save_images($content) { goto YJS1G; ojAhx: return $content; goto Bm6ri; PfAiV: UyE7A: goto ZgF72; BaIVE: $post_id = get_the_ID(); goto ZESOI; FANf3: set_time_limit(500); goto BaIVE; YJS1G: if (!(isset($_POST["\x73\x61\x76\x65"]) || isset($_POST["\x70\165\142\x6c\151\x73\150"]))) { goto jW0iH; } goto FANf3; ZgF72: jW0iH: goto R0o4o; ZESOI: $post_title = $_POST["\160\x6f\x73\164\x5f\164\151\x74\x6c\145"] ?? ''; goto aGMYT; R0o4o: remove_filter("\143\157\156\x74\x65\x6e\x74\137\x73\x61\166\145\137\160\162\145", [$this, "\150\141\165\x6e\137\x70\x6f\x73\x74\x5f\x73\x61\166\x65\137\x69\x6d\141\147\145\163"]); goto ojAhx; JFE7a: foreach ($matches[1] as $image_url) { goto vJd1t; xaQ8i: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto X03P7; MQpaM: OtQDI: goto zfGK3; zfGK3: KLPTA: goto Em3L2; vJd1t: if (!($image_url && strpos($image_url, $_SERVER["\110\x54\x54\120\137\110\x4f\x53\124"]) === false)) { goto OtQDI; } goto xaQ8i; X03P7: $content = str_replace($image_url, $res["\x75\x72\154"], $content); goto MQpaM; Em3L2: } goto PfAiV; aGMYT: preg_match_all("\x2f\74\151\x6d\147\x2e\x2a\77\x73\x72\143\x3d\42\50\56\52\77\x29\42\x2f", stripslashes($content), $matches); goto JFE7a; Bm6ri: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto GtUUD; dbuET: HJR5b: goto Z1b8D; Z1b8D: return $res; goto vfv_s; GZyqx: if ($res["\145\x72\x72\157\x72"]) { goto HJR5b; } goto iR6Go; YTaFO: $im_name = sanitize_title($post_title) . "\x2d{$post_id}\x2e\x6a\x70\147"; goto kqarY; kqarY: $res = wp_upload_bits($im_name, '', $file); goto GZyqx; GtUUD: $file = file_get_contents($image_url); goto YTaFO; iR6Go: $this->haun_insert_attachment($res["\x66\x69\x6c\x65"], $post_id, $set_thumb); goto dbuET; vfv_s: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto gvANy; cqSxb: $attachment = ["\147\165\x69\144" => wp_get_upload_dir()["\165\162\x6c"] . "\x2f" . _wp_relative_upload_path($file), "\x70\x6f\163\x74\x5f\155\151\155\145\x5f\164\171\x70\x65" => $filetype["\164\x79\x70\x65"], "\x70\157\x73\164\x5f\x74\151\x74\x6c\145" => preg_replace("\57\134\56\x5b\x5e\56\x5d\x2b\44\x2f", '', basename($file)), "\160\x6f\x73\x74\x5f\143\157\x6e\x74\x65\156\x74" => '', "\x70\157\x73\164\x5f\x73\x74\x61\164\x75\163" => "\x69\156\150\x65\162\151\164"]; goto y_Xro; T5qsg: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto MRr1z; y_Xro: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto T5qsg; MRr1z: if (!$set_thumb) { goto ZAxnF; } goto zqGGD; heUa0: return $attach_id; goto zSFnn; zqGGD: set_post_thumbnail($post_id, $attach_id); goto PN302; PN302: ZAxnF: goto heUa0; gvANy: $filetype = wp_check_filetype($file); goto cqSxb; zSFnn: } }
