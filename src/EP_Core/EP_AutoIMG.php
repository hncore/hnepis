<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_AutoIMG { public function __construct() { goto lsOdo; lD6NH: $this->initialize_hooks(); goto SCqmw; lsOdo: if (!$this->is_metabox_options_set()) { goto EueqR; } goto lD6NH; SCqmw: EueqR: goto RCHsf; RCHsf: } private function is_metabox_options_set() { return isset($_POST["\x5f\x68\141\x75\x6e\137\155\x65\164\x61\142\157\170\x5f\x6f\160\x74\x69\157\156\163"]) || isset($_POST["\137\x76\151\x64\x65\x6f\x73\137\155\x65\x74\141\142\157\x78\x5f\157\x70\164\151\x6f\x6e\163"]) || isset($_POST["\137\x6e\145\x77\163\137\155\x65\164\x61\142\157\x78\137\157\160\x74\x69\157\156\163"]); } private function initialize_hooks() { goto FpH9h; TdtrG: if (!(!empty($meta_options["\163\141\166\x65\137\x61\x6c\x6c\x5f\x69\x6d\x67"]) || !empty($news_meta["\x73\141\x76\145\x5f\x61\x6c\154\137\151\155\x67"]))) { goto mB3Tp; } goto dX17A; zs5qo: mB3Tp: goto USe5x; HnS1p: CH10p: goto dbiwz; GLHOZ: add_action("\163\x61\166\x65\137\160\x6f\x73\x74", [$this, "\x48\116\107\145\156\145\x72\x61\164\x65\x5f\120\157\x73\164\x65\x72\137\111\x6d\x61\147\x65"]); goto HnS1p; dX17A: add_filter("\x63\157\x6e\164\x65\156\164\137\163\x61\x76\x65\x5f\160\162\145", [$this, "\150\x61\165\x6e\137\x70\157\163\x74\137\x73\x61\166\x65\x5f\151\155\x61\x67\145\x73"]); goto zs5qo; FpH9h: $meta_options = $_POST["\x5f\150\x61\165\x6e\137\155\145\x74\x61\142\157\x78\x5f\x6f\x70\x74\151\x6f\156\x73"] ?? ''; goto tms0O; tms0O: $news_meta = $_POST["\x5f\156\x65\x77\163\x5f\155\145\164\141\x62\157\170\x5f\x6f\x70\x74\x69\x6f\156\163"] ?? ''; goto YhLJa; USe5x: if (!(!empty($meta_options["\163\141\x76\x65\137\160\157\x73\164\145\x72\137\151\x6d\141\147\145"]) || !empty($meta_options["\x73\145\164\137\x72\145\141\x74\x75\x72\x65\x64\137\151\155\x61\x67\x65"]) || !empty($video_meta["\163\145\x74\x5f\x61\163\x5f\146\x65\141\164\x75\x72\145\x64\x5f\151\x6d\141\147\x65"]))) { goto CH10p; } goto GLHOZ; YhLJa: $video_meta = $_POST["\137\166\x69\x64\145\x6f\x73\x5f\155\x65\164\x61\x62\x6f\x78\x5f\157\160\164\151\157\156\x73"] ?? ''; goto TdtrG; dbiwz: } public function HNGenerate_Poster_Image($post_id) { goto CBw1O; e8zBw: prO65: goto jckFv; ACdhF: if ($post->post_type === "\x76\151\144\x65\x6f") { goto ijxcU; } goto VADEJ; CBw1O: global $post; goto ACdhF; iJKK0: goto prO65; goto jIDEN; jIDEN: q86XG: goto gO4JZ; jmval: goto prO65; goto RZcUt; gO4JZ: $this->process_post_thumbnail($post_id); goto e8zBw; VADEJ: if ($post->post_type === "\x70\157\x73\164") { goto q86XG; } goto jmval; RZcUt: ijxcU: goto jnwCm; jnwCm: $this->process_video_thumbnail($post_id, $_POST["\137\166\x69\x64\145\x6f\163\x5f\x6d\x65\164\141\142\157\x78\137\157\x70\164\151\157\156\x73"] ?? ''); goto iJKK0; jckFv: } private function process_video_thumbnail($post_id, $video_meta) { goto uSZOW; ccxgP: if (!($set_feature && !has_post_thumbnail($post_id))) { goto YMPno; } goto LwkCp; RifNy: YMPno: goto LGWUa; uSZOW: $image_url = $video_meta["\x76\x69\x64\145\x6f\137\164\x68\165\x6d\x62\156\x61\x69\x6c\137\165\x72\x6c"] ?? ''; goto f1gWN; f1gWN: $set_feature = $video_meta["\163\x65\x74\x5f\141\x73\x5f\146\145\141\164\x75\162\145\144\137\151\x6d\x61\147\x65"] ?? ''; goto ccxgP; LwkCp: $this->haun_save_images($image_url, $post_id, $_POST["\160\157\x73\164\x5f\164\x69\x74\x6c\x65"] ?? '', true); goto RifNy; LGWUa: } private function process_post_thumbnail($post_id) { goto E9jJv; RPhXp: $this->haun_save_images($thumb_url, $post_id, $_POST["\x70\157\163\x74\137\164\x69\164\x6c\x65"] ?? '', true); goto xPAGt; k0RQO: $meta["\x68\141\x75\156\x5f\164\150\165\x6d\x62\137\x75\x72\154"] = get_the_post_thumbnail_url($post_id, "\x6d\x6f\x76\x69\145\x2d\164\150\x75\x6d\142") ?: $thumb_url; goto bpRZ4; y1WZ2: if ($save_poster && $poster_url) { goto mb6Fs; } goto NPbqz; YK5uw: $meta["\x73\x65\164\137\162\x65\x61\164\165\x72\145\x64\x5f\x69\x6d\141\x67\x65"] = ''; goto Hbryf; bpRZ4: $meta["\x68\x61\165\x6e\x5f\x70\x6f\x73\x74\x65\162\137\165\x72\x6c"] = $poster_image_url; goto udYNm; GuAAh: $poster_url = $check_meta["\x68\x61\165\156\x5f\160\x6f\163\x74\x65\162\137\165\x72\x6c"] ?? $meta["\x68\x61\x75\156\x5f\x70\x6f\x73\x74\x65\x72\x5f\165\162\x6c"] ?? ''; goto DoKfY; udYNm: $meta["\163\x61\166\145\137\x70\157\x73\x74\145\x72\x5f\151\x6d\x61\147\x65"] = ''; goto YK5uw; VYcXj: $thumb_url = $check_meta["\x68\x61\x75\x6e\x5f\164\150\x75\155\x62\137\x75\162\154"] ?? $meta["\x68\x61\x75\156\137\164\x68\165\x6d\x62\x5f\165\162\154"] ?? ''; goto GuAAh; UCBzH: $check_meta = $_POST["\x5f\x68\141\x75\156\137\155\x65\164\x61\x62\157\170\137\x6f\x70\164\151\157\x6e\x73"] ?? ''; goto VYcXj; wM7Ex: mb6Fs: goto zWmye; E9jJv: $meta = get_post_meta($post_id, HNMG_META, true); goto UCBzH; LquGN: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto NC2CC; } goto RPhXp; BtXE_: R9ett: goto k0RQO; WbEHD: goto R9ett; goto wM7Ex; NPbqz: $poster_image_url = $poster_url; goto WbEHD; DXRyJ: $save_poster = $meta["\x73\x61\x76\x65\x5f\160\157\x73\x74\x65\162\x5f\x69\155\x61\147\x65"] ?? ''; goto LquGN; Hbryf: update_post_meta($post_id, HNMG_META, $meta); goto uHYMH; xPAGt: NC2CC: goto y1WZ2; DoKfY: $set_feature = $meta["\x73\145\x74\137\x72\x65\x61\x74\x75\162\145\x64\137\x69\x6d\x61\x67\x65"] ?? ''; goto DXRyJ; zWmye: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\x70\157\163\164\137\164\151\x74\x6c\x65"] ?? ''); goto BtXE_; uHYMH: } public function haun_post_save_images($content) { goto NA7_K; NNhJ7: $post_title = $_POST["\x70\157\163\164\x5f\164\x69\164\x6c\145"] ?? ''; goto w9ASw; ek3fn: zlemT: goto MjONg; vfXay: m1_pw: goto ek3fn; rE03z: foreach ($matches[1] as $image_url) { goto WfoIg; hdinG: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto DfMnI; WfoIg: if (!($image_url && strpos($image_url, $_SERVER["\110\x54\x54\x50\x5f\110\117\x53\x54"]) === false)) { goto nexKE; } goto hdinG; OGkKW: nexKE: goto xD_1X; xD_1X: AWWwI: goto DQaQs; DfMnI: $content = str_replace($image_url, $res["\x75\x72\154"], $content); goto OGkKW; DQaQs: } goto vfXay; MjONg: remove_filter("\143\x6f\156\164\x65\156\164\137\163\141\166\x65\x5f\x70\x72\x65", [$this, "\x68\x61\x75\156\x5f\x70\157\163\164\x5f\163\x61\x76\x65\x5f\x69\155\x61\x67\x65\163"]); goto tD6R1; NA7_K: if (!(isset($_POST["\163\x61\x76\x65"]) || isset($_POST["\160\165\x62\x6c\151\x73\x68"]))) { goto zlemT; } goto ybvfi; tD6R1: return $content; goto KB9F8; mOOya: $post_id = get_the_ID(); goto NNhJ7; w9ASw: preg_match_all("\x2f\x3c\x69\x6d\147\x2e\x2a\77\163\162\x63\75\x22\x28\x2e\x2a\77\51\x22\57", stripslashes($content), $matches); goto rE03z; ybvfi: set_time_limit(500); goto mOOya; KB9F8: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto gcMRb; YVJCY: $im_name = sanitize_title($post_title) . "\x2d{$post_id}\x2e\152\160\147"; goto eNV0s; gcMRb: $file = file_get_contents($image_url); goto YVJCY; AqQpc: $this->haun_insert_attachment($res["\x66\151\154\145"], $post_id, $set_thumb); goto XtBid; keBGs: return $res; goto x8E6y; XtBid: J65Jl: goto keBGs; eNV0s: $res = wp_upload_bits($im_name, '', $file); goto yiaL1; yiaL1: if ($res["\x65\x72\162\x6f\162"]) { goto J65Jl; } goto AqQpc; x8E6y: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto CvuD1; bnOQS: return $attach_id; goto oU2tQ; TE0A3: $attachment = ["\x67\x75\x69\x64" => wp_get_upload_dir()["\x75\x72\154"] . "\x2f" . _wp_relative_upload_path($file), "\160\x6f\x73\x74\x5f\155\151\155\x65\x5f\x74\171\x70\145" => $filetype["\x74\x79\x70\x65"], "\160\x6f\x73\x74\x5f\x74\151\x74\x6c\x65" => preg_replace("\57\x5c\56\x5b\x5e\56\x5d\53\x24\57", '', basename($file)), "\x70\157\x73\164\x5f\143\157\156\x74\145\x6e\164" => '', "\x70\x6f\163\x74\137\163\x74\x61\x74\165\163" => "\x69\156\150\x65\x72\x69\x74"]; goto vs2Y2; CvuD1: $filetype = wp_check_filetype($file); goto TE0A3; u3VSw: set_post_thumbnail($post_id, $attach_id); goto oA_lF; wA81j: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto qhxyC; qhxyC: if (!$set_thumb) { goto fsmw_; } goto u3VSw; oA_lF: fsmw_: goto bnOQS; vs2Y2: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto wA81j; oU2tQ: } }
