<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_AutoIMG { public function __construct() { goto biEVm; biEVm: if (!$this->is_metabox_options_set()) { goto iCOJZ; } goto PD0uI; PD0uI: $this->initialize_hooks(); goto Mr2S7; Mr2S7: iCOJZ: goto Kn0kF; Kn0kF: } private function is_metabox_options_set() { return isset($_POST["\x5f\150\x61\x75\x6e\155\x65\164\141\142\157\170"]) || isset($_POST["\x5f\166\x69\144\x65\x6f\x73\137\x6d\x65\164\141\142\x6f\170\137\157\x70\x74\x69\x6f\156\163"]) || isset($_POST["\x5f\x6e\145\167\x73\137\155\x65\164\x61\x62\157\x78\x5f\x6f\x70\x74\x69\157\156\163"]); } private function initialize_hooks() { goto aGcHo; xj4c6: add_filter("\x63\x6f\156\164\145\x6e\164\x5f\163\141\x76\x65\137\160\162\145", [$this, "\x68\x61\x75\156\137\x70\x6f\x73\164\137\163\x61\x76\145\137\151\155\x61\147\145\163"]); goto cd5xT; rSJ0E: add_action("\x73\141\166\145\x5f\x70\157\x73\x74", [$this, "\110\116\x47\x65\156\145\162\x61\164\145\x5f\120\157\x73\x74\145\x72\x5f\111\155\141\x67\x65"]); goto JNlVa; JNlVa: yjcWI: goto RFS_w; bem2N: if (!(!empty($meta_options["\163\141\166\145\x5f\160\x6f\x73\164\145\x72\137\151\x6d\x61\147\145"]) || !empty($meta_options["\163\145\x74\137\162\145\141\164\x75\x72\x65\144\137\151\155\141\147\x65"]) || !empty($video_meta["\x73\x65\x74\137\141\x73\137\146\x65\x61\164\x75\162\145\144\x5f\151\x6d\x61\147\x65"]))) { goto yjcWI; } goto rSJ0E; aGcHo: $meta_options = $_POST["\x5f\x68\141\165\x6e\155\145\x74\x61\142\x6f\170"] ?? ''; goto kVbx6; cd5xT: vMzeo: goto bem2N; Vqg28: $video_meta = $_POST["\137\x76\x69\144\145\x6f\163\x5f\x6d\145\164\x61\x62\x6f\x78\137\157\x70\x74\151\x6f\156\163"] ?? ''; goto bGi5j; kVbx6: $news_meta = $_POST["\x5f\156\145\x77\163\x5f\x6d\x65\164\141\x62\157\170\x5f\x6f\160\164\x69\157\156\x73"] ?? ''; goto Vqg28; bGi5j: if (!(!empty($meta_options["\163\x61\x76\x65\137\141\154\x6c\x5f\x69\155\147"]) || !empty($news_meta["\x73\x61\166\x65\x5f\141\x6c\x6c\137\x69\x6d\147"]))) { goto vMzeo; } goto xj4c6; RFS_w: } public function HNGenerate_Poster_Image($post_id) { goto K6Spa; K6Spa: global $post; goto Vb_ZA; bGhfC: if ($post->post_type === "\x70\x6f\163\164") { goto I6eDx; } goto Rr1On; ieq3m: vXpqs: goto UAQ1U; JaGDM: $this->process_video_thumbnail($post_id, $_POST["\x5f\166\x69\144\145\157\163\x5f\x6d\145\x74\141\x62\157\x78\x5f\x6f\x70\164\151\157\156\163"] ?? ''); goto prL1L; oN3oZ: $this->process_post_thumbnail($post_id); goto ieq3m; bbfEC: I6eDx: goto oN3oZ; Rr1On: goto vXpqs; goto ZCHLK; prL1L: goto vXpqs; goto bbfEC; ZCHLK: Rh6AX: goto JaGDM; Vb_ZA: if ($post->post_type === "\166\x69\x64\145\157") { goto Rh6AX; } goto bGhfC; UAQ1U: } private function process_video_thumbnail($post_id, $video_meta) { goto gHCCc; QhKJb: c7K77: goto RKCnH; X_tKZ: if (!($set_feature && !has_post_thumbnail($post_id))) { goto c7K77; } goto cYuMu; fDvm6: $set_feature = $video_meta["\163\145\x74\x5f\x61\x73\137\x66\145\141\x74\x75\162\145\x64\137\151\155\141\x67\x65"] ?? ''; goto X_tKZ; gHCCc: $image_url = $video_meta["\166\151\x64\x65\x6f\137\x74\x68\165\155\142\156\x61\x69\x6c\x5f\x75\x72\154"] ?? ''; goto fDvm6; cYuMu: $this->haun_save_images($image_url, $post_id, $_POST["\x70\x6f\163\x74\x5f\x74\151\164\x6c\x65"] ?? '', true); goto QhKJb; RKCnH: } private function process_post_thumbnail($post_id) { goto jRcRo; SxTDR: $meta["\x68\x61\x75\156\137\164\150\x75\155\x62\137\165\x72\x6c"] = get_the_post_thumbnail_url($post_id, "\155\x6f\166\151\x65\55\x74\x68\x75\155\x62") ?: $thumb_url; goto xN1lO; fNeJA: if ($save_poster && $poster_url) { goto dQVlO; } goto lFXqm; xhQk4: $this->haun_save_images($thumb_url, $post_id, $_POST["\x70\x6f\x73\x74\137\164\x69\164\154\x65"] ?? '', true); goto OA8D7; zNss4: dQVlO: goto S7I4h; OA8D7: leBya: goto fNeJA; oT7KQ: $save_poster = $meta["\163\141\x76\x65\x5f\x70\x6f\163\x74\145\x72\x5f\151\x6d\x61\x67\x65"] ?? ''; goto vgB3J; UHGsa: $set_feature = $meta["\163\145\164\x5f\162\145\x61\x74\165\162\x65\144\137\x69\155\x61\147\145"] ?? ''; goto oT7KQ; Y_X6T: $meta["\163\x61\x76\145\x5f\160\x6f\x73\x74\x65\162\x5f\151\x6d\141\x67\145"] = ''; goto MUk6a; MUk6a: $meta["\x73\145\164\x5f\x72\145\141\164\165\x72\x65\x64\137\x69\155\x61\147\x65"] = ''; goto kGMW4; Pua0K: goto WsP7j; goto zNss4; jRcRo: $meta = get_haunmovies($post_id, HNMG_META, true); goto Sw178; vgB3J: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto leBya; } goto xhQk4; kNNHl: $thumb_url = $check_meta["\150\141\x75\156\x5f\x74\x68\165\155\142\x5f\x75\162\154"] ?? $meta["\150\x61\165\156\x5f\164\150\165\x6d\142\137\165\x72\x6c"] ?? ''; goto TRTVz; TRTVz: $poster_url = $check_meta["\x68\x61\165\156\x5f\x70\157\163\x74\145\x72\x5f\x75\162\x6c"] ?? $meta["\150\x61\165\156\137\x70\x6f\x73\x74\x65\x72\x5f\165\x72\x6c"] ?? ''; goto UHGsa; xN1lO: $meta["\150\141\x75\x6e\x5f\160\157\163\164\x65\x72\137\x75\162\154"] = $poster_image_url; goto Y_X6T; S7I4h: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\160\157\x73\x74\x5f\x74\x69\164\x6c\145"] ?? ''); goto lSiQ2; lSiQ2: WsP7j: goto SxTDR; Sw178: $check_meta = $_POST["\137\150\x61\165\156\x6d\x65\x74\x61\142\157\170"] ?? ''; goto kNNHl; kGMW4: update_haunmovies($post_id, HNMG_META, $meta); goto LVj3B; lFXqm: $poster_image_url = $poster_url; goto Pua0K; LVj3B: } public function haun_post_save_images($content) { goto WqFpk; eOzZJ: preg_match_all("\x2f\74\x69\155\147\56\x2a\77\163\162\143\75\x22\x28\x2e\x2a\77\x29\42\x2f", stripslashes($content), $matches); goto HxV0V; HxV0V: foreach ($matches[1] as $image_url) { goto GR1Ax; EQQJI: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto ZBsqM; tfd3H: vVroM: goto P57gS; GR1Ax: if (!($image_url && strpos($image_url, $_SERVER["\x48\124\124\120\x5f\110\117\123\124"]) === false)) { goto ULzej; } goto EQQJI; ZBsqM: $content = str_replace($image_url, $res["\x75\162\x6c"], $content); goto wp8rQ; wp8rQ: ULzej: goto tfd3H; P57gS: } goto RcaJ9; te9RN: gMxUt: goto aRvZk; RcaJ9: T0BA4: goto te9RN; cc63x: $post_title = $_POST["\160\157\163\164\137\164\151\164\x6c\x65"] ?? ''; goto eOzZJ; WqFpk: if (!(isset($_POST["\163\141\x76\145"]) || isset($_POST["\160\x75\x62\x6c\151\163\x68"]))) { goto gMxUt; } goto UM095; UM095: set_time_limit(500); goto gI8Vz; gI8Vz: $post_id = get_the_ID(); goto cc63x; aRvZk: remove_filter("\x63\157\156\x74\x65\x6e\x74\137\x73\x61\x76\x65\x5f\x70\x72\x65", [$this, "\150\x61\x75\156\137\160\157\x73\164\x5f\163\x61\166\x65\137\x69\x6d\141\x67\x65\163"]); goto fXmvq; fXmvq: return $content; goto gW0FX; gW0FX: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto pGv01; pGv01: $file = file_get_contents($image_url); goto t6H_Z; Yt8h_: Iz3Wj: goto fBrZH; gw2Vd: $res = wp_upload_bits($im_name, '', $file); goto H4O36; ZmyCb: $this->haun_insert_attachment($res["\146\151\154\145"], $post_id, $set_thumb); goto Yt8h_; H4O36: if ($res["\145\x72\162\x6f\162"]) { goto Iz3Wj; } goto ZmyCb; fBrZH: return $res; goto r_P7h; t6H_Z: $im_name = sanitize_title($post_title) . "\x2d{$post_id}\x2e\152\160\147"; goto gw2Vd; r_P7h: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto Lul8y; GzOhg: set_post_thumbnail($post_id, $attach_id); goto M9NcO; Lul8y: $filetype = wp_check_filetype($file); goto UYROu; UYROu: $attachment = ["\147\x75\151\x64" => wp_get_upload_dir()["\165\x72\x6c"] . "\57" . _wp_relative_upload_path($file), "\x70\157\163\x74\137\x6d\x69\155\x65\x5f\164\x79\x70\x65" => $filetype["\x74\171\160\x65"], "\x70\157\x73\x74\137\x74\x69\x74\154\145" => preg_replace("\x2f\134\56\x5b\136\56\135\x2b\x24\57", '', basename($file)), "\160\x6f\163\164\x5f\x63\x6f\156\x74\145\x6e\x74" => '', "\x70\157\x73\x74\137\x73\164\x61\164\x75\x73" => "\151\156\x68\x65\x72\x69\x74"]; goto ax7tu; osI9Q: if (!$set_thumb) { goto IqWzn; } goto GzOhg; ax7tu: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto YaoKC; M9NcO: IqWzn: goto q25rw; q25rw: return $attach_id; goto l5Pt3; YaoKC: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto osI9Q; l5Pt3: } }
