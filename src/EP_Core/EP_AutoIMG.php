<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_AutoIMG { public function __construct() { goto tzVgn; BuRs_: aisoY: goto o2r0T; tzVgn: if (!$this->is_metabox_options_set()) { goto aisoY; } goto LG_uX; LG_uX: $this->initialize_hooks(); goto BuRs_; o2r0T: } private function is_metabox_options_set() { return isset($_POST["\137\x68\x61\x75\x6e\x5f\155\x65\x74\x61\142\157\x78\x5f\x6f\160\x74\x69\157\x6e\163"]) || isset($_POST["\x5f\x76\x69\144\145\157\x73\137\x6d\145\x74\x61\142\x6f\170\137\157\x70\164\x69\x6f\156\163"]) || isset($_POST["\137\x6e\145\x77\163\137\x6d\145\164\x61\142\157\x78\x5f\157\x70\x74\151\x6f\x6e\x73"]); } private function initialize_hooks() { goto wrFLj; RJiKy: iM0eQ: goto BkmNF; rJNo4: if (!(!empty($meta_options["\163\x61\166\x65\x5f\141\x6c\154\137\151\155\x67"]) || !empty($news_meta["\163\141\x76\x65\x5f\141\x6c\x6c\x5f\151\x6d\x67"]))) { goto iM0eQ; } goto plWF0; RDYaq: $video_meta = $_POST["\x5f\x76\x69\x64\145\x6f\163\137\x6d\145\x74\x61\x62\x6f\170\137\157\160\x74\x69\x6f\156\x73"] ?? ''; goto rJNo4; WT4YP: add_action("\163\141\x76\x65\137\x70\157\163\164", [$this, "\x48\116\x47\145\x6e\x65\162\141\x74\x65\137\120\x6f\x73\x74\x65\x72\137\111\155\141\147\145"]); goto l3gEF; l3gEF: ibb73: goto tB4ue; dNnPT: $news_meta = $_POST["\137\156\x65\167\x73\x5f\155\145\x74\141\142\157\170\137\x6f\160\164\x69\157\156\163"] ?? ''; goto RDYaq; plWF0: add_filter("\143\x6f\x6e\x74\145\x6e\x74\x5f\x73\x61\166\145\137\x70\162\x65", [$this, "\x68\141\165\x6e\x5f\160\x6f\x73\x74\137\163\x61\166\x65\137\x69\155\x61\x67\145\163"]); goto RJiKy; BkmNF: if (!(!empty($meta_options["\x73\141\166\x65\x5f\160\157\x73\164\x65\162\x5f\151\x6d\x61\x67\x65"]) || !empty($meta_options["\x73\145\x74\137\x72\x65\x61\164\165\x72\x65\x64\x5f\151\155\x61\x67\145"]) || !empty($video_meta["\x73\x65\x74\137\141\x73\137\146\x65\141\164\x75\162\145\144\x5f\151\x6d\x61\x67\x65"]))) { goto ibb73; } goto WT4YP; wrFLj: $meta_options = $_POST["\x5f\150\x61\165\156\x5f\x6d\145\164\141\x62\157\x78\x5f\x6f\x70\164\x69\x6f\156\163"] ?? ''; goto dNnPT; tB4ue: } public function HNGenerate_Poster_Image($post_id) { goto iGOU9; lFDdr: goto BTVN9; goto QAjt9; BCPrK: p6mPH: goto rfGny; KsPOO: BTVN9: goto IxLpY; sXPpR: if ($post->post_type === "\160\x6f\x73\164") { goto Taun4; } goto NiFqU; iGOU9: global $post; goto LzcyV; NiFqU: goto BTVN9; goto BCPrK; Y30i6: $this->process_post_thumbnail($post_id); goto KsPOO; QAjt9: Taun4: goto Y30i6; LzcyV: if ($post->post_type === "\166\x69\x64\145\x6f") { goto p6mPH; } goto sXPpR; rfGny: $this->process_video_thumbnail($post_id, $_POST["\137\x76\151\144\145\x6f\163\137\x6d\x65\164\x61\142\x6f\170\x5f\157\x70\x74\x69\157\x6e\163"] ?? ''); goto lFDdr; IxLpY: } private function process_video_thumbnail($post_id, $video_meta) { goto f7mgu; hZIVq: Xmhqw: goto JSghX; f7mgu: $image_url = $video_meta["\x76\151\x64\145\x6f\x5f\x74\x68\x75\155\x62\156\141\151\154\x5f\165\x72\x6c"] ?? ''; goto K77gR; K77gR: $set_feature = $video_meta["\163\x65\x74\137\141\x73\x5f\x66\x65\141\x74\x75\x72\x65\144\x5f\x69\x6d\x61\147\145"] ?? ''; goto b1nYi; b1nYi: if (!($set_feature && !has_post_thumbnail($post_id))) { goto Xmhqw; } goto z9uPO; z9uPO: $this->haun_save_images($image_url, $post_id, $_POST["\x70\x6f\163\x74\x5f\x74\151\x74\154\145"] ?? '', true); goto hZIVq; JSghX: } private function process_post_thumbnail($post_id) { goto bXtj9; In6Wf: update_post_meta($post_id, HNMG_META, $meta); goto ESOFe; H1PH7: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\x70\x6f\163\x74\137\164\x69\164\154\x65"] ?? ''); goto d3i3q; g_ecn: $thumb_url = $check_meta["\x68\x61\165\x6e\x5f\164\x68\x75\155\142\x5f\x75\162\x6c"] ?? $meta["\x68\x61\x75\156\137\164\150\165\155\x62\137\x75\162\x6c"] ?? ''; goto qChfx; X71rT: $poster_image_url = $poster_url; goto b9lVB; qChfx: $poster_url = $check_meta["\150\141\x75\x6e\x5f\x70\157\x73\164\x65\162\137\x75\x72\154"] ?? $meta["\150\x61\x75\x6e\x5f\160\157\163\164\x65\162\x5f\165\x72\154"] ?? ''; goto bC789; kNK9a: $meta["\150\x61\x75\x6e\137\160\x6f\x73\x74\145\162\137\165\162\154"] = $poster_image_url; goto pmeh_; b9lVB: goto oJiUj; goto maX_b; pmeh_: $meta["\x73\141\x76\145\137\160\x6f\x73\164\x65\x72\137\x69\x6d\141\147\145"] = ''; goto svYNe; BuuUs: if ($save_poster && $poster_url) { goto Tl7K1; } goto X71rT; Fskao: aPz89: goto BuuUs; G3tl0: $meta["\x68\141\165\156\137\x74\x68\165\x6d\142\137\165\162\154"] = get_the_post_thumbnail_url($post_id, "\x6d\x6f\x76\x69\x65\55\x74\150\165\155\142") ?: $thumb_url; goto kNK9a; Pz26y: $this->haun_save_images($thumb_url, $post_id, $_POST["\160\x6f\x73\164\137\164\151\x74\x6c\x65"] ?? '', true); goto Fskao; bXtj9: $meta = get_post_meta($post_id, HNMG_META, true); goto psi05; COT3c: $save_poster = $meta["\x73\x61\166\145\137\160\x6f\x73\x74\x65\x72\137\151\155\x61\x67\x65"] ?? ''; goto wU_oM; psi05: $check_meta = $_POST["\x5f\150\141\165\x6e\x5f\x6d\x65\164\141\142\157\x78\137\x6f\x70\x74\151\157\x6e\163"] ?? ''; goto g_ecn; d3i3q: oJiUj: goto G3tl0; wU_oM: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto aPz89; } goto Pz26y; maX_b: Tl7K1: goto H1PH7; svYNe: $meta["\163\x65\164\137\162\x65\141\164\x75\162\145\x64\x5f\151\155\141\147\145"] = ''; goto In6Wf; bC789: $set_feature = $meta["\163\x65\164\x5f\162\145\x61\x74\165\x72\x65\144\x5f\x69\x6d\x61\x67\145"] ?? ''; goto COT3c; ESOFe: } public function haun_post_save_images($content) { goto zrQdG; g1Zs1: xPmeJ: goto zgtyV; Rp2Q2: set_time_limit(500); goto HY086; dPWE2: foreach ($matches[1] as $image_url) { goto Y6kR4; Y6kR4: if (!($image_url && strpos($image_url, $_SERVER["\110\x54\124\x50\x5f\x48\117\x53\124"]) === false)) { goto HBB5o; } goto sR5aI; CcGja: Sx9NV: goto RBohS; fGHK1: $content = str_replace($image_url, $res["\165\162\x6c"], $content); goto rnG6d; rnG6d: HBB5o: goto CcGja; sR5aI: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto fGHK1; RBohS: } goto iJivx; zrQdG: if (!(isset($_POST["\x73\141\166\x65"]) || isset($_POST["\160\165\142\x6c\151\163\150"]))) { goto xPmeJ; } goto Rp2Q2; iJivx: gEfL3: goto g1Zs1; ImQ_y: $post_title = $_POST["\x70\x6f\163\164\x5f\x74\151\164\154\145"] ?? ''; goto SA14j; zgtyV: remove_filter("\143\157\x6e\164\145\156\x74\137\163\x61\166\x65\x5f\160\x72\x65", [$this, "\150\x61\x75\156\x5f\x70\157\163\x74\137\x73\141\x76\145\x5f\x69\155\x61\x67\x65\163"]); goto tv6nw; tv6nw: return $content; goto jnqEb; HY086: $post_id = get_the_ID(); goto ImQ_y; SA14j: preg_match_all("\x2f\x3c\151\x6d\147\56\52\x3f\163\162\143\75\42\x28\56\x2a\77\x29\x22\x2f", stripslashes($content), $matches); goto dPWE2; jnqEb: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto fejFE; UHfEg: return $res; goto p8byk; ED6XY: $res = wp_upload_bits($im_name, '', $file); goto GmrGp; Rl1EB: ttlP2: goto UHfEg; fejFE: $file = file_get_contents($image_url); goto usHKo; usHKo: $im_name = sanitize_title($post_title) . "\55{$post_id}\x2e\x6a\x70\x67"; goto ED6XY; aRLUC: $this->haun_insert_attachment($res["\x66\151\x6c\x65"], $post_id, $set_thumb); goto Rl1EB; GmrGp: if ($res["\x65\x72\162\157\162"]) { goto ttlP2; } goto aRLUC; p8byk: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto ehaV6; lHxq_: set_post_thumbnail($post_id, $attach_id); goto K8MXZ; XeKk2: $attachment = ["\147\165\x69\144" => wp_get_upload_dir()["\165\x72\x6c"] . "\57" . _wp_relative_upload_path($file), "\x70\x6f\163\164\x5f\155\x69\x6d\145\137\x74\x79\x70\x65" => $filetype["\164\171\160\x65"], "\160\157\163\x74\137\x74\151\164\154\x65" => preg_replace("\x2f\134\x2e\133\136\56\x5d\53\x24\57", '', basename($file)), "\x70\x6f\163\164\137\143\157\156\164\145\156\x74" => '', "\160\x6f\x73\x74\x5f\x73\164\141\x74\165\x73" => "\151\156\150\x65\162\x69\x74"]; goto ereUW; z69dY: if (!$set_thumb) { goto V3xJt; } goto lHxq_; kxTSV: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto z69dY; Gb0eG: return $attach_id; goto TPnyU; ehaV6: $filetype = wp_check_filetype($file); goto XeKk2; K8MXZ: V3xJt: goto Gb0eG; ereUW: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto kxTSV; TPnyU: } }
