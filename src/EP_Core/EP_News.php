<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_News { public function __construct() { goto lL0Wv; cLnqU: byRu8: goto Ote5U; lL0Wv: if (!$this->is_metabox_options_set()) { goto byRu8; } goto HSMQ1; HSMQ1: $this->initialize_hooks(); goto cLnqU; Ote5U: } private function is_metabox_options_set() { return isset($_POST["\137\x68\141\165\x6e\137\155\x65\x74\141\142\157\x78\137\x6f\x70\164\151\x6f\156\x73"]) || isset($_POST["\137\166\151\x64\145\157\x73\x5f\x6d\x65\164\x61\142\157\170\137\157\160\164\151\x6f\x6e\x73"]) || isset($_POST["\137\156\145\167\x73\x5f\x6d\x65\164\141\x62\157\x78\x5f\157\160\x74\x69\157\x6e\x73"]); } private function initialize_hooks() { goto rhsGV; uMmyO: $video_meta = $_POST["\x5f\x76\x69\x64\145\x6f\x73\137\155\x65\x74\x61\x62\157\170\137\x6f\160\x74\151\157\156\163"] ?? ''; goto e8hKI; pfdvQ: add_action("\x73\x61\x76\x65\137\x70\x6f\163\164", [$this, "\x48\x4e\x47\145\156\x65\162\141\x74\145\137\120\157\x73\x74\145\162\x5f\x49\x6d\141\147\x65"]); goto pzn65; QQOtt: GlNVr: goto Ts230; rhsGV: $meta_options = $_POST["\x5f\150\141\165\x6e\x5f\x6d\x65\164\x61\x62\157\x78\137\x6f\x70\164\x69\157\x6e\x73"] ?? ''; goto stNK0; pzn65: ACdIo: goto n5fLL; stNK0: $news_meta = $_POST["\x5f\x6e\x65\x77\163\x5f\x6d\145\x74\141\142\157\x78\137\x6f\x70\x74\x69\x6f\x6e\163"] ?? ''; goto uMmyO; e8hKI: if (!(!empty($meta_options["\x73\x61\166\145\137\x61\x6c\154\x5f\151\155\x67"]) || !empty($news_meta["\163\x61\166\145\x5f\141\154\x6c\x5f\151\x6d\x67"]))) { goto GlNVr; } goto BAzsn; BAzsn: add_filter("\143\157\x6e\x74\145\156\164\x5f\163\141\166\x65\x5f\x70\162\145", [$this, "\150\141\165\156\x5f\160\157\x73\x74\x5f\163\141\x76\x65\137\151\x6d\141\147\x65\163"]); goto QQOtt; Ts230: if (!(!empty($meta_options["\163\141\166\x65\137\160\x6f\x73\x74\x65\162\137\151\155\141\147\145"]) || !empty($meta_options["\163\145\164\x5f\162\x65\141\x74\x75\162\x65\144\137\151\x6d\x61\x67\145"]) || !empty($video_meta["\x73\x65\164\x5f\x61\163\137\x66\x65\141\x74\165\x72\x65\144\137\x69\x6d\141\147\x65"]))) { goto ACdIo; } goto pfdvQ; n5fLL: } public function HNGenerate_Poster_Image($post_id) { goto YThPM; IFqfX: $this->process_video_thumbnail($post_id, $_POST["\x5f\166\151\144\x65\x6f\163\137\x6d\x65\164\x61\x62\x6f\170\x5f\x6f\x70\164\151\x6f\x6e\x73"] ?? ''); goto YNOqF; MlHib: EbeR8: goto IFqfX; YThPM: global $post; goto iMcSA; iMcSA: if ($post->post_type === "\x76\151\144\x65\157") { goto EbeR8; } goto qb9rw; wMcvd: lzAJI: goto Ykl7G; OS8X1: goto lzAJI; goto MlHib; qb9rw: if ($post->post_type === "\160\x6f\163\x74") { goto AxWHN; } goto OS8X1; dTEhc: $this->process_post_thumbnail($post_id); goto wMcvd; d72wR: AxWHN: goto dTEhc; YNOqF: goto lzAJI; goto d72wR; Ykl7G: } private function process_video_thumbnail($post_id, $video_meta) { goto LipAR; LipAR: $image_url = $video_meta["\166\151\x64\x65\x6f\137\x74\150\165\155\x62\x6e\141\151\154\137\165\x72\154"] ?? ''; goto l777_; A92gf: if (!($set_feature && !has_post_thumbnail($post_id))) { goto nfHOv; } goto DWG5f; l777_: $set_feature = $video_meta["\x73\145\x74\137\141\163\137\146\x65\x61\x74\x75\x72\x65\x64\x5f\x69\x6d\x61\x67\145"] ?? ''; goto A92gf; DWG5f: $this->haun_save_images($image_url, $post_id, $_POST["\160\157\163\x74\x5f\x74\151\164\154\x65"] ?? '', true); goto TUSf1; TUSf1: nfHOv: goto kr0JE; kr0JE: } private function process_post_thumbnail($post_id) { goto UeEAh; KpvTm: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto bt8Ey; } goto iZ4qi; sdAyx: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\160\157\x73\x74\x5f\x74\x69\164\154\145"] ?? ''); goto LiVkC; AHXiE: update_post_meta($post_id, HNMG_META, $meta); goto bF7Uu; sF9Fa: $poster_url = $check_meta["\x68\x61\x75\156\x5f\160\x6f\163\x74\x65\162\137\x75\x72\x6c"] ?? $meta["\150\x61\165\156\x5f\160\157\x73\x74\145\x72\x5f\165\x72\x6c"] ?? ''; goto HUqOT; LiVkC: LpS2N: goto I19nz; CmN9b: $poster_image_url = $poster_url; goto H1TBi; HUqOT: $set_feature = $meta["\163\x65\x74\x5f\162\x65\141\164\165\162\x65\144\137\x69\x6d\141\147\145"] ?? ''; goto r7AAm; hT3Fl: $meta["\163\145\164\137\162\145\141\x74\x75\x72\x65\144\x5f\151\155\141\x67\145"] = ''; goto AHXiE; g43La: $meta["\x68\x61\x75\156\x5f\160\x6f\163\164\x65\162\137\165\x72\154"] = $poster_image_url; goto Al23U; Al23U: $meta["\163\x61\x76\x65\137\160\157\x73\x74\145\162\137\151\x6d\141\x67\x65"] = ''; goto hT3Fl; iZ4qi: $this->haun_save_images($thumb_url, $post_id, $_POST["\160\x6f\163\x74\137\164\151\x74\x6c\145"] ?? '', true); goto zhaU0; wwoPD: $check_meta = $_POST["\x5f\x68\141\165\156\137\x6d\145\164\141\x62\x6f\170\137\x6f\x70\x74\x69\x6f\x6e\x73"] ?? ''; goto uy5MS; r7AAm: $save_poster = $meta["\163\x61\166\x65\x5f\x70\157\163\x74\x65\x72\137\x69\155\141\147\x65"] ?? ''; goto KpvTm; H1TBi: goto LpS2N; goto Lo8Zn; Lo8Zn: RvNUt: goto sdAyx; UeEAh: $meta = get_post_meta($post_id, HNMG_META, true); goto wwoPD; zhaU0: bt8Ey: goto onn6M; onn6M: if ($save_poster && $poster_url) { goto RvNUt; } goto CmN9b; uy5MS: $thumb_url = $check_meta["\x68\x61\x75\156\137\164\150\x75\155\142\x5f\165\162\154"] ?? $meta["\x68\141\165\156\137\164\150\165\155\x62\137\x75\x72\154"] ?? ''; goto sF9Fa; I19nz: $meta["\x68\x61\x75\156\137\x74\x68\x75\x6d\x62\x5f\x75\x72\x6c"] = get_the_post_thumbnail_url($post_id, "\155\157\x76\x69\x65\55\164\150\x75\x6d\x62") ?: $thumb_url; goto g43La; bF7Uu: } public function haun_post_save_images($content) { goto r2baw; u6Cef: $post_title = $_POST["\160\x6f\163\164\x5f\164\151\x74\x6c\145"] ?? ''; goto WF3Om; WWmA4: return $content; goto Upgar; XKv3P: R4Obj: goto q_J9_; EKEVU: foreach ($matches[1] as $image_url) { goto BfuXm; sxqlx: WArRp: goto frU2u; t1zL1: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto ET8Yl; ET8Yl: $content = str_replace($image_url, $res["\x75\x72\x6c"], $content); goto sxqlx; frU2u: BxZ1_: goto jc9um; BfuXm: if (!($image_url && strpos($image_url, $_SERVER["\x48\124\124\120\137\110\x4f\x53\x54"]) === false)) { goto WArRp; } goto t1zL1; jc9um: } goto XKv3P; q_J9_: n7q69: goto khh5l; XLLdm: set_time_limit(500); goto uKlgY; WF3Om: preg_match_all("\57\74\151\155\147\x2e\x2a\77\163\x72\143\75\x22\x28\56\52\77\x29\42\57", stripslashes($content), $matches); goto EKEVU; uKlgY: $post_id = get_the_ID(); goto u6Cef; r2baw: if (!(isset($_POST["\163\x61\166\145"]) || isset($_POST["\x70\x75\142\154\151\163\150"]))) { goto n7q69; } goto XLLdm; khh5l: remove_filter("\x63\x6f\x6e\x74\145\156\x74\x5f\x73\x61\x76\145\137\160\162\x65", [$this, "\x68\141\165\x6e\137\x70\x6f\163\x74\137\163\x61\x76\x65\137\x69\155\x61\x67\x65\x73"]); goto WWmA4; Upgar: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto HG_3m; FwP4x: return $res; goto zqn0q; HG_3m: $file = file_get_contents($image_url); goto C0i0n; ImsXK: if ($res["\145\x72\162\157\162"]) { goto oorw0; } goto jwHoL; C0i0n: $im_name = sanitize_title($post_title) . "\x2d{$post_id}\56\x6a\160\x67"; goto QxCVl; jwHoL: $this->haun_insert_attachment($res["\x66\151\x6c\x65"], $post_id, $set_thumb); goto njRvy; njRvy: oorw0: goto FwP4x; QxCVl: $res = wp_upload_bits($im_name, '', $file); goto ImsXK; zqn0q: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto YQkR0; jFrKh: wEpJZ: goto wyfwt; xkdWo: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto LdjFr; X4dKj: if (!$set_thumb) { goto wEpJZ; } goto uZJBP; LdjFr: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto X4dKj; YQkR0: $filetype = wp_check_filetype($file); goto UphVU; UphVU: $attachment = ["\x67\165\151\x64" => wp_get_upload_dir()["\x75\x72\x6c"] . "\x2f" . _wp_relative_upload_path($file), "\160\x6f\163\x74\137\155\151\155\145\x5f\x74\171\160\145" => $filetype["\x74\x79\160\x65"], "\x70\157\x73\164\x5f\x74\151\164\154\x65" => preg_replace("\x2f\x5c\56\133\x5e\x2e\135\x2b\x24\57", '', basename($file)), "\160\157\163\x74\137\x63\x6f\x6e\164\145\x6e\x74" => '', "\x70\x6f\163\x74\x5f\x73\x74\x61\164\x75\163" => "\151\156\150\x65\x72\x69\x74"]; goto xkdWo; uZJBP: set_post_thumbnail($post_id, $attach_id); goto jFrKh; wyfwt: return $attach_id; goto caCwZ; caCwZ: } }
