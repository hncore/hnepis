<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_News { public function __construct() { goto q4kbq; q4kbq: if (!$this->is_metabox_options_set()) { goto lGKj8; } goto kOCWU; CcYBd: lGKj8: goto kVZqV; kOCWU: $this->initialize_hooks(); goto CcYBd; kVZqV: } private function is_metabox_options_set() { return isset($_POST["\x5f\x68\x61\x75\156\x5f\x6d\145\164\141\142\x6f\170\x5f\157\160\x74\x69\x6f\156\163"]) || isset($_POST["\137\166\151\x64\145\x6f\x73\137\x6d\145\x74\x61\142\157\170\137\157\x70\x74\151\x6f\x6e\x73"]) || isset($_POST["\137\x6e\145\x77\163\137\x6d\x65\x74\x61\x62\x6f\x78\137\157\x70\164\x69\157\x6e\x73"]); } private function initialize_hooks() { goto fUirs; fUirs: $meta_options = $_POST["\x5f\150\141\165\156\137\155\145\164\141\x62\x6f\x78\137\157\160\x74\x69\157\x6e\163"] ?? ''; goto tE4ua; Tm2Oo: if (!(!empty($meta_options["\163\141\166\145\137\141\x6c\154\x5f\151\155\x67"]) || !empty($news_meta["\x73\141\166\x65\137\x61\154\x6c\137\151\155\147"]))) { goto UUXfp; } goto Asg3f; GTHVU: if (!(!empty($meta_options["\163\x61\166\145\x5f\x70\157\x73\164\x65\x72\x5f\151\155\141\147\145"]) || !empty($meta_options["\x73\145\164\x5f\162\x65\141\164\x75\x72\145\x64\x5f\151\155\141\x67\145"]) || !empty($video_meta["\163\145\x74\137\x61\163\137\x66\145\141\164\165\x72\145\144\x5f\151\x6d\141\x67\x65"]))) { goto dFl36; } goto ogwa2; tE4ua: $news_meta = $_POST["\x5f\x6e\x65\x77\163\x5f\x6d\145\164\x61\x62\x6f\x78\137\x6f\160\x74\151\x6f\156\x73"] ?? ''; goto YDjzl; fWvp0: dFl36: goto sgH2B; ARX1h: UUXfp: goto GTHVU; Asg3f: add_filter("\143\157\156\x74\145\x6e\x74\x5f\x73\141\166\x65\137\160\x72\x65", [$this, "\x68\141\165\x6e\137\160\157\163\x74\x5f\x73\141\166\145\137\x69\155\x61\147\x65\163"]); goto ARX1h; ogwa2: add_action("\163\x61\x76\x65\x5f\160\157\163\164", [$this, "\x48\116\x47\145\x6e\145\162\141\164\145\x5f\120\157\x73\x74\x65\x72\137\111\155\141\147\145"]); goto fWvp0; YDjzl: $video_meta = $_POST["\137\x76\x69\144\145\157\x73\137\x6d\x65\x74\x61\142\x6f\170\137\157\x70\x74\151\x6f\156\x73"] ?? ''; goto Tm2Oo; sgH2B: } public function HNGenerate_Poster_Image($post_id) { goto Ne0OM; LiLyI: if ($post->post_type === "\x76\151\144\145\157") { goto Dc9if; } goto fP5Nl; lkEjb: $this->process_post_thumbnail($post_id); goto LZNVr; Ne0OM: global $post; goto LiLyI; NOYZR: HEofv: goto lkEjb; fP5Nl: if ($post->post_type === "\160\x6f\x73\x74") { goto HEofv; } goto NdzXk; LZNVr: CSxy2: goto p1200; i8Xd1: Dc9if: goto j0IO1; RkTCR: goto CSxy2; goto NOYZR; j0IO1: $this->process_video_thumbnail($post_id, $_POST["\x5f\166\x69\x64\145\x6f\x73\137\x6d\x65\x74\x61\x62\157\x78\137\x6f\x70\x74\x69\x6f\x6e\163"] ?? ''); goto RkTCR; NdzXk: goto CSxy2; goto i8Xd1; p1200: } private function process_video_thumbnail($post_id, $video_meta) { goto vgcTk; JMqbZ: if (!($set_feature && !has_post_thumbnail($post_id))) { goto Bad_x; } goto pY1aq; nW2X3: $set_feature = $video_meta["\x73\x65\164\x5f\x61\163\137\146\x65\x61\x74\165\162\x65\144\x5f\151\x6d\x61\147\x65"] ?? ''; goto JMqbZ; pY1aq: $this->haun_save_images($image_url, $post_id, $_POST["\x70\x6f\163\164\x5f\164\x69\164\154\145"] ?? '', true); goto pRlLE; pRlLE: Bad_x: goto X2vjq; vgcTk: $image_url = $video_meta["\166\x69\x64\145\157\x5f\x74\x68\165\x6d\142\x6e\x61\151\x6c\x5f\x75\x72\154"] ?? ''; goto nW2X3; X2vjq: } private function process_post_thumbnail($post_id) { goto K2giA; auIEA: $poster_image_url = $poster_url; goto K3eu2; BLoYa: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\x70\157\163\x74\x5f\x74\151\164\154\145"] ?? ''); goto spoPB; K3eu2: goto KlfX4; goto wrzd6; KLFWz: $this->haun_save_images($thumb_url, $post_id, $_POST["\160\x6f\x73\x74\x5f\x74\x69\x74\x6c\x65"] ?? '', true); goto zD6mz; WpaE1: $meta["\150\x61\165\156\137\x70\157\163\164\145\162\137\165\x72\x6c"] = $poster_image_url; goto Hq9Do; K2giA: $meta = get_post_meta($post_id, HNMG_META, true); goto YtrHO; USiB1: $poster_url = $check_meta["\150\141\x75\x6e\137\160\x6f\163\x74\x65\x72\137\x75\162\x6c"] ?? $meta["\150\x61\x75\x6e\137\x70\x6f\x73\164\x65\162\137\165\x72\x6c"] ?? ''; goto TEpQO; TEpQO: $set_feature = $meta["\x73\145\164\x5f\x72\x65\141\x74\x75\162\x65\144\137\151\x6d\141\x67\x65"] ?? ''; goto yiy_A; cKMRX: $meta["\x73\x65\164\x5f\x72\145\x61\x74\x75\162\x65\x64\x5f\151\x6d\141\x67\x65"] = ''; goto ePyvE; yiy_A: $save_poster = $meta["\163\141\166\x65\137\x70\157\x73\x74\145\x72\137\151\x6d\141\x67\145"] ?? ''; goto nnJIX; gkkNa: $meta["\x68\141\165\156\x5f\x74\x68\165\155\142\x5f\165\x72\x6c"] = get_the_post_thumbnail_url($post_id, "\155\157\x76\x69\145\x2d\x74\150\x75\x6d\142") ?: $thumb_url; goto WpaE1; M1bUZ: $thumb_url = $check_meta["\x68\141\x75\156\x5f\x74\150\165\x6d\x62\x5f\x75\x72\154"] ?? $meta["\x68\x61\165\156\x5f\164\150\165\155\142\137\165\162\154"] ?? ''; goto USiB1; nnJIX: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto QHv1h; } goto KLFWz; spoPB: KlfX4: goto gkkNa; wrzd6: si2hI: goto BLoYa; Hq9Do: $meta["\x73\x61\166\145\137\x70\157\x73\164\145\x72\137\x69\155\141\x67\x65"] = ''; goto cKMRX; zD6mz: QHv1h: goto letGz; ePyvE: update_post_meta($post_id, HNMG_META, $meta); goto u7gBG; letGz: if ($save_poster && $poster_url) { goto si2hI; } goto auIEA; YtrHO: $check_meta = $_POST["\137\x68\141\x75\x6e\137\x6d\145\164\x61\142\157\x78\x5f\x6f\x70\164\x69\x6f\156\163"] ?? ''; goto M1bUZ; u7gBG: } public function haun_post_save_images($content) { goto h_KNa; h5WNN: foreach ($matches[1] as $image_url) { goto niaL7; niaL7: if (!($image_url && strpos($image_url, $_SERVER["\x48\124\124\x50\137\110\x4f\x53\124"]) === false)) { goto rAP7g; } goto vtuLe; bVdVI: PsWgx: goto CpNxy; vtuLe: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto YDiYw; tIlwi: rAP7g: goto bVdVI; YDiYw: $content = str_replace($image_url, $res["\165\162\x6c"], $content); goto tIlwi; CpNxy: } goto Vx0mh; CfHvD: OtM5A: goto k1pwv; Vx0mh: pb2Jz: goto CfHvD; k1pwv: remove_filter("\143\157\156\x74\x65\x6e\164\137\163\x61\x76\x65\x5f\160\x72\145", [$this, "\150\141\165\156\137\x70\x6f\x73\164\137\163\x61\166\145\x5f\151\x6d\141\147\145\x73"]); goto YTjZg; qdnG8: set_time_limit(500); goto IcBAz; YTjZg: return $content; goto WkJLz; m80qI: preg_match_all("\57\74\x69\155\147\56\52\x3f\163\162\x63\x3d\x22\x28\56\x2a\x3f\51\42\x2f", stripslashes($content), $matches); goto h5WNN; IcBAz: $post_id = get_the_ID(); goto FjV7l; h_KNa: if (!(isset($_POST["\x73\141\x76\145"]) || isset($_POST["\160\x75\142\x6c\x69\163\150"]))) { goto OtM5A; } goto qdnG8; FjV7l: $post_title = $_POST["\160\x6f\x73\164\x5f\x74\x69\x74\154\145"] ?? ''; goto m80qI; WkJLz: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto gl3s5; hS5Q5: $res = wp_upload_bits($im_name, '', $file); goto l_htB; bvdEI: return $res; goto ydTl5; fvy5C: QOXkP: goto bvdEI; gl3s5: $file = file_get_contents($image_url); goto TbWsp; TbWsp: $im_name = sanitize_title($post_title) . "\x2d{$post_id}\x2e\x6a\x70\147"; goto hS5Q5; eucJ9: $this->haun_insert_attachment($res["\146\x69\154\145"], $post_id, $set_thumb); goto fvy5C; l_htB: if ($res["\145\162\x72\x6f\162"]) { goto QOXkP; } goto eucJ9; ydTl5: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto zOyPq; PGhJi: $attachment = ["\x67\165\151\144" => wp_get_upload_dir()["\165\162\x6c"] . "\57" . _wp_relative_upload_path($file), "\x70\157\x73\x74\137\155\x69\x6d\145\x5f\164\171\x70\145" => $filetype["\x74\x79\160\145"], "\x70\157\x73\164\x5f\x74\151\x74\x6c\x65" => preg_replace("\57\134\x2e\133\x5e\56\135\x2b\44\57", '', basename($file)), "\160\x6f\163\x74\x5f\143\x6f\156\x74\145\x6e\x74" => '', "\160\x6f\x73\x74\137\x73\x74\x61\x74\x75\163" => "\151\156\150\145\x72\151\164"]; goto mX0_9; KGWyM: set_post_thumbnail($post_id, $attach_id); goto xNa1q; i_B0I: if (!$set_thumb) { goto R5ynS; } goto KGWyM; DN1Ao: return $attach_id; goto UvyHG; zOyPq: $filetype = wp_check_filetype($file); goto PGhJi; dml2d: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto i_B0I; xNa1q: R5ynS: goto DN1Ao; mX0_9: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto dml2d; UvyHG: } }
