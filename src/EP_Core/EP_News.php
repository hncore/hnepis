<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_News { public function __construct() { goto buBLp; buBLp: if (!$this->is_metabox_options_set()) { goto oHnJZ; } goto cmcLw; ZpP31: oHnJZ: goto SgCQA; cmcLw: $this->initialize_hooks(); goto ZpP31; SgCQA: } private function is_metabox_options_set() { return isset($_POST["\x5f\150\x61\165\x6e\137\155\x65\164\141\142\x6f\x78\x5f\x6f\x70\x74\151\157\x6e\163"]) || isset($_POST["\x5f\166\x69\x64\x65\157\x73\x5f\155\x65\164\141\142\x6f\170\x5f\x6f\x70\x74\151\157\156\163"]) || isset($_POST["\137\156\x65\167\x73\137\x6d\x65\x74\x61\142\157\170\137\x6f\160\x74\x69\x6f\x6e\163"]); } private function initialize_hooks() { goto GZL4d; YJhq2: add_filter("\x63\x6f\x6e\x74\145\156\164\137\x73\x61\166\145\x5f\x70\162\145", [$this, "\x68\141\x75\156\137\x70\157\163\164\x5f\163\x61\x76\145\x5f\151\155\141\x67\145\163"]); goto h1o2q; h1o2q: p_led: goto mgVVU; UB_gI: if (!(!empty($meta_options["\163\141\166\x65\x5f\141\x6c\x6c\x5f\x69\155\x67"]) || !empty($news_meta["\x73\141\x76\145\137\x61\x6c\154\137\151\155\147"]))) { goto p_led; } goto YJhq2; oFKN3: hDcVk: goto bLXdb; nwTRm: add_action("\x73\141\x76\145\x5f\x70\157\163\164", [$this, "\110\116\107\x65\156\x65\x72\x61\164\x65\x5f\x50\157\x73\164\x65\162\137\111\155\x61\147\x65"]); goto oFKN3; NjUrj: $video_meta = $_POST["\137\x76\151\144\145\157\163\137\x6d\145\164\x61\142\x6f\x78\137\157\160\164\x69\157\156\163"] ?? ''; goto UB_gI; GZL4d: $meta_options = $_POST["\137\150\141\165\156\x5f\x6d\x65\164\141\x62\157\170\x5f\x6f\x70\164\x69\x6f\156\163"] ?? ''; goto MdzFj; MdzFj: $news_meta = $_POST["\x5f\156\x65\x77\163\137\x6d\x65\164\x61\x62\157\x78\x5f\x6f\160\x74\151\157\156\163"] ?? ''; goto NjUrj; mgVVU: if (!(!empty($meta_options["\163\x61\166\x65\x5f\x70\x6f\x73\164\145\x72\137\151\155\141\x67\x65"]) || !empty($meta_options["\x73\x65\164\137\162\x65\141\x74\165\x72\145\144\x5f\x69\x6d\141\x67\x65"]) || !empty($video_meta["\x73\x65\164\x5f\141\x73\x5f\x66\145\x61\x74\165\162\145\144\x5f\x69\x6d\x61\147\145"]))) { goto hDcVk; } goto nwTRm; bLXdb: } public function HNGenerate_Poster_Image($post_id) { goto s9tnf; Wt9e2: g6zSZ: goto Rb6Kd; DMdAU: $this->process_video_thumbnail($post_id, $_POST["\137\x76\x69\x64\145\x6f\x73\137\x6d\x65\x74\x61\142\157\x78\137\x6f\x70\x74\x69\157\156\163"] ?? ''); goto ZHnxg; NP9Dr: FMa2T: goto irN74; ZHnxg: goto FMa2T; goto Wt9e2; oXZ76: kbHDJ: goto DMdAU; aII77: if ($post->post_type === "\x76\151\x64\145\x6f") { goto kbHDJ; } goto zJCAO; zJCAO: if ($post->post_type === "\160\157\163\x74") { goto g6zSZ; } goto C7FcL; Rb6Kd: $this->process_post_thumbnail($post_id); goto NP9Dr; s9tnf: global $post; goto aII77; C7FcL: goto FMa2T; goto oXZ76; irN74: } private function process_video_thumbnail($post_id, $video_meta) { goto ehi7E; qdYpa: uA07a: goto bQEhZ; ehi7E: $image_url = $video_meta["\166\x69\144\x65\x6f\137\164\x68\x75\x6d\x62\156\x61\151\x6c\x5f\165\162\154"] ?? ''; goto L4GRf; kFcfV: if (!($set_feature && !has_post_thumbnail($post_id))) { goto uA07a; } goto P5mPQ; L4GRf: $set_feature = $video_meta["\x73\145\x74\x5f\141\163\x5f\x66\145\141\164\x75\162\x65\x64\137\x69\155\x61\147\145"] ?? ''; goto kFcfV; P5mPQ: $this->haun_save_images($image_url, $post_id, $_POST["\x70\157\163\x74\137\x74\x69\164\x6c\x65"] ?? '', true); goto qdYpa; bQEhZ: } private function process_post_thumbnail($post_id) { goto jOC0D; eLnBG: $check_meta = $_POST["\137\x68\x61\165\156\x5f\x6d\x65\164\141\142\x6f\170\x5f\x6f\x70\x74\151\157\156\163"] ?? ''; goto IPzGs; oRVbC: $save_poster = $meta["\x73\141\166\145\x5f\160\x6f\163\x74\x65\162\x5f\x69\155\141\147\x65"] ?? ''; goto JCgX_; OfDqZ: $set_feature = $meta["\x73\x65\164\x5f\x72\x65\141\x74\165\x72\x65\144\137\151\155\141\x67\145"] ?? ''; goto oRVbC; RqJlJ: $meta["\150\x61\165\156\137\x74\150\x75\x6d\x62\x5f\x75\162\x6c"] = get_the_post_thumbnail_url($post_id, "\x6d\x6f\x76\151\x65\55\164\150\x75\x6d\142") ?: $thumb_url; goto n2ApG; lczyi: update_post_meta($post_id, HNMG_META, $meta); goto ewrC4; oCiwv: if ($save_poster && $poster_url) { goto OU8us; } goto tO2OB; bmd8O: goto L7H0_; goto CxyPh; qIJoH: kSNyL: goto oCiwv; n2ApG: $meta["\x68\141\x75\x6e\137\160\x6f\x73\x74\x65\162\137\x75\162\154"] = $poster_image_url; goto RF2bt; RF2bt: $meta["\163\141\166\x65\137\x70\x6f\x73\164\x65\162\137\x69\x6d\x61\x67\145"] = ''; goto dZrVu; dZrVu: $meta["\163\x65\164\137\162\145\x61\x74\x75\x72\x65\144\x5f\151\155\141\147\145"] = ''; goto lczyi; IPzGs: $thumb_url = $check_meta["\x68\x61\x75\156\x5f\164\x68\x75\x6d\x62\137\165\162\154"] ?? $meta["\150\141\165\156\137\x74\x68\165\x6d\x62\137\x75\x72\x6c"] ?? ''; goto c5ktv; c5ktv: $poster_url = $check_meta["\x68\141\165\x6e\x5f\x70\157\163\164\x65\x72\x5f\x75\x72\x6c"] ?? $meta["\x68\141\165\156\137\160\157\163\164\145\x72\x5f\x75\x72\154"] ?? ''; goto OfDqZ; GpcvC: L7H0_: goto RqJlJ; tO2OB: $poster_image_url = $poster_url; goto bmd8O; ssInp: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\x70\x6f\x73\164\137\164\151\x74\x6c\x65"] ?? ''); goto GpcvC; JCgX_: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto kSNyL; } goto E7smo; CxyPh: OU8us: goto ssInp; E7smo: $this->haun_save_images($thumb_url, $post_id, $_POST["\x70\x6f\163\x74\x5f\164\151\164\154\145"] ?? '', true); goto qIJoH; jOC0D: $meta = get_post_meta($post_id, HNMG_META, true); goto eLnBG; ewrC4: } public function haun_post_save_images($content) { goto BN3dq; cGcCb: preg_match_all("\57\74\151\x6d\x67\x2e\52\77\163\x72\x63\75\42\x28\56\52\77\x29\42\57", stripslashes($content), $matches); goto a1ybE; a1ybE: foreach ($matches[1] as $image_url) { goto Y_hry; Llvx6: $content = str_replace($image_url, $res["\x75\162\x6c"], $content); goto V4g7E; pMGJ3: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto Llvx6; DcxRX: N4Gfg: goto geSaA; Y_hry: if (!($image_url && strpos($image_url, $_SERVER["\x48\x54\x54\120\137\x48\117\123\x54"]) === false)) { goto wQO8s; } goto pMGJ3; V4g7E: wQO8s: goto DcxRX; geSaA: } goto BjRiq; bDrfK: set_time_limit(500); goto nrh8U; BjRiq: xinsp: goto yUqMg; yUqMg: qXUjJ: goto XMRO2; XMRO2: remove_filter("\143\x6f\x6e\x74\x65\156\164\137\x73\141\x76\145\137\160\x72\x65", [$this, "\150\x61\x75\x6e\x5f\x70\157\x73\164\x5f\x73\141\x76\145\x5f\151\155\141\x67\145\163"]); goto Q85e5; nQ6U6: $post_title = $_POST["\160\x6f\x73\x74\x5f\x74\x69\164\154\x65"] ?? ''; goto cGcCb; BN3dq: if (!(isset($_POST["\163\x61\166\145"]) || isset($_POST["\160\x75\x62\154\x69\163\x68"]))) { goto qXUjJ; } goto bDrfK; Q85e5: return $content; goto v0iEN; nrh8U: $post_id = get_the_ID(); goto nQ6U6; v0iEN: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto rAdAE; GXuSb: $res = wp_upload_bits($im_name, '', $file); goto RbxA5; xvPF9: i5q17: goto hsWub; Kv5Em: $im_name = sanitize_title($post_title) . "\55{$post_id}\x2e\x6a\160\147"; goto GXuSb; rAdAE: $file = file_get_contents($image_url); goto Kv5Em; RbxA5: if ($res["\145\162\x72\157\x72"]) { goto i5q17; } goto BD4Z2; hsWub: return $res; goto Y4JQz; BD4Z2: $this->haun_insert_attachment($res["\146\151\154\145"], $post_id, $set_thumb); goto xvPF9; Y4JQz: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto wpbJP; pW70Y: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto PgR10; qsyM9: return $attach_id; goto PMFsl; wpbJP: $filetype = wp_check_filetype($file); goto N34wM; CUlCD: if (!$set_thumb) { goto mbGJE; } goto SWSII; SWSII: set_post_thumbnail($post_id, $attach_id); goto fmGEo; fmGEo: mbGJE: goto qsyM9; N34wM: $attachment = ["\x67\165\151\x64" => wp_get_upload_dir()["\x75\162\x6c"] . "\x2f" . _wp_relative_upload_path($file), "\x70\157\163\x74\x5f\x6d\x69\x6d\x65\137\164\x79\160\145" => $filetype["\x74\171\160\145"], "\160\157\163\164\137\x74\151\164\154\145" => preg_replace("\x2f\134\x2e\x5b\136\x2e\135\x2b\x24\x2f", '', basename($file)), "\x70\x6f\163\x74\x5f\x63\x6f\x6e\164\145\156\164" => '', "\x70\x6f\x73\164\x5f\x73\164\x61\x74\x75\163" => "\151\156\x68\x65\x72\x69\164"]; goto pW70Y; PgR10: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto CUlCD; PMFsl: } }
