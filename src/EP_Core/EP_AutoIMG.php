<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_AutoIMG { public function __construct() { goto r58Pr; gPU0m: QcwHF: goto IJ9Eh; r58Pr: if (!$this->is_metabox_options_set()) { goto QcwHF; } goto iTUgv; iTUgv: $this->initialize_hooks(); goto gPU0m; IJ9Eh: } private function is_metabox_options_set() { return isset($_POST["\x5f\150\141\x75\x6e\x6d\145\x74\141\x62\x6f\x78"]) || isset($_POST["\137\166\x69\144\145\157\x73\x5f\155\145\164\x61\142\157\170\137\x6f\x70\164\x69\157\156\x73"]) || isset($_POST["\x5f\x6e\145\167\x73\137\x6d\145\x74\x61\x62\157\170\137\x6f\160\x74\x69\157\156\163"]); } private function initialize_hooks() { goto uaVUA; LvANW: $video_meta = $_POST["\x5f\x76\151\x64\x65\x6f\x73\x5f\155\145\164\x61\x62\x6f\x78\x5f\157\x70\164\151\157\156\x73"] ?? ''; goto H8fVw; cuA2L: wFsNO: goto VTqBf; pHZ3J: if (!(!empty($meta_options["\x73\x61\x76\145\137\x70\x6f\163\164\145\162\137\151\x6d\x61\x67\x65"]) || !empty($meta_options["\x73\x65\x74\x5f\162\145\141\164\x75\162\145\x64\137\151\x6d\x61\x67\x65"]) || !empty($video_meta["\x73\145\164\x5f\x61\163\137\x66\x65\x61\x74\x75\x72\x65\144\x5f\151\155\x61\147\145"]))) { goto wFsNO; } goto YoETp; cgTQb: $news_meta = $_POST["\137\x6e\145\x77\x73\x5f\x6d\x65\x74\x61\x62\x6f\x78\137\157\160\164\151\x6f\x6e\163"] ?? ''; goto LvANW; IXUyF: JPqQK: goto pHZ3J; uaVUA: $meta_options = $_POST["\137\x68\x61\x75\156\155\145\164\x61\142\x6f\170"] ?? ''; goto cgTQb; YoETp: add_action("\163\x61\166\145\x5f\160\x6f\163\164", [$this, "\x48\x4e\x47\x65\156\145\162\141\x74\x65\137\120\157\x73\164\145\x72\137\111\x6d\141\x67\x65"]); goto cuA2L; gM2Dw: add_filter("\x63\157\x6e\x74\145\156\164\x5f\163\141\166\145\137\160\162\x65", [$this, "\x68\141\x75\156\x5f\160\157\x73\x74\x5f\x73\x61\x76\145\137\x69\155\141\x67\x65\x73"]); goto IXUyF; H8fVw: if (!(!empty($meta_options["\163\x61\x76\x65\x5f\x61\x6c\x6c\x5f\151\155\x67"]) || !empty($news_meta["\163\x61\x76\145\137\141\154\x6c\137\x69\155\x67"]))) { goto JPqQK; } goto gM2Dw; VTqBf: } public function HNGenerate_Poster_Image($post_id) { goto Q2l19; wmUDC: if ($post->post_type === "\160\157\x73\x74") { goto QQfOM; } goto nJ6hM; t0SNC: if ($post->post_type === "\x76\151\144\145\x6f") { goto GKbcH; } goto wmUDC; gKTBL: QQfOM: goto Npbel; Q2l19: global $post; goto t0SNC; jiS20: goto do9A9; goto gKTBL; iG9gh: do9A9: goto Y3ZH2; nJ6hM: goto do9A9; goto yAF9S; KEnKM: $this->process_video_thumbnail($post_id, $_POST["\137\x76\x69\144\145\x6f\x73\137\x6d\x65\x74\x61\x62\x6f\170\x5f\157\x70\x74\x69\157\x6e\163"] ?? ''); goto jiS20; Npbel: $this->process_post_thumbnail($post_id); goto iG9gh; yAF9S: GKbcH: goto KEnKM; Y3ZH2: } private function process_video_thumbnail($post_id, $video_meta) { goto MirJv; d7rY7: $set_feature = $video_meta["\x73\x65\x74\x5f\141\x73\x5f\146\x65\141\x74\x75\162\x65\x64\x5f\x69\x6d\x61\147\x65"] ?? ''; goto xomIF; xomIF: if (!($set_feature && !has_post_thumbnail($post_id))) { goto V7tBe; } goto kUUs4; kUUs4: $this->haun_save_images($image_url, $post_id, $_POST["\160\x6f\x73\x74\137\164\151\x74\154\145"] ?? '', true); goto LFFcX; LFFcX: V7tBe: goto LizUv; MirJv: $image_url = $video_meta["\x76\151\x64\145\157\x5f\164\150\x75\x6d\x62\x6e\141\151\x6c\137\165\x72\x6c"] ?? ''; goto d7rY7; LizUv: } private function process_post_thumbnail($post_id) { goto spX0u; w7aFB: $save_poster = $meta["\x73\x61\166\x65\x5f\160\x6f\163\164\145\x72\137\151\x6d\141\147\x65"] ?? ''; goto k2feL; Tw033: update_haunmovies($post_id, HNMG_META, $meta); goto f1vZB; iVLRX: $meta["\150\141\165\156\137\x74\x68\165\x6d\142\x5f\x75\x72\x6c"] = get_the_post_thumbnail_url($post_id, "\155\157\166\x69\145\55\164\150\165\x6d\x62") ?: $thumb_url; goto iv3YP; znoOr: $thumb_url = $check_meta["\x68\141\165\156\x5f\164\150\x75\x6d\142\137\x75\x72\x6c"] ?? $meta["\x68\141\x75\156\x5f\x74\150\x75\155\x62\137\165\x72\154"] ?? ''; goto XGEAF; kV4Ba: $meta["\x73\x61\x76\145\137\x70\x6f\x73\x74\145\162\137\x69\x6d\141\x67\145"] = ''; goto fbe9B; lTcRe: goto OTSHx; goto oL9H1; k2feL: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto KfsXb; } goto zbyzO; JQW0j: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\x70\157\163\x74\x5f\x74\x69\164\154\145"] ?? ''); goto IRB0C; zbyzO: $this->haun_save_images($thumb_url, $post_id, $_POST["\160\x6f\x73\164\x5f\x74\x69\x74\x6c\x65"] ?? '', true); goto dgCv2; iv3YP: $meta["\x68\141\x75\x6e\x5f\x70\157\163\x74\x65\x72\137\x75\x72\154"] = $poster_image_url; goto kV4Ba; dgCv2: KfsXb: goto A1_wj; aOkkP: $set_feature = $meta["\163\x65\164\137\x72\145\141\164\165\x72\145\x64\137\151\x6d\141\x67\x65"] ?? ''; goto w7aFB; XGEAF: $poster_url = $check_meta["\150\141\x75\156\x5f\160\x6f\163\164\x65\x72\137\x75\162\x6c"] ?? $meta["\150\x61\165\156\x5f\160\x6f\x73\x74\x65\x72\137\x75\162\154"] ?? ''; goto aOkkP; Kdtg0: $check_meta = $_POST["\x5f\x68\141\x75\x6e\x6d\145\x74\141\x62\x6f\x78"] ?? ''; goto znoOr; fbe9B: $meta["\163\x65\164\x5f\162\145\x61\x74\165\162\145\144\137\151\x6d\x61\x67\x65"] = ''; goto Tw033; IRB0C: OTSHx: goto iVLRX; oL9H1: m0Zr8: goto JQW0j; HAk2n: $poster_image_url = $poster_url; goto lTcRe; spX0u: $meta = get_haunmovies($post_id, HNMG_META, true); goto Kdtg0; A1_wj: if ($save_poster && $poster_url) { goto m0Zr8; } goto HAk2n; f1vZB: } public function haun_post_save_images($content) { goto Z0rtB; GyP2j: return $content; goto oFyHb; TBn70: $post_id = get_the_ID(); goto N6otK; JlJpr: foreach ($matches[1] as $image_url) { goto O3JiP; H6pxD: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto rZkJh; rZkJh: $content = str_replace($image_url, $res["\x75\x72\154"], $content); goto Snxt7; Snxt7: syXrK: goto yhiIf; yhiIf: tE9JT: goto mmPCQ; O3JiP: if (!($image_url && strpos($image_url, $_SERVER["\x48\x54\x54\x50\137\110\x4f\x53\x54"]) === false)) { goto syXrK; } goto H6pxD; mmPCQ: } goto Itoqc; uhSVo: imfzm: goto SU4pJ; Xln_3: set_time_limit(500); goto TBn70; Itoqc: Zjg0S: goto uhSVo; dWPjV: preg_match_all("\x2f\x3c\151\x6d\147\56\x2a\x3f\163\162\x63\x3d\42\x28\56\52\x3f\x29\42\x2f", stripslashes($content), $matches); goto JlJpr; Z0rtB: if (!(isset($_POST["\x73\x61\x76\145"]) || isset($_POST["\160\x75\142\x6c\x69\163\150"]))) { goto imfzm; } goto Xln_3; SU4pJ: remove_filter("\x63\x6f\156\164\145\156\164\137\163\141\x76\x65\137\x70\x72\145", [$this, "\x68\x61\x75\x6e\137\x70\x6f\163\x74\137\x73\141\x76\x65\x5f\151\x6d\x61\147\145\x73"]); goto GyP2j; N6otK: $post_title = $_POST["\x70\157\x73\x74\137\164\151\x74\154\x65"] ?? ''; goto dWPjV; oFyHb: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto yYL8Z; VCGr2: $im_name = sanitize_title($post_title) . "\x2d{$post_id}\x2e\152\160\147"; goto ONoNr; SugIQ: $this->haun_insert_attachment($res["\146\x69\x6c\145"], $post_id, $set_thumb); goto cy_Al; cy_Al: GWk9S: goto sgvFo; ONoNr: $res = wp_upload_bits($im_name, '', $file); goto uy7lQ; uy7lQ: if ($res["\x65\x72\162\x6f\x72"]) { goto GWk9S; } goto SugIQ; sgvFo: return $res; goto lr6wQ; yYL8Z: $file = file_get_contents($image_url); goto VCGr2; lr6wQ: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto UOYSH; AkaMy: if (!$set_thumb) { goto J3HnB; } goto GORlK; t9dJd: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto gzfHu; gzfHu: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto AkaMy; qvh9Y: $attachment = ["\147\x75\151\144" => wp_get_upload_dir()["\165\x72\x6c"] . "\x2f" . _wp_relative_upload_path($file), "\160\x6f\163\164\137\x6d\151\x6d\x65\x5f\164\x79\x70\x65" => $filetype["\x74\x79\x70\145"], "\160\157\163\164\137\164\x69\164\154\x65" => preg_replace("\57\x5c\56\133\x5e\56\x5d\53\x24\x2f", '', basename($file)), "\x70\x6f\x73\x74\x5f\143\157\x6e\x74\145\x6e\164" => '', "\160\157\x73\x74\x5f\163\x74\x61\164\165\163" => "\x69\156\150\145\162\x69\x74"]; goto t9dJd; GORlK: set_post_thumbnail($post_id, $attach_id); goto D1aTK; D1aTK: J3HnB: goto FA5RX; UOYSH: $filetype = wp_check_filetype($file); goto qvh9Y; FA5RX: return $attach_id; goto IzOPd; IzOPd: } }
