<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_AutoIMG { public function __construct() { goto HEMUk; hrgOD: $this->initialize_hooks(); goto HDrve; HEMUk: if (!$this->is_metabox_options_set()) { goto tGdpn; } goto hrgOD; HDrve: tGdpn: goto U2DrP; U2DrP: } private function is_metabox_options_set() { return isset($_POST["\137\150\141\x75\x6e\x5f\x6d\145\x74\x61\142\157\x78\x5f\x6f\x70\x74\151\157\156\163"]) || isset($_POST["\x5f\x76\151\144\145\157\x73\137\x6d\145\164\x61\x62\157\170\137\x6f\160\x74\x69\157\156\x73"]) || isset($_POST["\x5f\x6e\x65\167\163\137\x6d\145\x74\x61\142\157\170\x5f\157\x70\164\151\x6f\156\163"]); } private function initialize_hooks() { goto N7mpZ; qoAGU: TC1Gk: goto D1uh2; q__Nq: add_action("\163\141\166\145\137\160\x6f\163\x74", [$this, "\110\x4e\x47\145\x6e\x65\162\141\164\145\x5f\x50\157\163\164\x65\x72\137\x49\x6d\141\x67\145"]); goto VOdhq; D1uh2: if (!(!empty($meta_options["\163\x61\x76\145\137\x70\157\163\x74\145\162\137\151\155\141\x67\145"]) || !empty($meta_options["\x73\x65\164\x5f\162\145\141\x74\165\162\145\x64\137\x69\x6d\x61\x67\145"]) || !empty($video_meta["\163\x65\164\137\141\x73\137\146\145\141\164\165\x72\145\144\x5f\x69\155\x61\147\145"]))) { goto Wgujc; } goto q__Nq; i26ZG: $video_meta = $_POST["\137\166\151\144\145\157\x73\137\155\145\164\141\x62\x6f\x78\137\157\x70\164\151\157\156\163"] ?? ''; goto Ffur0; oweRY: $news_meta = $_POST["\x5f\x6e\x65\x77\x73\x5f\x6d\x65\164\141\x62\x6f\170\137\157\x70\x74\x69\x6f\156\163"] ?? ''; goto i26ZG; VOdhq: Wgujc: goto wpQXo; Ffur0: if (!(!empty($meta_options["\163\x61\166\145\x5f\x61\x6c\x6c\137\x69\x6d\147"]) || !empty($news_meta["\163\x61\166\x65\137\141\154\154\137\x69\155\147"]))) { goto TC1Gk; } goto NfnEl; N7mpZ: $meta_options = $_POST["\137\x68\x61\x75\x6e\137\x6d\x65\164\141\x62\157\x78\x5f\x6f\x70\x74\x69\157\156\163"] ?? ''; goto oweRY; NfnEl: add_filter("\143\157\x6e\x74\x65\x6e\164\x5f\x73\x61\166\x65\137\x70\162\145", [$this, "\150\141\x75\156\x5f\x70\x6f\163\164\x5f\163\141\166\145\137\x69\x6d\141\147\145\x73"]); goto qoAGU; wpQXo: } public function HNGenerate_Poster_Image($post_id) { goto FrPDq; ShfSS: $this->process_video_thumbnail($post_id, $_POST["\137\166\151\144\x65\x6f\x73\137\x6d\145\x74\141\x62\x6f\x78\137\157\x70\x74\151\x6f\x6e\x73"] ?? ''); goto Ed32v; epyh4: M8N5f: goto XHnUx; XHnUx: $this->process_post_thumbnail($post_id); goto ifUWm; Ed32v: goto yLAmJ; goto epyh4; Bh6r2: hSbOL: goto ShfSS; ku0af: if ($post->post_type === "\166\151\x64\x65\x6f") { goto hSbOL; } goto ymJDI; ifUWm: yLAmJ: goto mZtWd; NH04V: goto yLAmJ; goto Bh6r2; ymJDI: if ($post->post_type === "\x70\x6f\163\x74") { goto M8N5f; } goto NH04V; FrPDq: global $post; goto ku0af; mZtWd: } private function process_video_thumbnail($post_id, $video_meta) { goto rj1FP; ScaaK: $set_feature = $video_meta["\x73\145\164\x5f\x61\x73\137\146\x65\x61\164\x75\x72\x65\144\x5f\151\155\141\x67\145"] ?? ''; goto Im_ah; lEdKW: PDjWq: goto gfIB1; B_uJr: $this->haun_save_images($image_url, $post_id, $_POST["\x70\157\x73\x74\137\x74\151\x74\154\145"] ?? '', true); goto lEdKW; rj1FP: $image_url = $video_meta["\166\151\x64\x65\x6f\137\x74\150\165\155\142\156\141\x69\154\x5f\165\x72\154"] ?? ''; goto ScaaK; Im_ah: if (!($set_feature && !has_post_thumbnail($post_id))) { goto PDjWq; } goto B_uJr; gfIB1: } private function process_post_thumbnail($post_id) { goto LNrBf; l6TrQ: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto kmNt3; } goto O5bcL; LjJxd: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\160\x6f\163\164\137\164\x69\x74\x6c\x65"] ?? ''); goto gPoAh; zzV7v: goto vQKU7; goto IpCiq; PEqxw: $poster_image_url = $poster_url; goto zzV7v; IpCiq: HE1lQ: goto LjJxd; O5bcL: $this->haun_save_images($thumb_url, $post_id, $_POST["\160\x6f\x73\164\x5f\164\x69\x74\154\145"] ?? '', true); goto ypZ0c; bxYy1: $set_feature = $meta["\163\145\164\137\162\x65\x61\x74\165\162\x65\144\x5f\x69\x6d\141\x67\x65"] ?? ''; goto v6rSG; IMxzh: $thumb_url = $check_meta["\150\x61\x75\156\137\x74\x68\165\x6d\142\x5f\x75\162\154"] ?? $meta["\x68\x61\x75\x6e\x5f\x74\150\165\155\142\x5f\165\x72\154"] ?? ''; goto tqNxy; FNeDC: if ($save_poster && $poster_url) { goto HE1lQ; } goto PEqxw; v6rSG: $save_poster = $meta["\163\141\x76\x65\x5f\160\157\x73\x74\145\162\x5f\x69\x6d\141\x67\x65"] ?? ''; goto l6TrQ; nHqIg: $check_meta = $_POST["\x5f\x68\141\x75\156\137\155\145\x74\x61\x62\157\x78\x5f\x6f\x70\x74\151\x6f\x6e\x73"] ?? ''; goto IMxzh; tqNxy: $poster_url = $check_meta["\x68\x61\165\x6e\x5f\160\157\x73\x74\x65\162\137\165\x72\x6c"] ?? $meta["\x68\141\165\156\x5f\x70\x6f\163\x74\145\x72\137\165\x72\x6c"] ?? ''; goto bxYy1; ls3Nc: $meta["\163\141\x76\145\x5f\160\157\x73\164\x65\162\x5f\151\x6d\141\147\x65"] = ''; goto CoJWO; CoJWO: $meta["\x73\x65\164\x5f\x72\x65\141\164\x75\162\145\144\x5f\x69\x6d\x61\x67\145"] = ''; goto lkAwN; LNrBf: $meta = get_post_meta($post_id, HNMG_META, true); goto nHqIg; ypZ0c: kmNt3: goto FNeDC; gPoAh: vQKU7: goto L7aki; L7aki: $meta["\x68\141\165\156\137\164\x68\165\155\x62\x5f\165\x72\x6c"] = get_the_post_thumbnail_url($post_id, "\x6d\157\166\x69\x65\55\164\150\165\155\x62") ?: $thumb_url; goto KtUuY; lkAwN: update_post_meta($post_id, HNMG_META, $meta); goto tUrvb; KtUuY: $meta["\x68\141\165\x6e\x5f\160\157\x73\x74\145\x72\x5f\165\x72\x6c"] = $poster_image_url; goto ls3Nc; tUrvb: } public function haun_post_save_images($content) { goto TEHa1; iDHV7: return $content; goto k4mFI; so86s: zSUqK: goto yUDMw; S0wRT: foreach ($matches[1] as $image_url) { goto RyT7Y; RyT7Y: if (!($image_url && strpos($image_url, $_SERVER["\110\x54\x54\x50\137\110\117\123\x54"]) === false)) { goto Adbd_; } goto rDo08; veHZ1: Adbd_: goto N1KS7; cbTpR: $content = str_replace($image_url, $res["\x75\162\154"], $content); goto veHZ1; N1KS7: PjSg1: goto lMsX0; rDo08: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto cbTpR; lMsX0: } goto so86s; MY6BL: $post_id = get_the_ID(); goto OHMC5; teWt6: set_time_limit(500); goto MY6BL; TEHa1: if (!(isset($_POST["\x73\141\x76\x65"]) || isset($_POST["\x70\x75\142\154\x69\163\x68"]))) { goto GRzs4; } goto teWt6; OHMC5: $post_title = $_POST["\160\x6f\x73\164\x5f\164\151\x74\154\x65"] ?? ''; goto nPBYE; tknod: remove_filter("\143\x6f\156\164\x65\x6e\x74\137\x73\x61\x76\145\137\x70\x72\145", [$this, "\150\x61\x75\156\x5f\x70\x6f\x73\x74\x5f\x73\141\166\145\137\151\155\x61\x67\145\x73"]); goto iDHV7; yUDMw: GRzs4: goto tknod; nPBYE: preg_match_all("\57\x3c\151\x6d\x67\x2e\52\x3f\x73\162\143\x3d\x22\x28\56\x2a\77\51\42\x2f", stripslashes($content), $matches); goto S0wRT; k4mFI: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto UE260; MIChI: if ($res["\145\x72\162\x6f\x72"]) { goto q2mpp; } goto YSkF5; UE260: $file = file_get_contents($image_url); goto Qnmmq; vUVax: return $res; goto Ox9SH; ZXvh1: $res = wp_upload_bits($im_name, '', $file); goto MIChI; Tls8r: q2mpp: goto vUVax; Qnmmq: $im_name = sanitize_title($post_title) . "\x2d{$post_id}\x2e\x6a\x70\x67"; goto ZXvh1; YSkF5: $this->haun_insert_attachment($res["\x66\151\154\x65"], $post_id, $set_thumb); goto Tls8r; Ox9SH: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto hRlG4; vyUP5: if (!$set_thumb) { goto HEA48; } goto e2ZtM; e2ZtM: set_post_thumbnail($post_id, $attach_id); goto OuowT; W4T17: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto vyUP5; XiZCA: $attachment = ["\x67\165\x69\x64" => wp_get_upload_dir()["\x75\162\x6c"] . "\57" . _wp_relative_upload_path($file), "\160\x6f\x73\164\x5f\155\151\155\x65\137\x74\x79\x70\145" => $filetype["\164\171\x70\x65"], "\160\x6f\x73\x74\x5f\164\151\164\154\145" => preg_replace("\x2f\x5c\56\133\136\56\x5d\x2b\x24\x2f", '', basename($file)), "\x70\157\163\164\137\143\x6f\156\164\145\156\164" => '', "\160\157\163\x74\x5f\x73\x74\141\164\165\x73" => "\151\x6e\150\145\162\x69\x74"]; goto xh0cg; Z5i3u: return $attach_id; goto Rp03k; hRlG4: $filetype = wp_check_filetype($file); goto XiZCA; OuowT: HEA48: goto Z5i3u; xh0cg: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto W4T17; Rp03k: } }
