<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_News { public function __construct() { goto k5yD0; E3GAs: ganQJ: goto Rrz3F; QwC81: $this->initialize_hooks(); goto E3GAs; k5yD0: if (!$this->is_metabox_options_set()) { goto ganQJ; } goto QwC81; Rrz3F: } private function is_metabox_options_set() { return isset($_POST["\x5f\150\141\165\156\137\x6d\145\x74\x61\x62\157\x78\137\157\160\164\x69\x6f\156\163"]) || isset($_POST["\x5f\x76\x69\x64\x65\157\x73\x5f\155\145\x74\141\142\x6f\x78\x5f\x6f\160\x74\151\x6f\x6e\x73"]) || isset($_POST["\x5f\156\145\x77\x73\x5f\x6d\145\164\141\142\157\x78\x5f\157\x70\x74\151\157\156\163"]); } private function initialize_hooks() { goto F3dKZ; LHUX1: if (!(!empty($meta_options["\163\x61\166\145\137\x70\157\x73\x74\145\x72\137\151\x6d\x61\x67\145"]) || !empty($meta_options["\x73\x65\164\x5f\162\145\141\x74\x75\162\x65\144\x5f\x69\155\141\147\145"]) || !empty($video_meta["\x73\145\x74\x5f\x61\163\x5f\x66\x65\x61\x74\x75\162\x65\x64\137\x69\155\x61\x67\x65"]))) { goto oiO7D; } goto Ec3m9; jnfPw: add_filter("\143\157\x6e\164\x65\156\164\x5f\x73\141\x76\145\137\160\162\x65", [$this, "\150\141\165\156\137\160\157\163\164\137\x73\x61\166\x65\x5f\151\x6d\x61\147\145\x73"]); goto lCmaq; F3dKZ: $meta_options = $_POST["\x5f\x68\x61\x75\x6e\137\x6d\x65\164\x61\x62\x6f\x78\x5f\157\x70\164\151\157\156\x73"] ?? ''; goto uxoVo; yIRGm: oiO7D: goto BmzDi; lCmaq: aBnsA: goto LHUX1; uxoVo: $news_meta = $_POST["\x5f\156\x65\167\163\x5f\x6d\x65\164\x61\x62\x6f\x78\137\x6f\x70\164\x69\x6f\x6e\163"] ?? ''; goto hjOER; aZyDm: if (!(!empty($meta_options["\x73\x61\x76\x65\x5f\141\x6c\x6c\x5f\x69\x6d\147"]) || !empty($news_meta["\163\x61\x76\145\137\x61\154\154\x5f\151\155\147"]))) { goto aBnsA; } goto jnfPw; hjOER: $video_meta = $_POST["\137\x76\x69\x64\145\157\x73\137\x6d\x65\164\x61\x62\x6f\170\137\157\x70\164\x69\157\156\x73"] ?? ''; goto aZyDm; Ec3m9: add_action("\163\x61\166\x65\x5f\160\157\163\x74", [$this, "\x48\x4e\x47\x65\x6e\x65\x72\141\164\x65\137\x50\x6f\163\164\x65\162\137\x49\x6d\x61\x67\x65"]); goto yIRGm; BmzDi: } public function HNGenerate_Poster_Image($post_id) { goto l8bIv; SQ19l: $this->process_video_thumbnail($post_id, $_POST["\x5f\x76\x69\x64\x65\x6f\x73\137\x6d\145\164\x61\142\157\170\137\157\x70\x74\x69\x6f\156\163"] ?? ''); goto TT14m; TT14m: goto x4GYP; goto mlA2r; l8bIv: global $post; goto S7GlZ; S5IJa: $this->process_post_thumbnail($post_id); goto UW0K_; oQJru: tDKFn: goto SQ19l; mlA2r: gfxYP: goto S5IJa; G2z7d: if ($post->post_type === "\x70\x6f\x73\164") { goto gfxYP; } goto JMy4v; JMy4v: goto x4GYP; goto oQJru; S7GlZ: if ($post->post_type === "\x76\x69\144\x65\x6f") { goto tDKFn; } goto G2z7d; UW0K_: x4GYP: goto mMg7O; mMg7O: } private function process_video_thumbnail($post_id, $video_meta) { goto B4cQx; Y_8bP: $set_feature = $video_meta["\x73\x65\164\137\x61\x73\137\146\145\x61\x74\165\x72\x65\144\x5f\x69\x6d\x61\x67\x65"] ?? ''; goto eYEdP; PnPEj: $this->haun_save_images($image_url, $post_id, $_POST["\x70\157\x73\x74\137\x74\151\x74\154\x65"] ?? '', true); goto YezQt; eYEdP: if (!($set_feature && !has_post_thumbnail($post_id))) { goto jBfC6; } goto PnPEj; B4cQx: $image_url = $video_meta["\x76\151\144\145\157\x5f\164\150\x75\155\142\156\141\x69\x6c\x5f\165\x72\154"] ?? ''; goto Y_8bP; YezQt: jBfC6: goto esLSS; esLSS: } private function process_post_thumbnail($post_id) { goto JUR01; dnWGi: $meta["\x68\141\165\156\137\160\x6f\x73\164\145\162\x5f\165\x72\154"] = $poster_image_url; goto gStwp; JUR01: $meta = get_post_meta($post_id, HNMG_META, true); goto MAH34; e7Q7U: $meta["\x73\x65\164\x5f\162\145\x61\x74\x75\x72\x65\144\x5f\x69\155\x61\x67\x65"] = ''; goto JE3d3; MAH34: $check_meta = $_POST["\x5f\x68\x61\x75\x6e\x5f\x6d\x65\164\141\x62\x6f\170\x5f\x6f\x70\x74\x69\x6f\x6e\163"] ?? ''; goto rxOR2; t018A: yUQdr: goto owUKp; owUKp: $meta["\150\x61\165\x6e\137\164\150\165\x6d\142\137\165\x72\154"] = get_the_post_thumbnail_url($post_id, "\155\x6f\166\151\145\x2d\164\x68\165\x6d\x62") ?: $thumb_url; goto dnWGi; i4XBQ: KVz3Z: goto YvLtb; aa0JE: $poster_image_url = $poster_url; goto T5WcX; b0RLm: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\160\157\x73\x74\137\164\x69\x74\x6c\145"] ?? ''); goto t018A; s6IYI: $this->haun_save_images($thumb_url, $post_id, $_POST["\160\x6f\x73\164\137\x74\x69\164\x6c\145"] ?? '', true); goto i4XBQ; YvLtb: if ($save_poster && $poster_url) { goto mO9W_; } goto aa0JE; JE3d3: update_post_meta($post_id, HNMG_META, $meta); goto WkYWH; R0mx8: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto KVz3Z; } goto s6IYI; l5YXI: $save_poster = $meta["\x73\141\166\145\x5f\160\157\163\x74\145\x72\x5f\x69\x6d\x61\147\145"] ?? ''; goto R0mx8; gStwp: $meta["\x73\141\166\x65\x5f\160\x6f\x73\164\x65\x72\x5f\151\155\x61\x67\145"] = ''; goto e7Q7U; T5WcX: goto yUQdr; goto w3i0E; w3i0E: mO9W_: goto b0RLm; T6k4h: $poster_url = $check_meta["\150\x61\x75\x6e\137\160\x6f\163\164\145\x72\137\x75\x72\x6c"] ?? $meta["\150\x61\165\156\x5f\x70\157\163\164\145\162\x5f\x75\162\154"] ?? ''; goto maMB5; maMB5: $set_feature = $meta["\x73\145\164\137\162\x65\x61\x74\165\162\145\144\x5f\151\155\141\147\145"] ?? ''; goto l5YXI; rxOR2: $thumb_url = $check_meta["\x68\x61\165\156\x5f\x74\x68\x75\x6d\142\x5f\x75\162\x6c"] ?? $meta["\150\141\x75\156\137\x74\150\x75\155\x62\137\x75\162\x6c"] ?? ''; goto T6k4h; WkYWH: } public function haun_post_save_images($content) { goto tL_5C; dv9V1: foreach ($matches[1] as $image_url) { goto l7GKQ; h9dCO: qkcPM: goto md1Bd; l7GKQ: if (!($image_url && strpos($image_url, $_SERVER["\110\x54\x54\x50\x5f\x48\x4f\123\124"]) === false)) { goto ZXfHQ; } goto QPePV; ftTfL: $content = str_replace($image_url, $res["\x75\x72\154"], $content); goto eyFK2; eyFK2: ZXfHQ: goto h9dCO; QPePV: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto ftTfL; md1Bd: } goto HgkoL; NXmbm: remove_filter("\143\x6f\x6e\164\145\156\x74\137\163\141\166\x65\x5f\160\x72\145", [$this, "\x68\141\x75\156\x5f\x70\x6f\x73\164\137\163\141\x76\145\x5f\151\155\141\x67\145\163"]); goto F_ilJ; Bjx04: VKISZ: goto NXmbm; kVtuP: $post_title = $_POST["\160\157\163\164\x5f\164\x69\x74\154\x65"] ?? ''; goto tV0as; F2iFa: $post_id = get_the_ID(); goto kVtuP; tL_5C: if (!(isset($_POST["\163\141\166\x65"]) || isset($_POST["\x70\x75\142\154\151\163\150"]))) { goto VKISZ; } goto J14kz; HgkoL: ZMuMD: goto Bjx04; J14kz: set_time_limit(500); goto F2iFa; tV0as: preg_match_all("\57\x3c\151\x6d\147\x2e\x2a\77\x73\x72\143\x3d\42\x28\x2e\x2a\77\51\42\x2f", stripslashes($content), $matches); goto dv9V1; F_ilJ: return $content; goto NsQRh; NsQRh: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto ocLUt; nIDUR: $im_name = sanitize_title($post_title) . "\55{$post_id}\x2e\152\160\147"; goto McHrP; fn7VH: $this->haun_insert_attachment($res["\146\151\x6c\145"], $post_id, $set_thumb); goto gXr33; McHrP: $res = wp_upload_bits($im_name, '', $file); goto YggH9; YggH9: if ($res["\x65\162\x72\x6f\162"]) { goto We32X; } goto fn7VH; gXr33: We32X: goto vahsw; vahsw: return $res; goto eh7kn; ocLUt: $file = file_get_contents($image_url); goto nIDUR; eh7kn: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto HKTXH; HKTXH: $filetype = wp_check_filetype($file); goto esEFT; djiDW: set_post_thumbnail($post_id, $attach_id); goto cHLZN; jXsv8: return $attach_id; goto Jwt2V; esEFT: $attachment = ["\x67\165\151\x64" => wp_get_upload_dir()["\165\162\154"] . "\x2f" . _wp_relative_upload_path($file), "\x70\x6f\163\x74\137\x6d\151\x6d\x65\137\x74\x79\160\145" => $filetype["\164\171\x70\145"], "\x70\x6f\x73\164\x5f\164\151\x74\154\x65" => preg_replace("\57\134\56\x5b\x5e\56\x5d\53\x24\x2f", '', basename($file)), "\160\157\x73\164\x5f\143\157\x6e\164\145\x6e\x74" => '', "\x70\x6f\x73\164\137\x73\x74\141\164\165\163" => "\151\156\150\x65\162\x69\164"]; goto QXS5i; cHLZN: yvj26: goto jXsv8; IA8j3: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto STNqP; STNqP: if (!$set_thumb) { goto yvj26; } goto djiDW; QXS5i: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto IA8j3; Jwt2V: } }
