<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_News { public function __construct() { goto nLp5w; lNU6d: $this->initialize_hooks(); goto Ve6AP; Ve6AP: j1Xwh: goto OZzhF; nLp5w: if (!$this->is_metabox_options_set()) { goto j1Xwh; } goto lNU6d; OZzhF: } private function is_metabox_options_set() { return isset($_POST["\x5f\x68\x61\x75\156\137\x6d\x65\x74\x61\142\157\170\x5f\157\x70\x74\151\x6f\x6e\163"]) || isset($_POST["\x5f\x76\x69\x64\145\x6f\163\137\x6d\x65\x74\x61\142\x6f\x78\x5f\x6f\160\x74\151\157\156\x73"]) || isset($_POST["\x5f\x6e\x65\x77\x73\x5f\x6d\x65\164\x61\x62\157\x78\x5f\x6f\160\x74\151\x6f\x6e\163"]); } private function initialize_hooks() { goto MmjHy; AsR2v: $news_meta = $_POST["\137\x6e\145\x77\x73\137\x6d\x65\x74\x61\142\157\170\137\157\160\164\x69\x6f\x6e\x73"] ?? ''; goto PHFUz; PHFUz: $video_meta = $_POST["\137\x76\151\144\145\157\x73\137\155\145\x74\141\142\x6f\170\x5f\x6f\160\x74\151\157\156\163"] ?? ''; goto onlEP; Yf47i: if (!(!empty($meta_options["\163\141\166\x65\137\160\157\x73\164\145\162\137\x69\x6d\141\147\145"]) || !empty($meta_options["\163\x65\x74\137\162\145\x61\164\165\x72\x65\144\137\x69\x6d\141\147\145"]) || !empty($video_meta["\x73\145\164\x5f\x61\x73\137\x66\145\x61\x74\165\x72\145\144\x5f\151\155\141\147\145"]))) { goto hYCE0; } goto x6TTj; MmjHy: $meta_options = $_POST["\x5f\x68\x61\165\156\137\x6d\x65\164\x61\x62\157\x78\x5f\x6f\x70\164\151\157\156\163"] ?? ''; goto AsR2v; x6TTj: add_action("\x73\x61\x76\145\x5f\x70\x6f\163\164", [$this, "\110\116\x47\x65\x6e\145\162\x61\164\x65\x5f\120\157\163\x74\x65\162\137\x49\155\141\x67\x65"]); goto toHdR; N2Jr8: iiIZ0: goto Yf47i; tSR5g: add_filter("\143\157\156\164\x65\156\164\137\x73\x61\166\x65\x5f\160\x72\x65", [$this, "\x68\141\165\156\137\x70\x6f\x73\164\137\x73\141\166\145\x5f\x69\155\x61\x67\x65\x73"]); goto N2Jr8; onlEP: if (!(!empty($meta_options["\x73\x61\x76\145\x5f\x61\x6c\x6c\x5f\151\x6d\147"]) || !empty($news_meta["\x73\141\x76\145\x5f\x61\x6c\x6c\137\151\x6d\x67"]))) { goto iiIZ0; } goto tSR5g; toHdR: hYCE0: goto Yqpkb; Yqpkb: } public function HNGenerate_Poster_Image($post_id) { goto QPCRM; YXFy2: OAWF3: goto hYU_T; S8K73: goto OAWF3; goto NWn0n; QPCRM: global $post; goto SXjjn; PvO3d: ILxTm: goto wNPpX; gE7b8: $this->process_post_thumbnail($post_id); goto YXFy2; wNPpX: $this->process_video_thumbnail($post_id, $_POST["\x5f\x76\151\x64\x65\x6f\163\x5f\155\145\164\141\142\157\170\137\x6f\160\x74\151\157\156\163"] ?? ''); goto S8K73; dUL8b: if ($post->post_type === "\160\x6f\163\164") { goto V1oWw; } goto PJP1G; NWn0n: V1oWw: goto gE7b8; SXjjn: if ($post->post_type === "\x76\151\144\145\x6f") { goto ILxTm; } goto dUL8b; PJP1G: goto OAWF3; goto PvO3d; hYU_T: } private function process_video_thumbnail($post_id, $video_meta) { goto X4VZo; qfeZm: $this->haun_save_images($image_url, $post_id, $_POST["\160\x6f\x73\164\x5f\164\x69\x74\x6c\145"] ?? '', true); goto b_Y43; b_Y43: G2Of_: goto SAkWE; X4VZo: $image_url = $video_meta["\166\x69\x64\145\x6f\x5f\164\x68\x75\x6d\142\x6e\141\151\154\x5f\x75\162\154"] ?? ''; goto AJ62P; bo0bS: if (!($set_feature && !has_post_thumbnail($post_id))) { goto G2Of_; } goto qfeZm; AJ62P: $set_feature = $video_meta["\163\145\164\137\x61\163\x5f\146\x65\x61\x74\165\x72\x65\144\x5f\151\x6d\141\x67\x65"] ?? ''; goto bo0bS; SAkWE: } private function process_post_thumbnail($post_id) { goto oXr2q; OUwps: $set_feature = $meta["\163\x65\164\137\162\145\x61\x74\x75\x72\145\x64\137\x69\155\x61\x67\145"] ?? ''; goto ypist; w3zU2: $meta["\x68\x61\x75\156\x5f\x70\157\163\x74\x65\162\137\165\x72\154"] = $poster_image_url; goto yiUZv; Ugev0: $meta["\150\141\165\156\x5f\164\150\165\x6d\x62\137\165\x72\154"] = get_the_post_thumbnail_url($post_id, "\x6d\x6f\x76\151\x65\55\164\x68\x75\155\x62") ?: $thumb_url; goto w3zU2; oXr2q: $meta = get_post_meta($post_id, HNMG_META, true); goto FMuS5; yiUZv: $meta["\163\x61\166\145\x5f\x70\x6f\163\164\x65\x72\x5f\x69\x6d\141\147\x65"] = ''; goto c_qvx; c_qvx: $meta["\x73\x65\x74\137\x72\145\x61\x74\x75\162\x65\x64\137\x69\x6d\141\147\x65"] = ''; goto LWXzW; TmIoJ: if ($save_poster && $poster_url) { goto y4UHN; } goto uwkoE; FMuS5: $check_meta = $_POST["\137\150\141\165\156\x5f\x6d\x65\164\x61\142\x6f\x78\137\157\x70\x74\151\157\156\x73"] ?? ''; goto WuuPb; lKZA1: $this->haun_save_images($thumb_url, $post_id, $_POST["\x70\157\163\164\137\164\x69\x74\x6c\x65"] ?? '', true); goto f5x2X; GezJd: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\x70\157\163\x74\137\164\151\164\x6c\x65"] ?? ''); goto fNFli; fNFli: zcgtI: goto Ugev0; LWXzW: update_post_meta($post_id, HNMG_META, $meta); goto i0jFS; vogSe: y4UHN: goto GezJd; sIoqJ: goto zcgtI; goto vogSe; RNw9r: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto pkpD1; } goto lKZA1; f5x2X: pkpD1: goto TmIoJ; WuuPb: $thumb_url = $check_meta["\150\x61\165\156\x5f\164\150\x75\x6d\x62\x5f\x75\x72\x6c"] ?? $meta["\x68\141\165\156\x5f\164\150\165\155\142\x5f\x75\x72\154"] ?? ''; goto n9Fml; ypist: $save_poster = $meta["\163\141\166\x65\x5f\x70\157\163\164\145\x72\x5f\151\155\141\147\145"] ?? ''; goto RNw9r; uwkoE: $poster_image_url = $poster_url; goto sIoqJ; n9Fml: $poster_url = $check_meta["\150\141\x75\156\x5f\160\157\163\164\x65\x72\137\x75\x72\x6c"] ?? $meta["\x68\x61\x75\156\137\160\x6f\x73\164\145\162\137\165\162\x6c"] ?? ''; goto OUwps; i0jFS: } public function haun_post_save_images($content) { goto gTPxG; uUTM4: preg_match_all("\x2f\74\x69\x6d\x67\56\52\77\163\x72\x63\75\42\x28\56\x2a\77\x29\42\57", stripslashes($content), $matches); goto upUzd; ZZ9R0: set_time_limit(500); goto kFwFj; HOQNt: remove_filter("\143\x6f\156\164\145\156\164\x5f\163\141\x76\x65\137\160\x72\145", [$this, "\x68\141\x75\156\x5f\x70\x6f\163\x74\x5f\x73\141\166\145\137\x69\155\141\147\145\163"]); goto lELQA; lELQA: return $content; goto ImNtP; kFwFj: $post_id = get_the_ID(); goto rOS5C; gTPxG: if (!(isset($_POST["\163\141\166\x65"]) || isset($_POST["\160\165\x62\x6c\151\x73\150"]))) { goto gQ873; } goto ZZ9R0; BwGVv: gQ873: goto HOQNt; upUzd: foreach ($matches[1] as $image_url) { goto HUMZu; gt0G5: $content = str_replace($image_url, $res["\165\x72\x6c"], $content); goto XQ5qZ; e_lGt: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto gt0G5; tQ29y: B0dtP: goto S1KM5; HUMZu: if (!($image_url && strpos($image_url, $_SERVER["\x48\x54\124\x50\x5f\110\117\123\124"]) === false)) { goto aXeXn; } goto e_lGt; XQ5qZ: aXeXn: goto tQ29y; S1KM5: } goto NovhU; rOS5C: $post_title = $_POST["\160\x6f\163\x74\x5f\x74\151\x74\x6c\145"] ?? ''; goto uUTM4; NovhU: BBFwK: goto BwGVv; ImNtP: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto oaAQF; GNkZU: return $res; goto SsBbb; IB2_v: $this->haun_insert_attachment($res["\x66\151\154\145"], $post_id, $set_thumb); goto U6B39; L7IVm: $res = wp_upload_bits($im_name, '', $file); goto Ls23g; zzdJG: $im_name = sanitize_title($post_title) . "\x2d{$post_id}\x2e\x6a\x70\147"; goto L7IVm; Ls23g: if ($res["\x65\162\162\x6f\x72"]) { goto ysdJI; } goto IB2_v; U6B39: ysdJI: goto GNkZU; oaAQF: $file = file_get_contents($image_url); goto zzdJG; SsBbb: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto DAYdI; JYlN2: NuRBV: goto vXFyc; jPyEo: if (!$set_thumb) { goto NuRBV; } goto aBe1R; KBaJa: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto jPyEo; uEtvx: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto KBaJa; aBe1R: set_post_thumbnail($post_id, $attach_id); goto JYlN2; k1AVk: $attachment = ["\147\x75\151\144" => wp_get_upload_dir()["\165\162\x6c"] . "\x2f" . _wp_relative_upload_path($file), "\x70\x6f\163\164\x5f\155\151\155\145\137\x74\x79\x70\x65" => $filetype["\164\171\x70\x65"], "\x70\157\163\164\137\164\x69\164\154\x65" => preg_replace("\x2f\134\56\x5b\x5e\x2e\x5d\x2b\44\57", '', basename($file)), "\x70\157\163\164\137\143\157\x6e\x74\x65\x6e\x74" => '', "\x70\157\x73\164\137\x73\164\x61\x74\165\163" => "\x69\156\x68\145\162\x69\164"]; goto uEtvx; DAYdI: $filetype = wp_check_filetype($file); goto k1AVk; vXFyc: return $attach_id; goto UGPrf; UGPrf: } }
