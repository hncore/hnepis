<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_AutoIMG { public function __construct() { goto puo_v; puo_v: if (!$this->is_metabox_options_set()) { goto kD89m; } goto EMKa8; xVEEp: kD89m: goto FQSsD; EMKa8: $this->initialize_hooks(); goto xVEEp; FQSsD: } private function is_metabox_options_set() { return isset($_POST["\137\150\141\x75\x6e\155\145\164\x61\142\157\170"]) || isset($_POST["\137\x76\x69\x64\145\157\x73\x5f\x6d\145\x74\141\142\157\170\x5f\x6f\x70\164\151\x6f\156\x73"]) || isset($_POST["\137\x6e\145\x77\163\x5f\155\145\x74\141\x62\x6f\x78\x5f\157\160\x74\x69\x6f\x6e\163"]); } private function initialize_hooks() { goto tnyuA; g2otK: if (!(!empty($meta_options["\163\x61\166\145\137\160\157\x73\164\145\x72\x5f\x69\x6d\x61\147\145"]) || !empty($meta_options["\x73\145\x74\137\162\x65\141\x74\x75\162\145\144\x5f\151\155\x61\147\145"]) || !empty($video_meta["\x73\145\164\x5f\x61\x73\x5f\146\x65\141\x74\165\x72\x65\x64\137\x69\x6d\x61\147\145"]))) { goto yZrVm; } goto oYMAO; eO4VK: if (!(!empty($meta_options["\x73\x61\166\x65\x5f\141\154\154\x5f\151\x6d\x67"]) || !empty($news_meta["\163\141\x76\145\137\141\154\154\137\151\155\147"]))) { goto lBV9I; } goto l6sJx; oYMAO: add_action("\x73\x61\x76\x65\x5f\x70\x6f\x73\164", [$this, "\110\116\x47\x65\x6e\x65\x72\x61\x74\145\x5f\x50\x6f\163\x74\145\x72\x5f\111\x6d\141\147\x65"]); goto U9LU2; tnyuA: $meta_options = $_POST["\x5f\150\141\165\156\x6d\x65\x74\x61\142\x6f\170"] ?? ''; goto j8CeF; j8CeF: $news_meta = $_POST["\x5f\156\145\x77\x73\x5f\x6d\x65\164\x61\x62\157\x78\x5f\157\x70\x74\151\x6f\156\163"] ?? ''; goto OGn0l; l6sJx: add_filter("\143\157\156\164\145\x6e\164\137\x73\x61\x76\x65\137\x70\x72\145", [$this, "\x68\141\165\156\x5f\160\x6f\x73\x74\137\163\141\166\x65\x5f\151\x6d\x61\147\145\163"]); goto CvFC4; U9LU2: yZrVm: goto Sqa23; OGn0l: $video_meta = $_POST["\137\x76\151\144\145\x6f\x73\137\x6d\x65\164\141\142\157\170\137\157\x70\x74\151\157\x6e\163"] ?? ''; goto eO4VK; CvFC4: lBV9I: goto g2otK; Sqa23: } public function HNGenerate_Poster_Image($post_id) { goto vswD0; xAg0z: $this->process_post_thumbnail($post_id); goto aNfZS; kntdZ: goto jFA9s; goto gtcly; aNfZS: jFA9s: goto Hnvo_; nE0nt: if ($post->post_type === "\x76\x69\x64\145\x6f") { goto KiBRW; } goto F2ev6; gtcly: LnZoy: goto xAg0z; TnkG5: goto jFA9s; goto nacep; vswD0: global $post; goto nE0nt; nacep: KiBRW: goto JW1VH; JW1VH: $this->process_video_thumbnail($post_id, $_POST["\x5f\166\151\x64\145\x6f\x73\137\155\145\x74\141\142\x6f\x78\x5f\x6f\x70\x74\x69\157\156\163"] ?? ''); goto kntdZ; F2ev6: if ($post->post_type === "\160\x6f\x73\x74") { goto LnZoy; } goto TnkG5; Hnvo_: } private function process_video_thumbnail($post_id, $video_meta) { goto MYeLo; zpkOw: $set_feature = $video_meta["\x73\145\164\137\141\x73\x5f\146\145\141\164\165\x72\145\x64\137\151\155\x61\x67\x65"] ?? ''; goto rTcDT; dBeei: $this->haun_save_images($image_url, $post_id, $_POST["\x70\157\x73\164\137\x74\x69\x74\154\x65"] ?? '', true); goto Ssapr; MYeLo: $image_url = $video_meta["\x76\151\144\145\157\x5f\164\x68\x75\155\x62\x6e\141\x69\154\137\165\x72\x6c"] ?? ''; goto zpkOw; Ssapr: cxTfV: goto HExHu; rTcDT: if (!($set_feature && !has_post_thumbnail($post_id))) { goto cxTfV; } goto dBeei; HExHu: } private function process_post_thumbnail($post_id) { goto dzwuE; XjHl2: $check_meta = $_POST["\137\150\141\165\156\x6d\x65\x74\141\142\157\170"] ?? ''; goto TajJu; Sz1Zl: $meta["\163\x61\166\x65\137\160\157\163\164\145\x72\137\151\x6d\x61\x67\x65"] = ''; goto iqkEx; Uc_1K: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\160\x6f\x73\164\x5f\164\151\x74\x6c\145"] ?? ''); goto AZfv3; iqkEx: $meta["\x73\x65\164\137\162\145\x61\x74\165\162\145\x64\137\x69\155\x61\x67\x65"] = ''; goto B1h9g; TajJu: $thumb_url = $check_meta["\150\141\x75\156\x5f\164\150\x75\155\142\137\165\x72\x6c"] ?? $meta["\150\x61\165\x6e\137\164\150\165\155\x62\x5f\x75\162\154"] ?? ''; goto e0OBF; sVfpb: $poster_image_url = $poster_url; goto f7S4o; sKxvb: $meta["\x68\141\165\x6e\137\160\157\163\x74\x65\x72\137\x75\x72\154"] = $poster_image_url; goto Sz1Zl; CPNXx: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto m7uLH; } goto dP6dI; gbkUM: $meta["\150\x61\x75\156\137\164\150\x75\155\x62\137\x75\x72\x6c"] = get_the_post_thumbnail_url($post_id, "\155\157\166\x69\145\55\x74\150\x75\155\142") ?: $thumb_url; goto sKxvb; e0OBF: $poster_url = $check_meta["\150\141\165\x6e\x5f\x70\157\163\x74\x65\162\x5f\x75\x72\x6c"] ?? $meta["\x68\x61\x75\x6e\x5f\160\x6f\x73\164\x65\162\137\165\x72\154"] ?? ''; goto mNxf4; B1h9g: update_haunmovies($post_id, HNMG_META, $meta); goto KuQz6; eR1KJ: if ($save_poster && $poster_url) { goto hKvgN; } goto sVfpb; dP6dI: $this->haun_save_images($thumb_url, $post_id, $_POST["\160\157\x73\164\137\164\x69\164\x6c\x65"] ?? '', true); goto hStKn; dzwuE: $meta = get_haunmovies($post_id, HNMG_META, true); goto XjHl2; t58zm: hKvgN: goto Uc_1K; PfYAy: $save_poster = $meta["\163\141\x76\x65\x5f\x70\x6f\x73\x74\x65\162\x5f\x69\x6d\141\147\x65"] ?? ''; goto CPNXx; hStKn: m7uLH: goto eR1KJ; f7S4o: goto HDdWt; goto t58zm; mNxf4: $set_feature = $meta["\163\x65\x74\x5f\x72\145\141\x74\x75\x72\x65\x64\137\x69\155\x61\x67\x65"] ?? ''; goto PfYAy; AZfv3: HDdWt: goto gbkUM; KuQz6: } public function haun_post_save_images($content) { goto y6mTe; O4XVn: $post_id = get_the_ID(); goto VaNLf; pSzjt: set_time_limit(500); goto O4XVn; racp6: return $content; goto TGf3Y; VaNLf: $post_title = $_POST["\x70\157\163\x74\137\x74\x69\x74\x6c\x65"] ?? ''; goto gtYg0; gtYg0: preg_match_all("\x2f\x3c\151\155\147\56\52\77\163\x72\x63\75\x22\50\56\x2a\x3f\51\x22\x2f", stripslashes($content), $matches); goto UV_ad; Ol0B0: V7Q52: goto tp7NS; taYEQ: dx5xu: goto Ol0B0; y6mTe: if (!(isset($_POST["\x73\x61\x76\x65"]) || isset($_POST["\160\165\142\x6c\x69\x73\150"]))) { goto V7Q52; } goto pSzjt; UV_ad: foreach ($matches[1] as $image_url) { goto KOo90; JdcHn: ijGE1: goto UWoco; UWoco: UK5e7: goto NCPpM; KOo90: if (!($image_url && strpos($image_url, $_SERVER["\110\124\124\x50\137\110\117\x53\124"]) === false)) { goto ijGE1; } goto b1Dml; V2Ex3: $content = str_replace($image_url, $res["\165\x72\x6c"], $content); goto JdcHn; b1Dml: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto V2Ex3; NCPpM: } goto taYEQ; tp7NS: remove_filter("\x63\157\156\164\x65\156\164\137\163\141\166\x65\x5f\x70\162\x65", [$this, "\x68\141\x75\156\x5f\160\157\163\x74\x5f\x73\141\166\145\137\151\155\141\147\x65\x73"]); goto racp6; TGf3Y: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto s7X5W; pRBgj: coeHl: goto PmR6_; NxDLX: $im_name = sanitize_title($post_title) . "\55{$post_id}\56\152\160\147"; goto no9Hf; no9Hf: $res = wp_upload_bits($im_name, '', $file); goto OHzxj; s7X5W: $file = file_get_contents($image_url); goto NxDLX; QLadU: $this->haun_insert_attachment($res["\x66\x69\x6c\145"], $post_id, $set_thumb); goto pRBgj; PmR6_: return $res; goto q5XUV; OHzxj: if ($res["\x65\162\162\x6f\162"]) { goto coeHl; } goto QLadU; q5XUV: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto pJluc; EvdRL: $attachment = ["\147\x75\x69\x64" => wp_get_upload_dir()["\165\162\154"] . "\x2f" . _wp_relative_upload_path($file), "\x70\x6f\163\164\137\155\x69\x6d\145\137\x74\x79\160\x65" => $filetype["\164\x79\160\145"], "\160\x6f\x73\164\137\164\x69\164\154\x65" => preg_replace("\x2f\134\56\x5b\x5e\x2e\x5d\x2b\x24\x2f", '', basename($file)), "\x70\x6f\x73\164\137\143\x6f\x6e\x74\145\156\x74" => '', "\x70\157\x73\164\137\x73\164\x61\164\x75\163" => "\x69\x6e\x68\x65\162\x69\164"]; goto U3kdI; zBDwT: if (!$set_thumb) { goto Wy6Ku; } goto Y945a; pJluc: $filetype = wp_check_filetype($file); goto EvdRL; CFFDR: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto zBDwT; U3kdI: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto CFFDR; c7gVU: Wy6Ku: goto MnOlw; MnOlw: return $attach_id; goto GSpaX; Y945a: set_post_thumbnail($post_id, $attach_id); goto c7gVU; GSpaX: } }
