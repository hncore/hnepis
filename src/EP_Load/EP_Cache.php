<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Load; class EP_Cache { public $timeCache; public $folderCache; public function __construct() { goto nnQhD; xyVf3: t4EPe: goto C3rO8; C3rO8: $this->timeCache = 3600; goto bfrv0; fltN2: global $wp_filesystem; goto EtXDS; bfrv0: if (!function_exists("\x57\120\137\x46\151\x6c\145\163\171\163\x74\145\x6d")) { require_once ABSPATH . "\167\160\55\141\144\155\x69\x6e\57\151\156\x63\x6c\165\144\x65\x73\x2f\146\151\x6c\x65\x2e\x70\x68\x70"; } goto fltN2; EtXDS: WP_Filesystem(); goto y_6qj; H2Q2d: if (is_dir($this->folderCache)) { goto t4EPe; } goto PQ0ib; nnQhD: $this->folderCache = HNMG_CACHE; goto H2Q2d; y_6qj: $this->wp_filesystem = $wp_filesystem; goto S2JNH; PQ0ib: wp_mkdir_p($this->folderCache); goto xyVf3; S2JNH: } public function register() { goto T0d6v; T0d6v: add_action("\167\x70\137\x61\x6a\x61\170\137\x72\145\x73\145\x74\x5f\160\154\x61\171\145\162\137\x63\x61\x63\x68\145", [$this, "\x72\x65\x73\x65\x74\137\160\x6c\141\x79\x65\x72\137\143\141\143\150\x65"]); goto pjI56; hZWif: add_filter("\110\116\x4d\x47\x2d\164\141\x62\x73", [$this, "\x68\156\x61\160\x69\x73\157\x64\145\137\143\x61\x63\x68\145\x5f\155\145\156\165"]); goto eBaPn; VSgVK: add_action("\167\x70\x5f\141\152\x61\x78\137\156\x6f\160\162\151\x76\x5f\144\145\154\x65\x74\145\137\x61\154\x6c\137\x63\x61\143\x68\x65", [$this, "\x64\145\x6c\x65\164\x65\x5f\141\154\154\137\143\x61\x63\x68\x65"]); goto y_p69; eBaPn: add_filter("\x48\x4e\115\x47\x2d\160\x61\x67\x65\163", [$this, "\150\x6e\141\160\151\163\x6f\x64\145\x5f\x63\141\x63\150\x65\x5f\155\x65\x6e\x75"]); goto EFFfy; EFFfy: add_action("\x77\x70\137\x61\152\x61\x78\x5f\144\x65\x6c\x65\164\145\137\141\154\154\x5f\x63\141\x63\x68\x65", [$this, "\x64\145\154\x65\x74\145\x5f\x61\154\x6c\137\x63\x61\143\x68\145"]); goto VSgVK; pjI56: add_action("\x77\160\x5f\141\x6a\141\170\x5f\156\x6f\160\162\151\166\137\x72\x65\163\145\164\x5f\160\154\x61\171\145\x72\x5f\x63\141\143\150\145", [$this, "\x72\x65\163\145\x74\x5f\160\154\141\x79\145\x72\x5f\143\x61\x63\150\145"]); goto hZWif; y_p69: } public function hnapisode_cache_menu($nav) { $nav["\x31\x32\x30"] = array("\163\154\x75\147" => "\150\x6e\155\x67\55\x63\x61\x63\x68\145\x2d\x6d\141\156\141\147\145\x72", "\143\141\154\154\x62\141\143\153" => array($this, "\x68\x6e\x6d\147\x5f\143\x61\x63\150\x65\137\155\141\156\141\147\145\137\160\x61\147\x65"), "\x74\x69\164\x6c\x65" => "\x48\x4e\115\107\x20\x43\x61\x63\150\x65", "\151\x63\x6f\156" => "\x66\141\55\160\154\141\x79\55\143\151\x72\x63\x6c\x65"); return $nav; } public function hnmg_cache_manage_page() { goto jpQdU; q14Pu: $get_cache = json_decode($this->getCache()); goto d196U; jpQdU: $cache_count = json_decode($this->cacheCount()); goto q14Pu; d196U: echo view("\110\x4e\x4d\x47\x3a\x3a\154\141\171\x6f\165\164\163\56\x63\141\x63\150\x65", compact("\143\141\x63\x68\x65\137\143\157\x75\156\x74", "\147\x65\x74\x5f\143\x61\x63\x68\x65")); goto lcVJC; lcVJC: } public function delete_all_cache() { goto QsUqj; IHH5X: wp_send_json_success(["\163\x74\x61\164\x75\163" => $status, "\164\157\164\141\154\137\x63\x61\143\x68\x65" => $total_cache, "\x74\151\x6d\145\x5f\154\x69\x6d\x69\x74" => $time_limit, "\x63\x61\x63\150\x65\x5f\x64\145\x6c\x65\x74\x65\144" => $cache_deleted]); goto HRbzP; SDfgH: $status = "\x53\165\x63\143\145\x73\x73\146\x75\x6c\x6c\x79"; goto zZVKO; HRbzP: wp_die(); goto sSmLM; JmQ0O: $cache_deleted = $result["\143\141\143\x68\145\x5f\x64\x65\154\x65\164\145\x64"] ?? 0; goto IHH5X; riYiy: $time_limit = $result["\164\x69\155\145\x5f\x6c\151\155\151\x74"] ?? 0; goto JmQ0O; QsUqj: $result = json_decode($this->delAllCache(0), true); goto SDfgH; zZVKO: $total_cache = $result["\x74\157\x74\141\154\x5f\143\x61\x63\150\145"] ?? 0; goto riYiy; sSmLM: } public function delAllCache($timeCache) { goto QUBDw; aI4uA: $getDirContents = $this->getDirContents($this->folderCache); goto pmutD; QUBDw: $result = array("\x73\x74\x61\164\x75\163" => 0, "\x74\x6f\x74\141\x6c\137\x63\141\143\150\145" => 0, "\164\151\155\145\137\154\151\x6d\x69\164" => $timeCache, "\143\x61\x63\x68\x65\137\x64\x65\154\145\x74\145\x64" => 0, "\143\x61\x63\x68\x65\x5f\143\157\165\x6e\164" => 0); goto aI4uA; CYSXJ: $result["\143\141\x63\150\x65\x5f\143\x6f\x75\156\x74"] = $i - $j; goto OQnhx; SZlz1: $result["\x63\141\143\150\145\137\144\145\154\145\164\145\144"] = $j; goto CYSXJ; X1NBg: $result["\164\x6f\164\141\x6c\137\143\141\x63\x68\x65"] = $i; goto SZlz1; OQnhx: kHNJL: goto hxDeG; YmMhL: iH7JA: goto X1NBg; pmutD: if (!$getDirContents) { goto kHNJL; } goto EuvTw; HpEe8: return json_encode($result); goto ET7j9; hxDeG: $this->removeEmptySubFolders($this->folderCache); goto HpEe8; v9WBY: foreach ($getDirContents as $key => $value) { goto f2a5E; BQWHp: $i++; goto SrsPU; G5AkD: x9_tF: goto b5gxC; SrsPU: if (!($timeCache <= time() - filemtime($value))) { goto tcFri; } goto KPMC4; f2a5E: if (!(strpos($value, "\x2e\164\170\x74") !== false)) { goto jjnjl; } goto BQWHp; kmXbB: sAFup: goto Puyrf; a3Tp2: jjnjl: goto kmXbB; T2WzG: $result["\163\x74\141\164\x75\163"] = 1; goto G5AkD; XQbMj: if (!unlink($value)) { goto x9_tF; } goto T2WzG; b5gxC: tcFri: goto a3Tp2; KPMC4: $j++; goto XQbMj; Puyrf: } goto YmMhL; EuvTw: $i = $j = 0; goto v9WBY; ET7j9: } public function reset_player_cache() { goto K1F_G; J82Hx: $episode_slug = isset($_POST["\145\160\151\163\157\144\x65\137\x73\154\x75\x67"]) ? str_replace("\x2d", "\x5f", wp_strip_all_tags($_POST["\x65\x70\x69\x73\x6f\144\145\x5f\x73\x6c\165\147"])) : ''; goto oAqqc; tNNXk: $cacheData = $this->delCache($link); goto ggmWX; K1F_G: $server = isset($_POST["\163\x65\x72\x76\145\x72\137\x69\x64"]) ? (int) $_POST["\x73\145\162\x76\145\x72\x5f\x69\x64"] : ''; goto i_ta6; oAqqc: $film_meta = get_post_meta($post_id, HNMG_EPS, true); goto XXqaB; i_ta6: $post_id = isset($_POST["\160\x6f\x73\164\137\x69\144"]) ? (int) $_POST["\x70\x6f\163\x74\137\151\x64"] : ''; goto J82Hx; XXqaB: $data = json_decode($film_meta, true); goto w95n3; ggmWX: wp_send_json($cacheData); goto WzjY4; w95n3: $link = $data[$server - 1]["\x68\x61\x75\x6e\155\157\x76\x69\145\x73\137\163\x65\162\x76\x65\x72\137\144\x61\x74\141"][$episode_slug]["\150\141\x75\156\155\157\166\x69\145\163\x5f\145\160\x5f\x6c\x69\x6e\x6b"]; goto tNNXk; WzjY4: } public function readCache($name) { goto k0XnD; x214P: $result = ''; goto A2PIn; DiK5U: goto uQDoj; goto td713; J8HvO: if (!file_exists($file)) { goto vB0q1; } goto FJTeE; FJTeE: if ($this->timeCache != '') { goto VGjSr; } goto zHBj5; A2PIn: $createFolderCache = $this->createFolderCache($name); goto Tmpuj; uphs2: vB0q1: goto UgWIk; JRHNY: uQDoj: goto uphs2; k0XnD: $name = md5(md5($name)); goto x214P; KCqY6: if (!($this->timeCache > time() - filemtime($file))) { goto ASAcK; } goto vn_HN; UgWIk: return $result; goto t81mA; zHBj5: $result = file_get_contents($file); goto DiK5U; WLws4: ASAcK: goto JRHNY; vn_HN: $result = file_get_contents($file); goto WLws4; td713: VGjSr: goto KCqY6; Tmpuj: $file = $this->folderCache . "\57" . $createFolderCache . "\x2f" . $name . "\56\164\x78\x74"; goto J8HvO; t81mA: } public function getCache() { goto dptHH; wTu2H: YAHHy: goto u373g; BlK22: foreach ($getDirContents as $key => $value) { goto fAN2A; fAN2A: if (!strpos($value, "\56\164\170\164")) { goto ZY0jf; } goto HqEiO; HqEiO: $result[] = array("\x66\x69\154\145" => $value); goto EffK7; fenGw: L3Eh4: goto sM330; EffK7: ZY0jf: goto fenGw; sM330: } goto HeG2q; dptHH: $result = array(); goto ekpK5; eQQcl: $i = 0; goto k6D1p; ekpK5: $getDirContents = $this->getDirContents($this->folderCache); goto eQQcl; HeG2q: CqooB: goto wunYu; k6D1p: if (!$getDirContents) { goto YAHHy; } goto BlK22; wunYu: return json_encode($result); goto wTu2H; u373g: } public function saveCache($name, $data) { goto pCm9j; Z7xdI: $dir = $this->folderCache . "\x2f" . $createFolderCache; goto auFFV; b1PPp: mkdir($this->folderCache, 0777, true); goto PT9x_; c80xE: $this->wp_filesystem->put_contents($index_file, "\x3c\77\x70\150\160\40\x2f\x2f\40\123\x69\x6c\145\x6e\143\145\40\x69\x73\40\x67\x6f\x6c\144\145\x6e\x2e", FS_CHMOD_FILE); goto xRvw1; yvMaA: if (is_dir($this->folderCache)) { goto vmWyR; } goto b1PPp; HzvoZ: chmod($this->folderCache, 0777); goto vRkmh; NjaTU: THuB5: goto XZAo0; pCm9j: $name = md5(md5($name)); goto FWsGg; brBF8: $index_file = WP_CONTENT_DIR . "\57\x69\156\x64\x65\170\x2e\x70\150\x70"; goto c80xE; auFFV: $file = $dir . "\57" . $name . "\x2e\x74\170\x74"; goto jo9nL; mMOiL: mkdir($dir, 0777, true); goto NjaTU; FWsGg: $createFolderCache = $this->createFolderCache($name); goto yvMaA; RljNq: if (chmod($this->folderCache, 0777)) { goto oj3e5; } goto HzvoZ; PT9x_: vmWyR: goto RljNq; XZAo0: $this->wp_filesystem->put_contents($file, $data, FS_CHMOD_FILE); goto brBF8; vRkmh: oj3e5: goto Z7xdI; jo9nL: if (is_dir($dir)) { goto THuB5; } goto mMOiL; xRvw1: } public function delCache($name) { goto gosyz; Kp7qW: E12Z9: goto cjYsN; qDDQ9: $file = $this->folderCache . "\x2f" . $createFolderCache . "\57" . $name . "\x2e\164\x78\164"; goto d5MvW; gosyz: $result = ''; goto IJ4IG; H6Qul: if (unlink($file)) { goto E12Z9; } goto Y0vMe; d9jtC: BQe_c: goto RtBFs; rdIqJ: goto BQe_c; goto Kp7qW; RBzyc: $result = array("\163\164\141\x74\165\x73" => 0, "\x72\145\163\165\x6c\x74" => "\114\x69\x6e\153\40\156\157\164\40\x65\170\151\x73\164\x73"); goto auDRW; RtBFs: gUFr0: goto J8AE8; IJ4IG: $name = md5(md5($name)); goto tk2mi; auDRW: goto gUFr0; goto Ul3vQ; d5MvW: if (file_exists($file)) { goto OytrZ; } goto RBzyc; cjYsN: $result = array("\163\164\141\x74\x75\x73" => 1, "\162\145\163\x75\x6c\164" => "\104\145\154\x65\164\145\144"); goto d9jtC; Ul3vQ: OytrZ: goto H6Qul; tk2mi: $createFolderCache = $this->createFolderCache($name); goto qDDQ9; J8AE8: return $result; goto jyu0j; Y0vMe: $result = array("\163\x74\x61\x74\165\x73" => 0, "\x72\x65\163\x75\154\x74" => "\x44\145\154\145\x74\x65\40\x65\x72\x72\157\x72"); goto rdIqJ; jyu0j: } public function cacheCount() { goto V1bd6; k_Ehu: foreach ($getDirContents as $key => $value) { goto NNaIG; qSzlv: PnTiQ: goto EIzzb; XX9bz: $result["\x72\x65\163\x75\x6c\164"] = 1; goto fvAyF; NNaIG: if (!strpos($value, "\56\164\x78\x74")) { goto PnTiQ; } goto XX9bz; fvAyF: $result["\x74\157\x74\141\x6c\137\143\141\x63\x68\145"] = $i; goto BS94R; BS94R: $i++; goto qSzlv; EIzzb: nDcEl: goto QjnLi; QjnLi: } goto PaamK; l27Vn: return json_encode($result); goto ibJIq; V1bd6: $result = array(); goto nl44K; nl44K: $getDirContents = $this->getDirContents($this->folderCache); goto IdYCY; eMW0m: if (!$getDirContents) { goto KfJlT; } goto k_Ehu; VprxZ: KfJlT: goto l27Vn; PaamK: bNsga: goto VprxZ; IdYCY: $i = 1; goto eMW0m; ibJIq: } private function createFolderCache($name) { goto upcRQ; DTsqU: $folder2 = substr($name, 2, 2); goto vN2Rl; upcRQ: $folder1 = substr($name, 0, 2); goto DTsqU; vN2Rl: return $folder1 . "\57" . $folder2; goto Zd5Vo; Zd5Vo: } private function getDirContents($dir, &$results = array()) { goto pz7Oe; Sy19t: return $results; goto Ea5k1; jAEUD: em3KX: goto Sy19t; pHWNW: foreach ($files as $key => $value) { goto anrhj; ad7hI: $results[] = $path; goto rMd4e; lIip6: if (!is_dir($path)) { goto MHYPh; } goto uPEyA; uPEyA: if (!($value != "\56" && $value != "\x2e\x2e")) { goto h2vvc; } goto MTWr3; anrhj: $path = realpath($dir . DIRECTORY_SEPARATOR . $value); goto lIip6; kBFAj: UM3KK: goto kg1tV; FwJg0: MHYPh: goto eYbHJ; kg1tV: SwDrz: goto L74wR; VLd1y: goto UM3KK; goto FwJg0; eYbHJ: $results[] = $path; goto kBFAj; rMd4e: h2vvc: goto VLd1y; MTWr3: $this->getDirContents($path, $results); goto ad7hI; L74wR: } goto jAEUD; pz7Oe: $files = scandir($dir); goto pHWNW; Ea5k1: } private function removeEmptySubFolders($path) { goto zgjGL; N9tz2: RJrtm: goto LR_Cp; LR_Cp: return $empty && @rmdir($path); goto jg8n2; zgjGL: $empty = true; goto PIIcW; PIIcW: foreach (glob($path . DIRECTORY_SEPARATOR . "\52") as $file) { $empty &= is_dir($file) && $this->removeEmptySubFolders($file); y65Jj: } goto N9tz2; jg8n2: } }
