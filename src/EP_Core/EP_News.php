<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_News { public function __construct() { goto c8dMx; MD5c9: vT1hK: goto qEab1; AxMdn: $this->initialize_hooks(); goto MD5c9; c8dMx: if (!$this->is_metabox_options_set()) { goto vT1hK; } goto AxMdn; qEab1: } private function is_metabox_options_set() { return isset($_POST["\137\x68\x61\165\156\x5f\x6d\x65\x74\x61\x62\x6f\170\x5f\157\x70\x74\x69\x6f\x6e\x73"]) || isset($_POST["\x5f\x76\x69\144\145\157\163\x5f\155\x65\164\141\142\157\170\x5f\157\x70\x74\x69\x6f\156\x73"]) || isset($_POST["\x5f\156\145\x77\x73\137\155\145\x74\141\142\157\x78\137\157\x70\x74\151\157\156\163"]); } private function initialize_hooks() { goto z4HQj; YxVey: DImlu: goto iU204; LFcSC: p6C8e: goto OBpS6; z4HQj: $meta_options = $_POST["\x5f\x68\141\165\156\137\x6d\x65\164\x61\x62\157\x78\137\x6f\160\164\x69\157\156\x73"] ?? ''; goto tosca; xQttd: if (!(!empty($meta_options["\163\x61\166\x65\x5f\x61\154\154\137\x69\155\147"]) || !empty($news_meta["\163\x61\x76\x65\137\x61\x6c\154\137\x69\x6d\x67"]))) { goto DImlu; } goto hde1C; pZoAT: add_action("\163\x61\166\145\137\160\157\163\x74", [$this, "\x48\x4e\x47\145\156\x65\162\x61\x74\x65\137\120\157\163\164\145\x72\x5f\x49\x6d\x61\147\145"]); goto LFcSC; iU204: if (!(!empty($meta_options["\x73\141\x76\x65\137\160\x6f\163\164\145\162\137\151\x6d\141\147\x65"]) || !empty($meta_options["\163\x65\x74\137\162\x65\141\x74\165\162\145\x64\137\151\155\x61\x67\145"]) || !empty($video_meta["\x73\145\164\137\x61\x73\137\x66\x65\141\x74\165\162\145\144\x5f\x69\x6d\141\147\145"]))) { goto p6C8e; } goto pZoAT; hde1C: add_filter("\143\x6f\156\x74\x65\x6e\x74\137\x73\141\x76\x65\137\160\162\x65", [$this, "\x68\141\x75\156\x5f\x70\x6f\163\164\137\x73\141\x76\x65\137\x69\x6d\141\147\x65\x73"]); goto YxVey; tosca: $news_meta = $_POST["\x5f\156\145\167\x73\x5f\x6d\x65\164\141\x62\x6f\170\x5f\x6f\160\x74\151\x6f\156\163"] ?? ''; goto uoZsH; uoZsH: $video_meta = $_POST["\x5f\166\151\x64\x65\157\x73\137\x6d\x65\164\141\142\157\x78\137\x6f\160\x74\x69\x6f\x6e\163"] ?? ''; goto xQttd; OBpS6: } public function HNGenerate_Poster_Image($post_id) { goto kbdEm; OBUzK: $this->process_video_thumbnail($post_id, $_POST["\137\x76\x69\144\145\x6f\163\137\x6d\145\x74\x61\142\157\x78\x5f\x6f\x70\x74\x69\x6f\x6e\x73"] ?? ''); goto oL6o4; AKBqc: Wjdow: goto OBUzK; WyNZE: zJYxZ: goto qVmAy; thSds: if ($post->post_type === "\x76\x69\144\145\157") { goto Wjdow; } goto bNWCo; kbdEm: global $post; goto thSds; sX2Sx: ygp11: goto LTCyM; LTCyM: $this->process_post_thumbnail($post_id); goto WyNZE; oL6o4: goto zJYxZ; goto sX2Sx; bNWCo: if ($post->post_type === "\x70\157\x73\x74") { goto ygp11; } goto C6K08; C6K08: goto zJYxZ; goto AKBqc; qVmAy: } private function process_video_thumbnail($post_id, $video_meta) { goto GfUYM; GfUYM: $image_url = $video_meta["\166\x69\144\145\x6f\x5f\x74\x68\165\155\142\156\141\x69\154\137\x75\x72\x6c"] ?? ''; goto VQ_yo; q4vF1: if (!($set_feature && !has_post_thumbnail($post_id))) { goto rAmZd; } goto ubFZv; M7JK2: rAmZd: goto p5C31; ubFZv: $this->haun_save_images($image_url, $post_id, $_POST["\160\x6f\x73\164\137\164\151\164\154\x65"] ?? '', true); goto M7JK2; VQ_yo: $set_feature = $video_meta["\163\145\x74\137\x61\163\x5f\146\x65\141\x74\x75\162\145\x64\137\151\155\x61\147\145"] ?? ''; goto q4vF1; p5C31: } private function process_post_thumbnail($post_id) { goto ofPLF; x9ouN: if ($save_poster && $poster_url) { goto lZOR8; } goto NHwj1; L0VIM: $poster_url = $check_meta["\150\141\x75\156\x5f\160\x6f\163\x74\145\162\x5f\165\162\154"] ?? $meta["\x68\141\165\x6e\x5f\x70\157\x73\x74\145\x72\137\165\x72\x6c"] ?? ''; goto n0Qm2; HwCZT: $thumb_url = $check_meta["\x68\x61\x75\156\x5f\x74\150\165\x6d\142\x5f\x75\x72\x6c"] ?? $meta["\150\x61\x75\x6e\137\x74\x68\165\155\x62\137\165\x72\x6c"] ?? ''; goto L0VIM; gzMyW: $this->haun_save_images($thumb_url, $post_id, $_POST["\160\157\163\x74\137\x74\151\164\x6c\145"] ?? '', true); goto W1Tyg; Gl2EK: $save_poster = $meta["\x73\141\x76\x65\x5f\x70\157\163\x74\145\x72\137\x69\155\x61\x67\145"] ?? ''; goto MrFbb; MJrod: update_post_meta($post_id, HNMG_META, $meta); goto M0dMu; mhNzn: $check_meta = $_POST["\137\150\141\x75\x6e\137\x6d\x65\164\x61\x62\157\x78\x5f\157\160\x74\151\x6f\x6e\163"] ?? ''; goto HwCZT; Jai67: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\160\x6f\163\x74\137\164\151\164\x6c\x65"] ?? ''); goto J13WR; B_5NK: $meta["\150\x61\x75\156\137\164\150\165\155\142\x5f\165\x72\154"] = get_the_post_thumbnail_url($post_id, "\155\157\166\151\x65\x2d\164\150\x75\155\142") ?: $thumb_url; goto LCIK9; CCKhB: $meta["\x73\x61\166\x65\137\x70\x6f\163\164\145\x72\x5f\151\155\141\x67\145"] = ''; goto Hro1n; NHwj1: $poster_image_url = $poster_url; goto h5IMP; ofPLF: $meta = get_post_meta($post_id, HNMG_META, true); goto mhNzn; h5IMP: goto qx03t; goto hNqXS; J13WR: qx03t: goto B_5NK; n0Qm2: $set_feature = $meta["\x73\145\164\137\162\145\141\x74\165\x72\x65\144\137\151\155\141\147\145"] ?? ''; goto Gl2EK; hNqXS: lZOR8: goto Jai67; W1Tyg: lF7Oc: goto x9ouN; Hro1n: $meta["\x73\x65\x74\x5f\x72\145\141\164\165\x72\145\x64\x5f\151\155\x61\147\145"] = ''; goto MJrod; MrFbb: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto lF7Oc; } goto gzMyW; LCIK9: $meta["\x68\x61\x75\x6e\x5f\x70\x6f\x73\x74\145\162\x5f\165\162\x6c"] = $poster_image_url; goto CCKhB; M0dMu: } public function haun_post_save_images($content) { goto I03fs; vB_RM: $post_title = $_POST["\x70\x6f\x73\164\x5f\x74\x69\x74\154\x65"] ?? ''; goto WQlWw; v_20A: $post_id = get_the_ID(); goto vB_RM; qFfHu: return $content; goto q5nD2; I03fs: if (!(isset($_POST["\x73\x61\x76\145"]) || isset($_POST["\160\165\x62\154\151\x73\x68"]))) { goto RbTb9; } goto HpeLd; WQlWw: preg_match_all("\57\74\151\155\147\56\x2a\77\x73\162\x63\75\42\x28\56\x2a\x3f\51\42\57", stripslashes($content), $matches); goto snZqo; DOPQy: remove_filter("\143\157\156\x74\x65\x6e\x74\137\x73\x61\166\145\x5f\160\x72\145", [$this, "\150\x61\x75\x6e\x5f\160\x6f\x73\164\x5f\x73\x61\166\145\x5f\151\155\x61\147\x65\163"]); goto qFfHu; BzgKx: BuEf2: goto N_cRa; N_cRa: RbTb9: goto DOPQy; HpeLd: set_time_limit(500); goto v_20A; snZqo: foreach ($matches[1] as $image_url) { goto zHqXS; M4nkG: $content = str_replace($image_url, $res["\x75\x72\x6c"], $content); goto BWe_K; zHqXS: if (!($image_url && strpos($image_url, $_SERVER["\110\124\x54\120\x5f\110\117\123\124"]) === false)) { goto ZOjKV; } goto X9ilR; X9ilR: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto M4nkG; t84Ag: hjmHc: goto jkJIO; BWe_K: ZOjKV: goto t84Ag; jkJIO: } goto BzgKx; q5nD2: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto Kukpj; ZkXi1: if ($res["\145\x72\x72\x6f\162"]) { goto FR_ZM; } goto nqNv7; Kukpj: $file = file_get_contents($image_url); goto qrR0d; wWGPa: return $res; goto Op90s; BE2Wn: FR_ZM: goto wWGPa; nqNv7: $this->haun_insert_attachment($res["\x66\x69\x6c\x65"], $post_id, $set_thumb); goto BE2Wn; qrR0d: $im_name = sanitize_title($post_title) . "\x2d{$post_id}\56\152\160\x67"; goto DyLGS; DyLGS: $res = wp_upload_bits($im_name, '', $file); goto ZkXi1; Op90s: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto DOMk4; TIbE4: $attachment = ["\147\165\x69\x64" => wp_get_upload_dir()["\x75\162\154"] . "\57" . _wp_relative_upload_path($file), "\x70\x6f\x73\x74\x5f\155\x69\x6d\145\x5f\164\171\160\145" => $filetype["\164\x79\x70\x65"], "\x70\157\x73\x74\x5f\164\x69\164\154\145" => preg_replace("\57\134\x2e\133\x5e\x2e\135\53\44\x2f", '', basename($file)), "\x70\x6f\163\164\137\143\157\156\x74\x65\x6e\x74" => '', "\x70\157\x73\164\137\163\164\141\x74\165\163" => "\x69\156\150\145\x72\x69\164"]; goto I3IBi; Tlcy9: if (!$set_thumb) { goto THGOQ; } goto TAj5C; Zpq_P: return $attach_id; goto z_KNt; DOMk4: $filetype = wp_check_filetype($file); goto TIbE4; cpQyw: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto Tlcy9; I3IBi: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto cpQyw; TAj5C: set_post_thumbnail($post_id, $attach_id); goto QVAWF; QVAWF: THGOQ: goto Zpq_P; z_KNt: } }
