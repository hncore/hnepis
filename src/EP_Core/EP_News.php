<?php
/*   __________________________________________________
    |  		Code By HauN - HauNYTB.COM  2.0.14    	  |
    |          Telegram: https://t.me/haunytb         |
    |    	   Url : https://haunytb.com    		  |
    |_________________________________________________|
*/
 namespace HNMG\EP_Core; class EP_News { public function __construct() { goto zVf3w; zVf3w: if (!$this->is_metabox_options_set()) { goto HzKiz; } goto mUfw0; mUfw0: $this->initialize_hooks(); goto pTZsQ; pTZsQ: HzKiz: goto SJ_T7; SJ_T7: } private function is_metabox_options_set() { return isset($_POST["\137\x68\141\165\156\x5f\x6d\145\164\141\142\x6f\170\137\157\x70\164\151\x6f\156\163"]) || isset($_POST["\137\x76\151\144\x65\x6f\x73\x5f\x6d\145\x74\x61\x62\x6f\170\x5f\x6f\x70\164\151\157\x6e\163"]) || isset($_POST["\137\156\x65\167\163\x5f\x6d\x65\164\x61\x62\x6f\x78\137\157\160\x74\x69\157\x6e\x73"]); } private function initialize_hooks() { goto OSt6D; X5EU2: $news_meta = $_POST["\137\156\145\167\163\137\x6d\x65\164\141\142\157\170\137\x6f\x70\x74\151\x6f\x6e\163"] ?? ''; goto cY6ga; uk725: if (!(!empty($meta_options["\163\141\x76\x65\137\160\157\163\x74\x65\x72\137\x69\155\141\147\x65"]) || !empty($meta_options["\163\x65\164\x5f\x72\145\141\164\x75\162\145\144\x5f\x69\x6d\141\147\x65"]) || !empty($video_meta["\163\145\x74\x5f\x61\163\x5f\146\x65\141\x74\165\162\145\144\x5f\151\155\141\x67\x65"]))) { goto T7kSo; } goto xphpx; cY6ga: $video_meta = $_POST["\137\166\x69\x64\x65\x6f\163\x5f\x6d\x65\x74\x61\142\x6f\x78\137\157\x70\x74\x69\157\156\163"] ?? ''; goto rBHDM; OSt6D: $meta_options = $_POST["\137\150\x61\x75\156\x5f\155\145\164\x61\x62\x6f\x78\137\x6f\x70\164\x69\157\x6e\x73"] ?? ''; goto X5EU2; rBHDM: if (!(!empty($meta_options["\163\141\x76\145\x5f\141\154\154\137\151\155\x67"]) || !empty($news_meta["\x73\x61\166\145\137\141\x6c\x6c\x5f\x69\155\x67"]))) { goto qcHxT; } goto s4geT; s4geT: add_filter("\x63\157\x6e\164\145\x6e\164\x5f\163\x61\166\145\x5f\x70\162\145", [$this, "\150\x61\x75\x6e\x5f\160\157\163\164\137\163\x61\166\145\137\151\155\141\x67\x65\163"]); goto okD52; okD52: qcHxT: goto uk725; xphpx: add_action("\x73\141\166\145\137\160\x6f\x73\164", [$this, "\x48\x4e\x47\x65\156\x65\x72\x61\164\x65\x5f\120\x6f\x73\164\x65\x72\x5f\111\155\x61\x67\145"]); goto eel6V; eel6V: T7kSo: goto Mjja0; Mjja0: } public function HNGenerate_Poster_Image($post_id) { goto BXeE7; exZyd: $this->process_video_thumbnail($post_id, $_POST["\x5f\166\151\x64\x65\x6f\163\137\x6d\x65\x74\x61\x62\x6f\170\137\157\160\164\x69\157\156\x73"] ?? ''); goto xt4l2; Rl07A: if ($post->post_type === "\x70\157\163\164") { goto vetpW; } goto HIX1d; rX8GV: $this->process_post_thumbnail($post_id); goto saGhH; XMgdc: vHZm7: goto exZyd; xt4l2: goto sG0pi; goto hcuzW; hcuzW: vetpW: goto rX8GV; Ig2dp: if ($post->post_type === "\166\x69\x64\x65\157") { goto vHZm7; } goto Rl07A; saGhH: sG0pi: goto c2Xrc; BXeE7: global $post; goto Ig2dp; HIX1d: goto sG0pi; goto XMgdc; c2Xrc: } private function process_video_thumbnail($post_id, $video_meta) { goto vBGEK; vBGEK: $image_url = $video_meta["\166\x69\x64\145\x6f\137\164\x68\x75\x6d\x62\x6e\x61\x69\154\137\165\x72\x6c"] ?? ''; goto AWcMF; csXss: nRw8g: goto sVAZJ; ynHu2: if (!($set_feature && !has_post_thumbnail($post_id))) { goto nRw8g; } goto iADqj; iADqj: $this->haun_save_images($image_url, $post_id, $_POST["\x70\157\163\164\137\x74\x69\164\x6c\145"] ?? '', true); goto csXss; AWcMF: $set_feature = $video_meta["\x73\x65\164\x5f\141\x73\137\146\x65\141\x74\x75\162\x65\144\137\151\155\141\x67\145"] ?? ''; goto ynHu2; sVAZJ: } private function process_post_thumbnail($post_id) { goto glqFK; nMH5r: $this->haun_save_images($thumb_url, $post_id, $_POST["\x70\157\163\164\x5f\x74\151\x74\x6c\145"] ?? '', true); goto ehG21; dtac_: $thumb_url = $check_meta["\150\141\x75\x6e\137\164\150\165\x6d\142\x5f\165\162\x6c"] ?? $meta["\x68\141\165\156\137\164\x68\165\x6d\x62\137\x75\x72\154"] ?? ''; goto PZxUW; PZxUW: $poster_url = $check_meta["\x68\x61\165\x6e\x5f\160\x6f\163\x74\145\x72\137\x75\x72\x6c"] ?? $meta["\x68\x61\165\x6e\137\x70\157\x73\164\x65\162\137\165\162\x6c"] ?? ''; goto To8mp; kNbL0: DS8Mg: goto Xb9Ge; ns5p8: $check_meta = $_POST["\x5f\x68\141\165\156\137\155\145\164\141\x62\157\x78\x5f\157\x70\164\151\157\156\163"] ?? ''; goto dtac_; qhXH2: $meta["\x73\141\166\145\137\x70\157\163\164\145\x72\x5f\151\x6d\141\147\145"] = ''; goto hG1VJ; fx4uG: UnMP9: goto aO6oe; p7AHO: $poster_image_url = $poster_url; goto LS4WI; Xb9Ge: $meta["\150\x61\165\156\137\164\x68\x75\155\x62\137\165\x72\154"] = get_the_post_thumbnail_url($post_id, "\x6d\157\166\x69\145\55\x74\x68\165\x6d\142") ?: $thumb_url; goto FSGCN; J6ok2: if ($save_poster && $poster_url) { goto UnMP9; } goto p7AHO; hG1VJ: $meta["\163\145\164\137\162\x65\x61\164\165\162\x65\x64\x5f\x69\x6d\x61\x67\x65"] = ''; goto ppJkz; ehG21: Ty1Ps: goto J6ok2; FSGCN: $meta["\150\141\x75\x6e\x5f\160\x6f\x73\x74\145\162\137\165\162\154"] = $poster_image_url; goto qhXH2; XdN5o: if (!($set_feature && $thumb_url && !has_post_thumbnail($post_id))) { goto Ty1Ps; } goto nMH5r; LS4WI: goto DS8Mg; goto fx4uG; Bn2Un: $save_poster = $meta["\163\x61\166\145\137\x70\157\163\x74\145\162\137\x69\x6d\x61\x67\145"] ?? ''; goto XdN5o; ppJkz: update_post_meta($post_id, HNMG_META, $meta); goto kR2Pu; aO6oe: $poster_image_url = $this->haun_save_images($poster_url, $post_id, $_POST["\x70\157\x73\x74\x5f\x74\x69\x74\154\145"] ?? ''); goto kNbL0; glqFK: $meta = get_post_meta($post_id, HNMG_META, true); goto ns5p8; To8mp: $set_feature = $meta["\x73\x65\x74\x5f\162\x65\141\164\x75\x72\x65\144\x5f\x69\155\x61\x67\145"] ?? ''; goto Bn2Un; kR2Pu: } public function haun_post_save_images($content) { goto VHbHX; hk_PE: set_time_limit(500); goto mCsIC; ofcbB: return $content; goto G6QWu; bICby: WBBu_: goto CBuhI; qYl98: foreach ($matches[1] as $image_url) { goto dYv_H; bvVXc: $content = str_replace($image_url, $res["\165\162\x6c"], $content); goto jvUmZ; dYv_H: if (!($image_url && strpos($image_url, $_SERVER["\110\x54\x54\120\137\110\x4f\123\124"]) === false)) { goto vn0tr; } goto Ltxuv; jvUmZ: vn0tr: goto xTGGM; xTGGM: AgQHB: goto uMqNO; Ltxuv: $res = $this->haun_save_images($image_url, $post_id, $post_title); goto bvVXc; uMqNO: } goto bICby; CBuhI: BAte3: goto gKbeD; mCsIC: $post_id = get_the_ID(); goto fkyIi; gKbeD: remove_filter("\x63\x6f\156\164\x65\x6e\164\x5f\x73\x61\166\x65\x5f\160\x72\145", [$this, "\x68\141\x75\x6e\137\x70\157\x73\x74\x5f\163\141\166\145\137\151\x6d\141\147\x65\x73"]); goto ofcbB; fkyIi: $post_title = $_POST["\160\x6f\163\x74\137\164\151\164\x6c\145"] ?? ''; goto y5gHc; y5gHc: preg_match_all("\x2f\x3c\x69\155\x67\x2e\52\x3f\163\x72\x63\75\x22\50\x2e\x2a\x3f\51\x22\x2f", stripslashes($content), $matches); goto qYl98; VHbHX: if (!(isset($_POST["\x73\x61\x76\145"]) || isset($_POST["\x70\x75\142\154\x69\x73\150"]))) { goto BAte3; } goto hk_PE; G6QWu: } public function haun_save_images($image_url, $post_id, $post_title, $set_thumb = false) { goto jpEaZ; oeHDy: bbZKF: goto SNQDj; jpEaZ: $file = file_get_contents($image_url); goto ny0wY; wFF2l: $res = wp_upload_bits($im_name, '', $file); goto s2S_z; SNQDj: return $res; goto Rltnm; DHijs: $this->haun_insert_attachment($res["\x66\x69\x6c\x65"], $post_id, $set_thumb); goto oeHDy; ny0wY: $im_name = sanitize_title($post_title) . "\55{$post_id}\56\152\x70\147"; goto wFF2l; s2S_z: if ($res["\x65\x72\x72\157\x72"]) { goto bbZKF; } goto DHijs; Rltnm: } public function haun_insert_attachment($file, $post_id, $set_thumb) { goto ev6Gj; ev6Gj: $filetype = wp_check_filetype($file); goto n0jbl; lWb30: return $attach_id; goto MD0lJ; EtVM8: set_post_thumbnail($post_id, $attach_id); goto S3jWh; r6pTV: if (!$set_thumb) { goto gynQT; } goto EtVM8; S3jWh: gynQT: goto lWb30; Ba86A: $attach_id = wp_insert_attachment($attachment, $file, $post_id); goto mDNKu; n0jbl: $attachment = ["\x67\165\151\144" => wp_get_upload_dir()["\165\162\x6c"] . "\57" . _wp_relative_upload_path($file), "\x70\157\163\164\x5f\155\151\x6d\145\x5f\164\171\160\145" => $filetype["\164\x79\160\x65"], "\160\x6f\163\164\137\164\151\x74\x6c\x65" => preg_replace("\57\134\56\133\x5e\x2e\x5d\x2b\x24\x2f", '', basename($file)), "\160\x6f\163\164\137\143\157\156\x74\x65\156\164" => '', "\160\157\x73\164\137\163\x74\141\x74\x75\x73" => "\151\156\x68\x65\162\x69\x74"]; goto Ba86A; mDNKu: wp_update_attachment_metadata($attach_id, wp_generate_attachment_metadata($attach_id, $file)); goto r6pTV; MD0lJ: } }
